<style>
  .parallax-banner {
    width: 100%;
    border-radius: 0.5rem;
  }

  .sticky-banner-top_sb,
  .sticky-banner-bottom_sb {
    position: fixed;
    justify-content: center;
    background-color: #f7f7f7;
    transition: all 0.8s;
    margin: 0px !important;
  }

  .sticky-banner-top_sb {
    top: 0px;
    z-index: 3;
    transform: translateY(0px);
    background: none;

  }

  .sticky-banner-top_sb.collapsed {
    transform: translateY(-250px)
  }


  .sticky-banner-bottom_sb {
    bottom: 0;
    z-index: 9999;
    transform: translateY(0px);
    background: none;
  }

  .sticky-banner-bottom_sb.collapsed {
    transform: translateY(500px);
  }

  .button-bottom-close_sb {
    position: absolute;
    bottom: auto !important;
    z-index: 99999999;
    top: -2rem;
    right: 0;
    width: 5rem;
    height: 2rem;
    cursor: pointer;
  }

  .mm_button_bottom_sb {
    position: absolute;
    padding: 0.1rem 0.6rem;
    right: 0.5rem;
    left: auto;
    border: none;
    background-size: 13px 13px;
    background-position: 9px;
    background-color: #ffffffde;
    background-repeat: no-repeat;
    box-shadow: 0 -1px 1px 0 rgb(0 0 0 / 20%) !important;
    color: #777;
    bottom: : auto !important;
    top: -1.6rem;
    border-radius: 10px 10px 0px 0px !important;
    font-size: 0.7rem;
    font-family: verdana;
    cursor: pointer;
  }
  .mm_marker_bottom{
      padding: 0rem 0.6rem;
      border: none;
      top: -1.2rem;
      line-height: initial;
      position: absolute;
      left: 0.5rem;
      font-size: 0.5rem;
      letter-spacing: 0.05rem;
      border-radius: 0.3rem 0.3rem 0 0 !important;
      height: 1rem;
      background: #ffffffde;
      width: fit-content;
      text-align: center;
      color: #989795;
      box-shadow: 1px 1px 1px 0px rgb(0 0 0 / 20%) !important;
  }
  .mm_marker_top{
      padding: 0rem 0.4rem;
      border: none;
      line-height: initial;
      position: absolute;
      left: 0.5rem;
      font-size: 0.5rem;
      letter-spacing: 0.05rem;
      border-radius: 0 0rem 0.3rem 0.3rem !important;
      height: 1rem;
      bottom: -1.2rem;
      background: #ffffffde;
      width: fit-content;
      text-align: center;
      color: #989795;
      box-shadow: 0px 1px 1px 0px rgb(0 0 0 / 20%) !important;
  }

  .button-top-close_sb {
    position: absolute;
    top: auto !important;
    z-index: 99999999;
    bottom: -2rem;
    right: 0;
    width: 5rem;
    height: 2rem;
    cursor: pointer;
  }

  .mm_button_top_sb {
    position: absolute;
    padding: 0.1rem 0.6rem;
    right: 0.5rem;
    left: auto;
    border: none;
    background-size: 13px 13px;
    background-position: 9px;
    background-color: #ffffffde;
    background-repeat: no-repeat;
    box-shadow: 0 1px 1px 0 rgb(0 0 0 / 20%) !important;
    color: #777;
    top: auto !important;
    bottom: -1.6rem;
    border-radius: 0 0 10px 10px !important;
    font-size: 0.7rem;
    font-family: verdana;
    cursor: pointer;
  }

  #sticky_b {
    contain: content;
    border-radius: 0.5rem 0.5rem 0 0
  }

  #sticky_t {
    contain: content;
    border-radius: 0px 0px 0.5rem 0.5rem;
  }
  .close_btn_p{
      position: absolute;
      display: flex;
      justify-content: center;
      z-index: 10;
      font-size: 10px;
      right: 35px;
      top: 5px;
      background: #d1d0cede;
      padding: 0 10px;
      text-align: center;
      border-radius: 30px;
      cursor: pointer;
      line-height: 23px;
  }
  .interscroller_banner > div > div > div:first-child {
    height: var(--banner-height) !important;
  }
  .interscroller_banner > div > div > div > div > div > div{
    height: var(--banner-height) !important;
  }
  .static_banner > div:first-child{
    height: var(--banner-height) !important;
  }
  .video_banner > div:first-child{
    height: var(--banner-height) !important;
  }
  .video_banner > div:first-child > div {
      height: auto !important;
  }
  .video_banner > div:first-child > div > div > video {
      height: auto !important;
  }
</style>
<div class="parallax-banner" id="parallax-banner" style="">
    <div id="p-banner-monetize-me" class="adfox_parallax"></div>
</div>
<script>

  if (document.querySelector(".monetizeme-desktop-sticky-bottom") != null) {
        window.Ya.adfoxCode.destroy(document.querySelector("#monetizeme-desktop-sticky-bottom").id)
        document.querySelector(".monetizeme-desktop-sticky-bottom").remove()
    }

  var randomId = Math.floor(Math.random() * 1000);
  document.getElementById("p-banner-monetize-me").id = "p-banner-monetize-me" + "_" + randomId;

  var banner_p_height = Math.round(document.querySelector('.adfox_parallax').offsetWidth * 0.7)
  document.documentElement.style.setProperty('--banner-height', `${banner_p_height}px`);

  window.yaContextCb.push(() => {
    Ya.adfoxCode.create({
      ownerId: 1458764,
      containerId: 'p-banner-monetize-me' + '_' + randomId,
      onRender: function(){
        document.querySelector('#parallax-banner').parentElement.parentElement.style.background = '#fff'
      },
      params: {%banner.user2%}
    })
  })

  //Указываем элемент статьи
  var article = document.querySelector(".text-block")

  //Убираем отступ плейсхолдера
  document.querySelector('.parallax-banner').parentElement.parentElement.style.padding = ''

  //Берем ширину контента
  width_sticky_banner = document.querySelector(".text-block").offsetWidth + "px"

  if (article.querySelectorAll('[id^=p-banner-monetize-me]').length <= 1) {
    var stickyBottom = document.createElement('div');
    var stickyTop = document.createElement('div');
    stickyTop.classList.add('sticky-banner-top_sb', 'collapsed');
    stickyTop.setAttribute('id', 'sticky_top');
    stickyTop.innerHTML = `<div class="button-top-close_sb"></div><button class="mm_button_top_sb">Закрыть</button><button class="mm_marker_top">РЕКЛАМА</button><div style="width: 100%;display: flex;justify-content: center;"><div id="sticky_t" style="width: 100%;display: flex;justify-content: center;"></div></div>`;
    window.yaContextCb.push(() => {
      Ya.adfoxCode.create({
        ownerId: 1458764,
        containerId: 'sticky_t',
        onRender: function(){
          var s = document.querySelector(".text-block").offsetWidth 
          var p = s / 1480
          var padd = (200 - 200 * p)/2
          var banner_selector = document.querySelector('.top_width')
              if (banner_selector == null){
              }else{
              banner_selector.style.transform = 'scale(' + p + ')'
              banner_selector.style.marginTop ='-'+ padd + 'px'
              banner_selector.style.marginBottom ='-' + padd + 'px'
              }
        },
        params: {%banner.user3%}
      })
    })

    article.insertAdjacentElement('afterbegin', stickyTop)

    //Ставим ширину баннера под контент
    document.querySelector(".sticky-banner-top_sb").style.width = width_sticky_banner


    stickyBottom.classList.add('sticky-banner-bottom_sb', 'collapsed');
    stickyBottom.setAttribute('id', 'sticky_bottom');
    stickyBottom.innerHTML = `<div class="button-bottom-close_sb"></div><button class="mm_button_bottom_sb">Закрыть</button><button class="mm_marker_bottom">РЕКЛАМА</button><div style="width: 100%;display: flex;justify-content: center;"><div id="sticky_b"style="width: 100%;display: flex;justify-content: center;"></div></div>`;
    window.yaContextCb.push(() => {
      Ya.adfoxCode.create({
        ownerId: 1458764,
        containerId: 'sticky_b',
        onRender: function(){
          var s = document.querySelector(".text-block").offsetWidth 
          var p = s / 1480
          var padd = (200 - 200 * p)/2
          var banner_selector = document.querySelector('.bot_width')
              if (banner_selector == null){
              }else{
              banner_selector.style.transform = 'scale(' + p + ')'
              banner_selector.style.marginTop ='-'+ padd + 'px'
              banner_selector.style.marginBottom ='-' + padd + 'px'
              }
        },
        params: {%banner.user4%}
      })
    })
    article.insertAdjacentElement('afterbegin', stickyBottom)

    //Ставим ширину баннера под контент
    document.querySelector(".sticky-banner-bottom_sb").style.width = width_sticky_banner

    function isElementHidden(element) {
      var rect = element.getBoundingClientRect();
      return (
        rect.bottom <= 500 ||
        rect.top >= window.innerHeight ||
        rect.right <= 5 ||
        rect.left >= window.innerWidth
      );
    }

    // Function to check if the parallax banner is completely hidden
    function isParallaxBannerHidden() {
      var parallaxBanner = document.querySelector('.parallax-banner');
      return isElementHidden(parallaxBanner);
    }

    function isArticleAboveScreen(articleElement) {
      const articleRect = articleElement.getBoundingClientRect();
      const screenBottom = window.innerHeight;


      return articleRect.bottom < screenBottom;
    }


    function collapseElement(elementToCollapse) {
      elementToCollapse.classList.add('collapsed')
    }

    function isArticleBelowScreenTop(articleElement) {
      const articleRect = articleElement.getBoundingClientRect();
      const screenTop = 0;
      return articleRect.top > screenTop;
    }

    // Function to handle scroll events
    function handleScroll() {
      var parallaxBanner = document.querySelector('.parallax-banner');
      var stickyBannerBottom = document.querySelector('.sticky-banner-bottom_sb');
      var stickyBannerTop = document.querySelector('.sticky-banner-top_sb');
      var articleElement = document.querySelector('.text-block');
      var elementToCollapse = document.querySelector('.sticky-banner-bottom_sb');


      var parallaxBannerHidden = isParallaxBannerHidden();

      if (parallaxBannerHidden) {
        if (window.pageYOffset > lastScrollPos) {
          if (parallaxBannerReached && isArticleAboveScreen(articleElement) != true) {
            stickyBannerBottom.classList.remove('collapsed')
            stickyBannerTop.classList.add('collapsed')
          }
          if (isArticleAboveScreen(articleElement)) {
            stickyBannerBottom.classList.add('collapsed')
          }
          if (parallaxBannerReached != true && isArticleBelowScreenTop(articleElement) != true) {
            stickyBannerTop.classList.remove('collapsed')
          }
        } else {
          if (parallaxBannerReached && isArticleAboveScreen(articleElement) != true && isArticleBelowScreenTop(articleElement) != true) {
            stickyBannerTop.classList.remove('collapsed')
            stickyBannerBottom.classList.add('collapsed')
          }
          if (isArticleAboveScreen(articleElement) || isArticleBelowScreenTop(articleElement)) {
            stickyBannerTop.classList.add('collapsed')
          }
        }
      } else {
        parallaxBannerReached = true;
        stickyBannerTop.classList.add('collapsed');
        stickyBannerBottom.classList.add('collapsed');
      }
      lastScrollPos = window.pageYOffset;
    }

    // Flag to track if the user has scrolled to the parallax banner
    var parallaxBannerReached = false;
    var bottomButton = document.querySelector('.button-bottom-close_sb');
    var topButton = document.querySelector('.button-top-close_sb');



    topButton.addEventListener('click', function() {
      document.querySelector(".sticky-banner-top_sb").remove();
    });

    bottomButton.addEventListener('click', function() {
      document.querySelector(".sticky-banner-bottom_sb").remove();
    });

    // Attach the scroll event listener
    var lastScrollPos = 0;
    window.addEventListener('scroll', handleScroll);
  }
  var clckio_st = document.querySelector(".__lxG__tsticky")
</script>