(window.webpackJsonp=window.webpackJsonp||[]).push([["components/game-rating"],{ntpi:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=a("pIdu"),r=(o=a("i6So"))&&o.__esModule?o:{default:o};var u=e=>{const t={block:e,button:e.querySelector(".js-game-rating-button"),value:e.querySelector(".js-game-rating-value"),count:e.querySelector(".js-game-rating-count"),userValue:e.querySelector(".js-game-rating-user-value"),modal:e.querySelector(".js-game-rating-modal"),buttons:e.querySelectorAll(".js-game-rating-set"),text:e.querySelector(".js-game-rating-btn-text"),modalPoster:e.querySelector(".js-game-rating-modal .boxart"),modalPosterSrc:e.querySelector(".js-game-rating-button").dataset.gameRatingPoster};(0,s.subscribe)(t.button,"click",()=>{const e=parseInt(t.userValue.textContent,10),a=t.buttons;e>0&&a.forEach(t=>{t.classList.remove("active");parseInt(t.dataset.value,10)===e&&t.classList.add("active")}),t.modalPoster.src=t.modalPosterSrc,jQuery(t.modal).modal("show")}),(0,s.subscribe)(t.buttons,"click",e=>((e,t)=>{const a=parseInt(t.block.dataset.gameId,10),o=parseInt(t.userValue.textContent,10),u=parseInt(e.dataset.value,10);jQuery(t.modal).modal("hide"),u!==o&&r.default.post("game.rate",{game_id:a,value:u}).then(({value:a,count:o})=>{t.value&&(t.value.textContent=a),t.count&&(t.count.textContent=o),t.userValue.textContent=u,t.buttons.forEach(e=>e.classList.remove("active")),0===u?(t.userValue.classList.remove("active"),t.text.textContent="Поставить оценку"):(t.userValue.classList.add("active"),e.classList.add("active"),t.text.textContent="Изменить")}).catch(()=>(0,s.showError)("При отправке данных произошла ошибка, попробуйте ещё раз позднее"))})(e,t))};t.default=u}}]);