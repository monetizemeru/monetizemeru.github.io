!function(){"use strict";var e=function(){return Array(4).fill(null).map((function(){return e=8,Math.random().toString(36).substr(2,e).toUpperCase();var e})).join("-")},n="SENDSAY_UMID_KEY",t=function(){return new Promise((function(t,i){try{var o=localStorage.getItem(n);o||(o=e(),localStorage.setItem(n,o)),t(o)}catch(e){i(e)}}))};const i="[SENDSAY SDK]: ",o={log:(e,n)=>n?console.log(i+e,n):console.log(i+e),err:(e,n)=>n?console.error(i+e,n):console.error(i+e),[void 0]:Function.prototype};function s(e,n){return new e(n)}class r{constructor(e={}){Object.keys(e).forEach((n=>{this[n]=t=>this._log(e[n],t)}))}}class a extends r{_log(e,n){return o.err(e,n)}}var l={...s(class extends r{_log(e,n){return o.log(e,n)}},{reportDenied:"Denied to subscribe",workerIsInstalling:"ServiceWorker is installing...",subscribedAlready:"Subscribed already",dialogOpened:"Dialog opened already",deniedOpened:"Denied modal opened already",dataNotObj:"Data should be an object",failedToGetPushPermission:"Failed to get push permission",notDenied:"WebPush and Notifications are not denied"}),...s(a,{workerNotInited:"Worker is not inited, call `.init(options: Record<string, string>): Promise<void>`",widgetNotInited:"Widget is not inited, call `.init(options: Record<string, string>): Promise<void>`",undefListener:"EventBus has no listener defined for event",noUMID:"No UMID"}),...s(class extends a{constructor(e){super(e),this.setDeviceId=e=>{this.deviceId=e},this.setEventProperties=({accountId:e,siteId:n,domain:t})=>{this.eventProperties={accountId:e,siteId:n,domain:t}}}url="https://api2.amplitude.com/2/httpapi";headers=new Headers({"Content-Type":"application/json"});apiKey="f61071560a4675aef2cba9815dc4599d";async report(e,n){try{const t=JSON.stringify({api_key:this.apiKey,events:[{device_id:this.deviceId,event_type:e,event_properties:{...this.eventProperties,error:n?n.toString():void 0},os_version:navigator.platform,platform:navigator.userAgent}]});await fetch(this.url,{method:"POST",headers:this.headers,body:t})}catch(e){console.error(e)}}async _log([e,n],t){super._log(e,t),window.sndsyApi.AMPLITUDE_LOG_DISABLED||await this.report(n,t)}},{workerFailToSubscribe:["Fail to subscribe","fail_to_subscribe"],smallWindow:["Window width is too small to display modal","window_too_small"],fetchFailed:["Failed to fetch widget settings","fetch_failed"],webPushNotSupported:["Web-push notifications are not supported","push_not_supported"],noSafari:["Safari does not support web-push","safari_not_supported"],missedIds:["accountId or siteId is missed","ids_missed"],unknownAccountId:["Unknown account id","unknown_account_id"],unknownSiteId:["Unknown site id","unknown_site_id"],failedToInstall:["Failed to install a widget","fail_to_install"]})};function d(e){const n=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(n),i=new Uint8Array(t.length);for(let e=0;e<t.length;++e)i[e]=t.charCodeAt(e);return i}class c{constructor(){this.options={},this.dk={}}async init(e){this.options=e,await this.register()}addData(e){this.dk["member.email"]||(this.dk["member.email"]=[]);const n=this.dk["member.email"];return e["member.email"]&&n.push(e["member.email"]),Object.assign(this.dk,e),this.dk["member.email"]=n,this.dk}isReady(){return this.swreg?!(!this.swreg.active&&this.swreg.installing)||(l.workerIsInstalling(),!1):(l.workerNotInited(),!1)}async register(){await navigator.serviceWorker.register(this.options.serviceWorkerPath),this.swreg=await navigator.serviceWorker.ready}sendSubscription=async e=>{const{dk:n,options:i}=this,o=`https://sendsay.ru/backend/push/subscription/${i.accountId}`,s=new Headers({"Content-Type":"application/x-www-form-urlencoded"});try{const e=await t();n["member.umid"]=e}catch{l.noUMID()}const r=JSON.stringify({action:"subscribe",info:e,list:i.groupId,dk:n});await fetch(o,{method:"POST",headers:s,body:r})};async isSubscribed(){const e=this.getPermission();return!!await this.swreg.pushManager.getSubscription()||"granted"===e}async canSubscribe(){const e=this.getPermission(),n=await this.getPushPermission();return n?"default"===e&&("prompt"===n||"default"===n):"default"===e}async getPushPermission(){try{return await this.swreg.pushManager.permissionState({userVisibleOnly:!0,applicationServerKey:d(this.options.serverApiKey)})}catch(e){l.failedToGetPushPermission(e)}}getPermission(){return Notification.permission}subscribe=async()=>{if(this.isReady())try{const e=await this.swreg.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:d(this.options.serverApiKey)});await this.sendSubscription(e)}catch(e){l.workerFailToSubscribe(e)}}}var h='/* TEXT */\n.font-sans {\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";\n}\n\n.text-bold {\n  font-weight: bold;\n}\n\n.text-10 {\n  font-size: 10px;\n}\n\n.text-14 {\n  font-size: 14px;\n}\n\n.text-16 {\n  font-size: 16px;\n}\n\n.text-end {\n  text-align: end;\n}\n\n.lh-20 {\n  line-height: 20px;\n}\n\n.hidden {\n  overflow: hidden;\n}\n\n.ellipsis {\n  text-overflow: ellipsis;\n}\n\n.text-decoration-none {\n  text-decoration: none;\n}\n\n.text-black {\n  color: black;\n}\n\n.nowrap {\n  white-space: nowrap;\n}\n\n/* SIZE */\n.w-full {\n  width: 100%;\n}\n\n.h-full {\n  height: 100%;\n}\n\n.w-460 {\n  width: 460px;\n}\n\n.w-456 {\n  width: 456px;\n}\n\n.w-9 {\n  width: 9px;\n}\n\n.h-9 {\n  height: 9px;\n}\n\n.h-186 {\n  height: 186px;\n}\n\n.h-27 {\n  height: 27px;\n}\n\n.min-w-80 {\n  min-width: 80px;\n}\n\n.min-h-80 {\n  min-height: 80px;\n}\n\n.max-w-80 {\n  max-width: 80px;\n}\n\n.max-w-300 {\n  max-width: 300px;\n}\n\n.max-h-80 {\n  max-height: 80px;\n}\n\n.max-h-60 {\n  max-height: 60px;\n}\n\n.max-h-image {\n  max-height: calc(100vh - 125px - 10vh);\n}\n\n.min-w-25 {\n  min-width: 25px;\n}\n\n.min-h-25 {\n  min-height: 25px;\n}\n\n.max-w-25 {\n  max-width: 25px;\n}\n\n.max-h-25 {\n  max-height: 25px;\n}\n\n.min-w-40 {\n  min-width: 40px;\n}\n\n.min-h-40 {\n  min-height: 40px;\n}\n\n.max-w-40 {\n  max-width: 40px;\n}\n\n.max-h-40 {\n  max-height: 40px;\n}\n\n.w-300 {\n  width: 300px;\n}\n\n.w-80 {\n  width: 80px;\n}\n\n.h-80 {\n  height: 80px;\n}\n\n.w-25 {\n  width: 25px;\n}\n\n.h-25 {\n  height: 25px;\n}\n\n.w-40 {\n  width: 40px;\n}\n\n.h-40 {\n  height: 40px;\n}\n\n/* BACKGROUND */\n.bg-white {\n  background-color: white;\n}\n\n.bg-black {\n  background-color: black;\n}\n\n.bg-none {\n  background: none;\n}\n\n.bg-black-500 {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n/* OPACITY */\n.opacity-5 {\n  opacity: 0.5;\n}\n\n/* POSITION */\n.fixed {\n  position: fixed;\n}\n\n.absolute {\n  position: absolute;\n}\n\n.relative {\n  position: relative;\n}\n\n.top-5 {\n  top: 5%;\n}\n\n.top-0 {\n  top: 0;\n}\n\n.right-0 {\n  right: 0;\n}\n\n.right-10 {\n  right: 10px;\n}\n\n.right-20 {\n  right: 20px;\n}\n\n.top-10 {\n  top: 10px;\n}\n\n.bottom-5 {\n  bottom: 5px;\n}\n\n.left-center {\n  left: calc(50% - 230px); /* 230 = 460 / 2 */\n}\n\n.inset-0 {\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n\n.z-max {\n  z-index: 999999;\n}\n\n/* DISPLAY */\n.flex {\n  display: flex;\n}\n\n.fit-cover {\n  object-fit: cover;\n}\n\n.fit-contain {\n  object-fit: contain;\n}\n\n.none {\n  display: none;\n}\n\n.block {\n  display: block;\n}\n\n/* FLEX */\n.flex-col {\n  flex-direction: column;\n}\n\n.items-center {\n  align-items: center;\n}\n\n.flex-row {\n  flex-direction: row;\n}\n\n.flex-shrink-0 {\n  flex-shrink: 0;\n}\n\n.justify-end {\n  justify-content: flex-end;\n}\n\n.items-start {\n  align-items: flex-start;\n}\n\n.justify-between {\n  justify-content: space-between;\n}\n\n.grow-1 {\n  flex-grow: 1;\n}\n\n/* SPACING */\n.mb-10 {\n  margin-bottom: 10px;\n}\n\n.mb-2 {\n  margin-bottom: 2px;\n}\n\n.mx-10 {\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.m--18 {\n  margin-left: -18px;\n  margin-right: -18px;\n  margin-bottom: -18px;\n}\n\n.mx-auto {\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.ml-20 {\n  margin-left: 20px;\n}\n\n.mb-4 {\n  margin-bottom: 4px;\n}\n\n.mr-15 {\n  margin-right: 15px;\n}\n\n.mt-15 {\n  margin-top: 15px;\n}\n\n.p-0 {\n  padding: 0;\n}\n\n.pb-5 {\n  padding-bottom: 5px;\n}\n\n.py-5 {\n  padding-top: 5px;\n  padding-bottom: 5px;\n}\n\n.px-15 {\n  padding-left: 15px;\n  padding-right: 15px;\n}\n\n.px-20 {\n  padding-left: 20px;\n  padding-right: 20px;\n}\n\n.py-20 {\n  padding-top: 20px;\n  padding-bottom: 20px;\n}\n\n.pt-20 {\n  padding-top: 20px;\n}\n\n.p-20 {\n  padding: 20px;\n}\n\n/* BORDER */\n.box-border {\n  box-sizing: border-box;\n}\n\n.radius-3 {\n  border-radius: 3px;\n}\n\n.radius-9 {\n  border-radius: 9px;\n}\n\n.radius-20 {\n  border-radius: 20px;\n}\n\n.border-none {\n  border-style: none;\n}\n\n.outline-none {\n  outline: none;\n}\n\n.shadow {\n  box-shadow: 0 1px 5px rgba(13, 13, 13, 0.2);\n}\n\n/* CURSOR */\n.cursor-pointer {\n  cursor: pointer;\n}\n\n/* ANIMATION */\n@keyframes bounceIn {\n  from,\n  20%,\n  40%,\n  60%,\n  80%,\n  to {\n    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);\n    animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n\n  0% {\n    opacity: 0;\n    -webkit-transform: scale3d(0.3, 0.3, 0.3);\n    transform: scale3d(0.3, 0.3, 0.3);\n  }\n\n  20% {\n    -webkit-transform: scale3d(1.1, 1.1, 1.1);\n    transform: scale3d(1.1, 1.1, 1.1);\n  }\n\n  40% {\n    -webkit-transform: scale3d(0.9, 0.9, 0.9);\n    transform: scale3d(0.9, 0.9, 0.9);\n  }\n\n  60% {\n    opacity: 1;\n    -webkit-transform: scale3d(1.03, 1.03, 1.03);\n    transform: scale3d(1.03, 1.03, 1.03);\n  }\n\n  80% {\n    -webkit-transform: scale3d(0.97, 0.97, 0.97);\n    transform: scale3d(0.97, 0.97, 0.97);\n  }\n\n  to {\n    opacity: 1;\n    -webkit-transform: scale3d(1, 1, 1);\n    transform: scale3d(1, 1, 1);\n  }\n}\n\n.bounce-in {\n  animation-name: bounceIn;\n  animation-duration: 0.6s;\n  animation-fill-mode: both;\n}\n',u='\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" fill="currentColor"><path fill="currentColor" fill-rule="evenodd" d="M2.146 2.854a.5.5 0 11.708-.708L7 6.293l4.146-4.147a.5.5 0 01.708.708L7.707 7l4.147 4.146a.5.5 0 01-.708.708L7 7.707l-4.146 4.147a.5.5 0 01-.708-.708L6.293 7 2.146 2.854z" clip-rule="evenodd"/></svg>\n';const p=e=>`https://sendsay.ru/?utm_source=${e}&utm_medium=widget&utm_campaign=web-push`,f=p(window.location.hostname);let m=!1;class g extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}async connectedCallback(){this.render(),this.crossEl=this.shadow.getElementById("cross"),this.crossEl.addEventListener("click",this.onClose),setTimeout((()=>{document.addEventListener("click",this.onClose)}),0),document.addEventListener("keyup",this.onKeyup)}disconnectedCallback(){this.crossEl.removeEventListener("click",this.onClose),document.removeEventListener("keyup",this.onKeyup),document.removeEventListener("click",this.onClose),m=!1}onClose=e=>{(e.target.closest("#cross")||e.target!==this)&&this.close()};onKeyup=e=>{"escape"!==e.key.toString().toLowerCase()&&27!==e.keyCode||this.close()};close(){this.parentNode.removeChild(this)}render(){const{options:{showDialogCopyright:e=!0}}=window.sndsyApi.webPushWidget;this.shadow.innerHTML=`\n      <style>${h}</style>\n\n      <div id="modal" class="bounce-in flex font-sans flex-row items-start radius-20 z-max box-border text-14 w-460 fixed top-5 left-center bg-white shadow">\n        <div id="cross" class="absolute top-0 right-0 mt-15 mr-15 cursor-pointer min-h-25 min-w-25 max-h-25 w-25 h-25">${u}</div>\n\n        <div class="flex flex-row px-20 py-20">\n          <div id="tick" class="min-h-40 min-w-40 max-h-40 w-40 h-40">\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" fill="none"><circle cx="20" cy="20" r="20" fill="url(#a)"/><g filter="url(#b)"><path fill="#fff" d="M32.382 13.964a2.5 2.5 0 0 0-3.535 0L18.314 24.497l-5.1-5.1a2.5 2.5 0 1 0-3.535 3.536l6.513 6.513c.06.06.124.117.189.17a2.5 2.5 0 0 0 3.702.183l12.3-12.3a2.5 2.5 0 0 0 0-3.535Z"/></g><defs><linearGradient id="a" x1="26.5" x2="15.75" y1="36" y2="-5.25" gradientUnits="userSpaceOnUse"><stop stop-color="#54B905"/><stop offset="1" stop-color="#EEF78A"/></linearGradient><filter id="b" width="32.168" height="25.3" x="4.947" y="11.232" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_1792_121437"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_1792_121437" result="shape"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="-1"/><feGaussianBlur stdDeviation=".5"/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic"/><feColorMatrix values="0 0 0 0 0.247059 0 0 0 0 0.72549 0 0 0 0 0.0196078 0 0 0 0.25 0"/><feBlend in2="shape" result="effect2_innerShadow_1792_121437"/></filter></defs></svg>\n\n</div>\n\n          <div class="flex flex-col ml-20">\n            <div class="text-16 text-bold lh-20 w-300">Вы уже подписались на персональные предложения</div>\n          </div>\n        </div>\n\n        <a class="absolute cursor-pointer bottom-5 right-20 opacity-5 text-end text-10 text-decoration-none text-black" href="${f}" target="_blank" rel="noopener noreferrer">\n          ${e?"Сделано в Sendsay":""}\n        </a>\n      </div>\n    `}}customElements.define("sendsay-subscription-completed",g);const w=function(e){let n;class t extends e{create(e){n=new t(e)}}return e=>n||(n=new t(e),n)}(class{constructor(e={}){this.listeners=e}_call(e){if(!e)return Function.prototype;const n=this;return function(t,i,o=Function.prototype){return"string"==typeof e?n.emit(e,t):e(o,t,i)}}async emit(e,n={}){const t=this.listeners[e];if(Array.isArray(t)){const i=this;function o(s=0){return function(){return i._call(t[s])(n,e,o(s+1))}}await o()()}else t?this._call(t)(n,e):l.undefListener(e)}});const b=p(window.location.hostname);let x=!1;class y extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}async connectedCallback(){await this.fetchIcon(),this.render(),this.subscribeEl=this.shadow.getElementById("subscribe"),this.crossEl=this.shadow.getElementById("cross"),this.subscribeEl.addEventListener("click",this.subscribe),this.crossEl.addEventListener("click",this.onClose),setTimeout((()=>{document.addEventListener("click",this.onClose)}),0),document.addEventListener("keyup",this.onKeyup)}disconnectedCallback(){this.subscribeEl.removeEventListener("click",this.subscribe),this.crossEl.removeEventListener("click",this.onClose),document.removeEventListener("click",this.onClose),document.removeEventListener("keyup",this.onKeyup),x=!1}async fetchIcon(){const{options:{iconUrl:e}}=window.sndsyApi.webPushWidget;if(!e)return;const n=new Promise((e=>setTimeout(e,4e3))),t=fetch(e);try{this.loadedIcon=await Promise.race([n,t])}catch(e){console.error(e),this.loadedIcon=void 0}if(this.loadedIcon){const e=await this.loadedIcon.blob();this.loadedIcon=URL.createObjectURL(e)}}onClose=e=>{(e.target.closest("#cross")||e.target!==this)&&this.close()};onKeyup=e=>{"escape"!==e.key.toString().toLowerCase()&&27!==e.keyCode||this.close()};close=()=>this.parentNode.removeChild(this);subscribe=()=>{w().emit("requestSubscription"),this.close()};render(){const{options:{showDialogCopyright:e=!0,dialogTitle:n="Хотите получать персональные предложения?",dialogMessage:t="Подпишитесь на push-уведомления",subscribeButtonText:i="Подписаться",subscribeButtonButtonColor:o="#1E88E5",subscribeButtonTextColor:s="#FFFFFF"}}=window.sndsyApi.webPushWidget;let r;r=this.loadedIcon?`<img src=${this.loadedIcon} class="w-80 h-80 min-h-80 min-w-80 fit-cover" alt="web push icon" />`:'\n        <div class="min-h-80 min-w-80 max-h-80 w-80 h-80">\n          \n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 86 80" fill="none"><g clip-path="url(#clip0)"><circle cx="73.5" cy="16.5" r="10.206" fill="#EA3223" transform="rotate(15 73.5 16.5)"/><path fill="url(#paint0_linear)" fill-rule="evenodd" d="M40 80c22.091 0 40-17.909 40-40 0-4.013-.591-7.888-1.69-11.543a12.659 12.659 0 01-8.306.597c-6.782-1.818-10.807-8.79-8.99-15.571a12.658 12.658 0 013.04-5.445A39.823 39.823 0 0040 0C17.909 0 0 17.909 0 40s17.909 40 40 40z" clip-rule="evenodd"/><g fill-rule="evenodd" clip-rule="evenodd" filter="url(#filter0_dddiiii)" opacity=".95"><path fill="#CEE8FF" d="M43.302 17.129a2.871 2.871 0 015.547 1.486l-.515 1.92c6.598 3.162 10.221 10.667 8.259 17.99L51.986 55.72l3.843 3.408-39.937-10.701 6.14-.733L26.64 30.5c1.963-7.323 8.853-12.01 16.148-11.45l.514-1.92zM40.95 65.842a4.594 4.594 0 005.627-3.248l-8.875-2.378a4.594 4.594 0 003.248 5.626zM15.892 48.427l39.937 10.7-.892 3.329L15 51.755l.892-3.328z"/><path fill="url(#paint1_linear)" fill-opacity=".5" d="M43.302 17.129a2.871 2.871 0 015.547 1.486l-.515 1.92c6.598 3.162 10.221 10.667 8.259 17.99L51.986 55.72l3.843 3.408-39.937-10.701 6.14-.733L26.64 30.5c1.963-7.323 8.853-12.01 16.148-11.45l.514-1.92zM40.95 65.842a4.594 4.594 0 005.627-3.248l-8.875-2.378a4.594 4.594 0 003.248 5.626zM15.892 48.427l39.937 10.7-.892 3.329L15 51.755l.892-3.328z"/></g><path fill="#fff" d="M73.474 22h2.24V11h-2.233l-2.767 1.96V15.1l2.626-1.86h.134V22z"/><g filter="url(#filter1_f)"><path fill="url(#paint2_linear)" d="M54.134 31.494h1v23.7h-1z" transform="rotate(15 54.134 31.494)"/></g><g filter="url(#filter2_f)"><path fill="url(#paint3_linear)" d="M28.134 25h1v23.7h-1z" transform="rotate(15 28.134 25)"/></g><g filter="url(#filter3_f)"><path fill="url(#paint4_linear)" d="M44.856 63.467h1v2.566h-1z" transform="rotate(70.392 44.856 63.467)"/></g><g filter="url(#filter4_f)" opacity=".5"><path fill="url(#paint5_linear)" d="M6.859 47.605h4.124v17.144H6.859z" transform="rotate(-75 6.859 47.605)"/></g><path fill="url(#paint6_linear)" d="M15.892 48.427h41.346v3.445H15.892z" opacity=".5" transform="rotate(15 15.892 48.427)"/><g filter="url(#filter5_f)"><circle cx="37.5" cy="29.5" r="8.5" fill="#fff"/></g></g><defs><linearGradient id="paint0_linear" x1="53" x2="31.5" y1="72" y2="-10.5" gradientUnits="userSpaceOnUse"><stop stop-color="#1E88E5"/><stop offset="1" stop-color="#A2D3FF"/></linearGradient><linearGradient id="paint1_linear" x1="73.5" x2="25.706" y1="52" y2="38.815" gradientUnits="userSpaceOnUse"><stop stop-color="#fff" stop-opacity=".4"/><stop offset=".552" stop-color="#fff"/><stop offset="1" stop-color="#fff"/></linearGradient><linearGradient id="paint2_linear" x1="54.634" x2="54.634" y1="31.494" y2="55.194" gradientUnits="userSpaceOnUse"><stop stop-color="#6CBAFF" stop-opacity="0"/><stop offset="1" stop-color="#288EE7"/></linearGradient><linearGradient id="paint3_linear" x1="28.634" x2="28.634" y1="25" y2="48.7" gradientUnits="userSpaceOnUse"><stop stop-color="#6CBAFF" stop-opacity="0"/><stop offset="1" stop-color="#288EE7"/></linearGradient><linearGradient id="paint4_linear" x1="45.356" x2="45.356" y1="63.467" y2="66.034" gradientUnits="userSpaceOnUse"><stop stop-color="#6CBAFF"/><stop offset="1" stop-color="#288EE7"/></linearGradient><linearGradient id="paint5_linear" x1="8.921" x2="8.921" y1="47.605" y2="64.749" gradientUnits="userSpaceOnUse"><stop stop-color="#6CBAFF" stop-opacity="0"/><stop offset="1" stop-color="#288EE7"/></linearGradient><linearGradient id="paint6_linear" x1="15.921" x2="57.534" y1="50.048" y2="50.803" gradientUnits="userSpaceOnUse"><stop stop-color="#F3F9FE"/><stop offset="1" stop-color="#258CE7" stop-opacity=".41"/></linearGradient><filter id="filter0_dddiiii" width="67.016" height="73.513" x="8.217" y="8.599" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="3" dy="7"/><feGaussianBlur stdDeviation="3"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0.361767 0 0 0 0 0.679167 0 0 0 1 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="2" dy="3"/><feGaussianBlur stdDeviation="1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/><feBlend in2="effect1_dropShadow" result="effect2_dropShadow"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="4"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/><feBlend in2="effect2_dropShadow" result="effect3_dropShadow"/><feBlend in="SourceGraphic" in2="effect3_dropShadow" result="shape"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="-5" dy="-1"/><feGaussianBlur stdDeviation="3.5"/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic"/><feColorMatrix values="0 0 0 0 0.117647 0 0 0 0 0.533333 0 0 0 0 0.898039 0 0 0 0.58 0"/><feBlend in2="shape" result="effect4_innerShadow"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="9" dy="4"/><feGaussianBlur stdDeviation="1.5"/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic"/><feColorMatrix values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.69 0"/><feBlend in2="effect4_innerShadow" result="effect5_innerShadow"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="-1" dy="1"/><feGaussianBlur stdDeviation="4"/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic"/><feColorMatrix values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.9 0"/><feBlend in2="effect5_innerShadow" result="effect6_innerShadow"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="13" dy="8"/><feGaussianBlur stdDeviation="4"/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic"/><feColorMatrix values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.82 0"/><feBlend in2="effect6_innerShadow" result="effect7_innerShadow"/></filter><filter id="filter1_f" width="11.1" height="27.151" x="46" y="29.494" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur" stdDeviation="1"/></filter><filter id="filter2_f" width="11.1" height="27.151" x="20" y="23" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur" stdDeviation="1"/></filter><filter id="filter3_f" width="5.753" height="4.803" x="40.939" y="61.967" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur" stdDeviation=".75"/></filter><filter id="filter4_f" width="27.627" height="18.42" x="1.859" y="38.622" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur" stdDeviation="2.5"/></filter><filter id="filter5_f" width="41" height="41" x="17" y="9" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"/><feGaussianBlur result="effect1_foregroundBlur" stdDeviation="6"/></filter><clipPath id="clip0"><path fill="#fff" d="M0 0h86v80H0z"/></clipPath></defs></svg>\n\n        </div>\n      ',this.shadow.innerHTML=`\n      <style>${h}</style>\n\n      <div id="modal" class="bounce-in flex font-sans flex-row items-start radius-20 z-max box-border text-14 w-460 h-186 fixed top-5 left-center p-20 bg-white shadow">\n        ${r}\n\n        <div class="flex flex-col h-full items-start ml-20">\n          <button id="cross" class="absolute right-10 top-10 border-none min-h-25 min-w-25 max-h-25 w-25 h-25 cursor-pointer bg-none p-0 outline-none">\n            ${u}\n          </button>\n\n          <div class="grow-1 text-16 text-bold lh-20 hidden ellipsis max-h-40 w-300">${n}</div>\n\n          <div class="lh-20 mx-10 hidden ellipsis grow-1 w-300 max-h-60">${t}</div>\n\n          <button\n            class="hidden ellipsis max-w-300 h-27 border-none cursor-pointer text-16 px-15 py-5 radius-3 outline-none text-white nowrap"\n            style="\n              background-color: ${o};\n              color: ${s}\n            "\n            id="subscribe"\n          >\n            ${i}\n          </button>\n\n          <a class="absolute cursor-pointer bottom-5 right-20 opacity-5 text-end text-10 text-decoration-none text-black" href="${b}" target="_blank" rel="noopener noreferrer">\n            ${e?"Сделано в Sendsay":""}\n          </a>\n        </div>\n      </div>\n    `}}customElements.define("sendsay-subscription-dialog",y);const v=e=>-1!==navigator.userAgent.toLowerCase().indexOf(e.toLowerCase()),k=e=>-1!==navigator.platform.toLowerCase().indexOf(e.toLowerCase()),S=()=>v("firefox"),_=()=>v("chrome")&&/Google Inc/.test(navigator.vendor)&&!(v("opera")||v("opr"))&&!v("edge"),I=()=>"platform"in navigator&&k("mac"),C="Чтобы подписаться, разрешите сайту отправлять вам уведомления в настройках браузера",E="https://image.sendsay.ru/app/js/sdk/0.1.0/images/",B="Чтобы подписаться, нажмите на замочек и",D=`${B} в пункте <b>Уведомления</b> выберите <b>Разрешить</b>`;function A(){let e,n=C;return"platform"in navigator&&k("linux")?_()?(n=`${B} в пункте <b>Настройки</b> выберите <b>Разрешить</b>`,e=`${E}not_allowed_ubuntu_chromium.jpg`):S()&&(n=`${B} затем на крестик рядом с <b>Заблокировано</b>`,e=`${E}not_allowed_ubuntu_firefox.jpg`):I()?_()?(n="Нажмите на колокольчик и затем на кнопку <b>Показывать уведомления с этого сайта</b>",e=`${E}not_allowed_notifications_macos_chrome.jpg`):S()&&(n=D,e=`${E}not_allowed_macos_firefox.jpg`):"platform"in navigator&&k("win")&&(_()?(n=D,e=`${E}not_allowed_windows_chrome.jpg`):S()&&(n=`${B} затем на крестик рядом с <b>Заблокировано</b>`,e=`${E}not_allowed_windows_firefox.jpg`)),[n,e]}let F=!1;class M extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"})}async connectedCallback(){await this.fetchImage(),this.render(),this.crossEl=this.shadow.getElementById("cross"),this.layoutEl=this.shadow.getElementById("overlay"),this.crossEl.addEventListener("click",this.onClose),this.layoutEl.addEventListener("click",this.onClose),document.addEventListener("keyup",this.onKeyup)}disconnectedCallback(){this.crossEl.removeEventListener("click",this.onClose),this.layoutEl.removeEventListener("click",this.onClose),document.removeEventListener("keyup",this.onKeyup),F=!1}getPlatformUnlockValues(){return this.getAttribute("data-notifications-denied")?A():function(){let e,n=C;return _()&&I()&&(n=D,e=`${E}not_allowed_macos_chrome.jpg`),[n,e]}()}async fetchImage(){const[,e]=this.getPlatformUnlockValues();if(!e)return;const n=new Promise((e=>setTimeout(e,3e3))),t=fetch(e);try{this.image=await Promise.race([n,t])}catch(e){console.error(e),this.image=void 0}if(this.image){const e=await this.image.blob();this.image=URL.createObjectURL(e)}}onClose=e=>{(e.target.closest("#cross")||e.target===this.layoutEl)&&this.close()};onKeyup=e=>{"escape"!==e.key.toString().toLowerCase()&&27!==e.keyCode||this.close()};close(){this.parentNode.removeChild(this)}render(){const[e]=this.getPlatformUnlockValues();let n="";this.image&&(n=`\n        <img class="fit-contain max-h-image w-456 mx-auto mb-2 block" alt="enable notifications" src="${this.image}" />\n      `),this.shadow.innerHTML=`\n      <style>${h}</style>\n\n      <div id="overlay" class="font-sans bg-black-500 fixed inset-0 z-max">\n        <div id="modal" class="block bounce-in box-border relative hidden w-460 bg-white top-5 radius-20 mx-auto">\n          <div id="cross" class="absolute top-0 right-0 mt-15 mr-15 cursor-pointer min-h-25 min-w-25 max-h-25 w-25 h-25">${u}</div>\n\n          <div class="flex flex-row px-20 pt-20 pb-5">\n            <div class="flex-shrink-0 min-h-80 min-w-80 max-h-80 w-80 h-80">\n<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 86 80"><g clip-path="url(#clip0)"><path fill="url(#paint0_linear)" d="M80 40c0 22.0914-17.9086 40-40 40S0 62.0914 0 40 17.9086 0 40 0s40 17.9086 40 40z"/><path fill="#fff" fill-rule="evenodd" d="M43.3021 17.1287c.4105-1.5317 1.9849-2.4407 3.5166-2.0302 1.5317.4104 2.4406 1.9848 2.0302 3.5165l-.5146 1.9205c6.5975 3.1618 10.2209 10.6661 8.2585 17.9896l-4.6073 17.1948.0004.0001 3.8429 3.4077-39.9368-10.701 6.1409-.7324 4.6073-17.1949c1.9624-7.3237 8.8527-12.011 16.1474-11.4503l.5145-1.9204zm-2.3518 48.7135c2.4507.6567 4.9697-.7977 5.6264-3.2484l-8.8748-2.378c-.6567 2.4507.7976 4.9697 3.2484 5.6264zM15.8918 48.4267l39.9367 10.701-.8917 3.3281L15 51.7547l.8918-3.328z" clip-rule="evenodd"/><rect width="3" height="95.0239" x="72" y="5.2929" fill="#EA3223" stroke="#fff" rx="1.5" transform="rotate(45 72 5.2929)"/></g><defs><linearGradient id="paint0_linear" x1="53" x2="31.5" y1="72" y2="-10.5" gradientUnits="userSpaceOnUse"><stop stop-color="#D8D8D8"/><stop offset="1" stop-color="#F8F8F8"/></linearGradient><clipPath id="clip0"><path fill="#fff" d="M0 0h86v80H0z"/></clipPath></defs></svg>\n</div>\n\n            <div class="flex flex-col ml-20">\n              <div class="text-16 text-bold lh-20 w-300">У вас заблокированы уведомления от этого сайта</div>\n\n              <div class="lh-20 mx-10 text-14 grow-1 hidden w-300">${e}</div>\n            </div>\n          </div>\n\n          ${n}\n        </div>\n      </div>\n    `}}customElements.define("sendsay-subscription-denied",M);const L={click:class{constructor({trigger:e,selector:n}){document.addEventListener("click",(t=>{t.target.matches(n)&&e.call(this,t)}))}},timeout:class{constructor({trigger:e,timeout:n="2"}){setTimeout(e,1e3*parseInt(n,10))}},scroll:class{constructor({trigger:e,percents:n=20}){this.percents=n,this.trigger=e,document.addEventListener("scroll",function(e,n){let t,i;return function(o){i?(clearTimeout(t),t=setTimeout((()=>{e(o)}),n)):(e(o),i=1)}}(this.onScroll.bind(this),500))}getScrollHeight=()=>Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);getScrollPercents(){return Math.round(window.pageYOffset/this.getScrollHeight()*100)}onScroll=()=>{this.getScrollPercents()>this.percents&&this.trigger()}},onload:class{constructor({trigger:e}){e()}}},O=[{name:"click",options:{selector:"[sendsay-webpush-subscribe]"}},{name:"click",options:{selector:"[data-sendsay-webpush-subscribe]"}}];class P{constructor(){this.options={},this.worker=new c,this.triggers=[],this.inited=!1,w().create({requestDialog:[this.ifInited,this.ifNotSubscribed,this.ifWidthAllowed,this.writeTimeout,this.createDialog],requestSubscription:[this.ifInited,this.ifNotSubscribed,this.ifCanSubscribeOrDeny,this.writeTimeout,this.subscribe],requestCompletedSubscription:this.createCompletedDialog,requestDenied:[this.ifInited,this.ifWidthAllowed,this.createDenied],dialogClosed:this.onDialogClosed,deniedClosed:this.onDeniedClosed,click:this.onClick,onload:[this.ifTimeout,"requestDialog"],scroll:[this.ifTimeout,"requestDialog"],timeout:[this.ifTimeout,"requestDialog"]}),this.runTriggers(O)}async init(e){this.options=e,await this.worker.init(e),this.inited=!0,document.dispatchEvent(new CustomEvent("sendsay-webpush-initialize",{detail:{widget:this}})),this.runTriggers(this.options.triggers)}runTriggers(e=[]){e.forEach((({name:e,options:n})=>this.triggers.push(new L[e]({...n,trigger:()=>w().emit(e,n)}))))}ifInited=e=>{this.inited?e():l.widgetNotInited()};ifTimeout=e=>{const n=parseInt(window.localStorage.getItem("sendsay_web_push_timeout"),10)||0;if("never"===this.options.timeout)return void(n||e());(new Date).getTime()-n>(this.options.timeout||0)&&e()};writeTimeout=e=>{window.localStorage.setItem("sendsay_web_push_timeout",(new Date).getTime()),e()};ifNotSubscribed=async e=>{await this.isSubscribed()?l.subscribedAlready():e()};ifCanSubscribeOrDeny=async e=>{await this.worker.canSubscribe()?e():w().emit("requestDenied")};ifWidthAllowed=e=>{window.innerWidth>600?e():l.smallWindow()};onClick=async(e,{showDialogFirst:n=!1})=>{const t=await this.isSubscribed();"denied"===this.getPermission()?w().emit("requestDenied"):t?w().emit("requestCompletedSubscription"):w().emit(n?"requestDialog":"requestSubscription")};createDenied=()=>{!function(e){if(F)return void l.deniedOpened();F=!0;const n=document.createElement("sendsay-subscription-denied");e&&n.setAttribute("data-notifications-denied",!0),document.body.append(n)}("denied"===this.worker.getPermission())};createDialog(){x?l.dialogOpened():(x=!0,document.body.append(document.createElement("sendsay-subscription-dialog")))}createCompletedDialog(){m?l.dialogOpened():(m=!0,document.body.append(document.createElement("sendsay-subscription-completed")))}show(){w().emit("requestDialog")}deny(){w().emit("requestDenied")}subscribe=()=>{this.worker.subscribe()};isSubscribed(){return this.worker.isSubscribed()}getPermission(){return this.worker.getPermission()}addData(e){var n;if((n=e)&&n.constructor===Object)return this.worker.addData(e);l.dataNotObj()}}const U=(e,n)=>`https://sendsay.ru/backend/push/settings/${e}/${n}`;async function G(){if(window.sndsyApi||(window.sndsyApi={}),l.setDeviceId(function(){const e=document.cookie.split("; ").find((e=>e.startsWith("sndsy_dvc_id")));if(e)return e.split("=")[1]}()||function(){const e=(Math.random()+(new Date).getTime()).toString(36),n=new Date((new Date).getTime()+1e3);return document.cookie=`sndsy_dvc_id=${e}; path=/; expires=${n.toUTCString()}`,e}()),!("PushManager"in window&&"Notification"in window&&"serviceWorker"in navigator))return void l.webPushNotSupported();if("safari"in window&&v("Safari"))return void l.noSafari();window.sndsyApi.webPushWidget=new P;const{accountId:e,siteId:n,swPath:t}=document.getElementById("sendsay-sdk-script").dataset;if(!e||!n||"null"===e||"null"===n)return void l.missedIds();l.setEventProperties({accountId:e,siteId:n,domain:window.location.hostname});const i=await async function({accountId:e,siteId:n}){try{return(await fetch(U(e,n))).json()}catch(e){return e}}({accountId:e,siteId:n});if(i.error)return void("unknown_account_id"===i.error?l.unknownAccountId():"unknown_site_id"===i.error&&l.unknownSiteId());if(!i||!i.account)return void l.fetchFailed();let o=i.widgetSettings.showDialogCopyright;"actionmedia"===e&&(o=!1);try{await window.sndsyApi.webPushWidget.init({...i.widgetSettings,...i.systemSettings,showDialogCopyright:o,serviceWorkerPath:t||i.systemSettings.serviceWorkerPath,accountId:i.account})}catch(e){l.failedToInstall(e)}}"complete"===document.readyState?G():window.addEventListener("load",G)}();
