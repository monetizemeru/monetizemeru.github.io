(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{602:function(t,n,e){"use strict";e.r(n),e.d(n,"PhotoMapWidget",(function(){return C}));var r=e(2),o=e.n(r),i=e(0),u=e(68),c=e(4);function a(t,n,e,r,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void e(t)}c.done?n(a):Promise.resolve(a).then(r,o)}function f(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function u(t){a(i,r,o,u,c,"next",t)}function c(t){a(i,r,o,u,c,"throw",t)}u(void 0)}))}}function s(t){return p.apply(this,arguments)}function p(){return(p=f(o.a.mark((function t(n){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.post("/front_api/photo_maps/batch_fetch_pins.json",{data:{digests:n}});case 2:return e=t.sent,t.abrupt("return",(function(t){var n=t.digest;return e[n]}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var l=e(659),h=e(7);function d(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function v(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,n){return(y=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function b(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=w(t);if(n){var o=w(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return O(this,e)}}function O(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P={text:Object(h.a)((function(){return e.e(99).then(e.bind(null,778))}),"TextPin"),product:Object(h.a)((function(){return e.e(94).then(e.bind(null,779))}),"ProductPin"),external_product:Object(h.a)((function(){return e.e(87).then(e.bind(null,780))}),"ExternalProductPin"),template:Object(h.a)((function(){return e.e(98).then(e.bind(null,781))}),"TemplatePin")},j=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&y(t,n)}(u,t);var n,e,r,o=b(u);function u(){var t;return d(this,u),(t=o.apply(this,arguments)).handlePinClick=function(t){t.stopPropagation()},t}return n=u,(e=[{key:"render",value:function(){var t=this,n=this.props.pins;return Object(i.h)("div",null,n.map((function(n,e){var r=P[n.type],o=Object(l.a)({x:n.x,y:n.y});return Object(i.h)(r,{pin:n,zone:o,key:e,onClick:t.handlePinClick})})))}}])&&v(n.prototype,e),r&&v(n,r),u}(i.Component);function g(t,n,e,r,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void e(t)}c.done?n(a):Promise.resolve(a).then(r,o)}function m(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,n){return(x=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function k(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=R(t);if(n){var o=R(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return E(this,e)}}function E(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&x(t,n)}(p,t);var n,e,r,c,a,f=k(p);function p(){var t;return m(this,p),(t=f.apply(this,arguments)).state={pins:[]},t.handleOpenEditor=function(n){n.stopPropagation(),t.props.onOpenEditor()},t}return n=p,(e=[{key:"componentWillMount",value:function(){this.fetchPins()}},{key:"fetchPins",value:(c=o.a.mark((function t(){var n,e,r,i,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.props,e=n.digest,r=n.productId,i={digest:e},r&&(i.product_id=r),t.next=5,u.a.request(s,i);case 5:if(t.t0=t.sent,t.t0){t.next=8;break}t.t0=[];case 8:c=t.t0,this.setState({pins:c});case 10:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,n=arguments;return new Promise((function(e,r){var o=c.apply(t,n);function i(t){g(o,e,r,i,u,"next",t)}function u(t){g(o,e,r,i,u,"throw",t)}i(void 0)}))},function(){return a.apply(this,arguments)})},{key:"render",value:function(){var t=this.state.pins;return Object(i.h)("div",null,this.isEditable&&Object(i.h)("div",null,Object(i.h)("button",{type:"button",className:"_edit",onClick:this.handleOpenEditor})),t.length>0&&Object(i.h)(j,{pins:t}))}},{key:"isEditable",get:function(){var t;return!this.props.productId&&Env.isLogged&&(null===(t=null===Env||void 0===Env?void 0:Env.user)||void 0===t?void 0:t.ability.showPinsEditor)}}])&&_(n.prototype,e),r&&_(n,r),p}(i.Component)},659:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"c",(function(){return o})),e.d(n,"d",(function(){return i})),e.d(n,"a",(function(){return u}));var r=function(t){return t instanceof DOMRect},o=function(t,n){var e=n.x,r=n.y;return e<t.left&&(e=t.left),e>t.right&&(e=t.right),r<t.top&&(r=t.top),r>t.bottom&&(r=t.bottom),{x:e-t.left,y:r-t.top}},i=function(t,n){var e=n.x,r=n.y;return{x:e/t.width*100,y:r/t.height*100}},u=function(t){var n=t.x,e=t.y;return[Number(n-50>=0),Number(e-50>=0)].join("")}}}]);
//# sourceMappingURL=sourcemap.site_c-PhotoMapWidget.7e1202b9.map