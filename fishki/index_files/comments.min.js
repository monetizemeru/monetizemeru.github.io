!function(t){function e(e){for(var i,a,r=e[0],l=e[1],c=e[2],u=0,d=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(m&&m(e);d.length;)d.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,r=1;r<s.length;r++){var l=s[r];0!==o[l]&&(i=!1)}i&&(n.splice(e--,1),t=a(a.s=s[0]))}return t}var i={},o={1:0},n=[];function a(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.e=function(){return Promise.resolve()},a.m=t,a.c=i,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/dist/",a.oe=function(t){throw console.error(t),t};var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var m=l;n.push([79,0]),s()}({0:function(t,e,s){"use strict";(function(t){var i,o,n,a,r,l,c=s(4),m=s.n(c),u=s(23),d=s.n(u),p=s(24),h=s.n(p),f=s(29),v=[],_={lightbox:"/public/assets/js/lightbox.min.js",jgrowl:"/public/assets/js/jquery.jgrowl.min.js"},g=new d.a(h.a),b=t.env.VUE_APP_PROFILE||"",y={favicon:"",imgloader:"/assets/images/loading.gif"};if(t.env.VUE_APP_DEV_HOST){var w="http://";t.env.VUE_APP_DEV_SSL&&parseInt(t.env.VUE_APP_DEV_SSL)&&(w="https://"),i=w+t.env.VUE_APP_DEV_HOST,o=w+t.env.VUE_APP_DEV_HOST,n=w+t.env.VUE_APP_DEV_HOST,a=w+t.env.VUE_APP_DEV_TN_HOST,y.imgloader="/images/loader-h.svg"}else switch(y.imgloader="/images/loader-h.svg",location.hostname){case"m.fishki.net":b="fishki",i="https://m.fishki.net",o="https://sos.fishki.net",n="https://sos.fishki.net",a="https://tn.fishki.net";break;case"old.fishki.net":b="fishki",i="https://old.fishki.net",o="https://sos.fishki.net",n="https://sos.fishki.net",a="https://tn.fishki.net";break;case"realfishki.net":i="https://realfishki.net",o="https://s.realfishki.net",n="https://s.realfishki.net",a="https://tn.realfishki.net";break;default:b="fishki",i="https://fishki.net",o="https://sos.fishki.net",n="https://sos.fishki.net",a="https://tn.fishki.net"}"undefined"!=typeof window&&window&&window.fishki&&window.fishki.app&&window.fishki.app.hostUrl&&(b=window.fishki.app.envProfile,i=window.fishki.app.hostUrl,a=window.fishki.app.tnHostUrl,o=window.fishki.app.staticHostUrl,n=window.fishki.app.sourceStaticHostUrl,_=window.fishki.app.scripts);for(var k=[i,o,n,a],C=0;C<4;C++){var x=k[C].replace(/^http[s\u017F]?:\/\//i,"//");v.indexOf(x)<0&&(v.push(x),v.push("http:"+x),v.push("https:"+x))}function S(){return a}function M(t){return o}function D(t){var e=t.trim();return e.length&&(e.indexOf(a)>-1&&(e=e.replace(l,"")),0===e.indexOf("/tn")&&(e=e.replace(/tn\/\d+/,"")),e=e.replace(r,"")),e}r=new RegExp("("+v.join("|")+")"),l=new RegExp("^"+a+"/d+"),"anews"===b?y.favicon="//cdn.anews.com/favicon.ico ":"fishki"===b&&(y.favicon="//cdn.fishki.net/favicon_fishki.ico"),console.log("Config env",{NODE_ENV:"production",host:i,site:y}),e.a={isDev:!1,isM:i.indexOf("m.fishki")>-1,hostUrl:i,domain:function(){return this.hostUrl.replace("http://","").replace("https://","")},tnUrl:a,staticUrl:o,getImageLink:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=D(t),i=0===t.indexOf("//");if(e.tn_size&&(s!=t||i)&&(t=s),0===t.indexOf("/")){var o=parseInt(e.sync?e.sync:1,10);t=e.tn_size?S(o)+"/"+e.tn_size+t:M()+t}return t},getStaticTnHost:S,site:y,endpoint:{editorApi:"editor/api",api:"api-req",file:"api-req/upload.imagecomment"},urlEndpoint:function(t){return this.hostUrl+"/"+this.endpoint[t]},url:function(t){return this.hostUrl+t},file:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"random"===e.toLowerCase()&&(e=Math.random(1e7));var i=e?(t.indexOf("?")>=0?"&":"?")+e:"";return 0===t.indexOf("//")&&(t="https:"+t),0!==t.indexOf("http")&&(t=o+t),s&&(t+=s),t+i},mime:function(t){return f.lookup(t)},user:{cookies:{sid:"PHPSESSID",autologin:"iam"}},ssrContext:null,setContext:function(t){this.ssrContext=t},isSSR:function(){return!!ssrContext},categories:m.a.categories||[],enable:{lazyLoad:!0},getUAData:function(){return{platform:navigator.platform||"",ua:navigator.userAgent||navigator.appVersion||"",ua_width:window.innerWidth||window.width||0,ua_height:window.innerHeight||window.height||0,screen_width:screen.width||0,screen_height:screen.height||0,host:window.location.host}},tn:m.a.tn||[],votes:m.a.votes||[],recaptchav3:m.a.recaptchav3||"",version:{facebook:"v12.0"},hypher_ru:g,myTrim:function(t,e,s){if(e=e||0,s=s||!1,(t=t||"").length>e){if(!s)return t.substr(0,e-3)+"...";var i=(t=t.replace("\r","")).replace("\n"," ").substr(0,e-3).split(" "),o=(i=count(i)>1?i.slice(0,count(i)-1):i).join(" ").length;t=t.substr(0,o)+"..."}return t},upload:{image:{size:m.a.upload_limit.upload_image.size_limit,autoCompress:m.a.upload_limit.upload_image.size_limit/2,accept:"image/png,image/gif,image/jpeg,image/webp",extensions:"gif,jpg,jpeg,png,webp"},video:{size:m.a.upload_limit.upload_video.size_limit,accept:"video/wmv,video/mp4,video/webm",extensions:"wmv,mp4,webm"},mp3:{size:m.a.upload_limit.upload_mp3.size_limit,accept:"audio/mpeg",extensions:"mp3"},gif:{size:m.a.upload_limit.upload_animated_gif.size_limit,accept:"image/gif",extensions:"gif"},compress:{convertSize:1/0,maxWidth:1024,maxHeight:1024}},scripts:_,imagespath:"/public/assets/images/"}}).call(this,s(28))},1:function(t,e){t.exports=videojs},10:function(t,e,s){"use strict";var i=s(0),o={extend:function(t){t=t||{};for(var e=1,s=arguments.length;e<s;++e){var i=arguments[e];if(i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&("[object Object]"!==Object.prototype.toString.call(i[o])?t[o]=i[o]:t[o]=this.extend(t[o],i[o]))}return t},extendVue:function(t,e){e=e||{};for(var s=1,i=arguments.length;s<i;++s){var o=arguments[s];if(o)for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&("[object Object]"!==Object.prototype.toString.call(o[n])?t.$set(e,n,o[n]):(e[n]||t.$set(e,n,{}),t.$set(e,n,this.extend(e[n],o[n]))))}return e}},n=s(16),a=function(t){var e=t||"",s={source:e=e.trim(),basedomain:""};if(e.length){var i=e.replace("http:","http");i=(i=i.replace("https://li.ru/go?","")).indexOf("://")<0?"https://"+i:i;try{var o=(s=new URL(i)).host.split(".");o.length>1&&(o=[o[o.length-2],o[o.length-1]]),s.basedomain=o.join("."),s.source="/go/?url="+encodeURIComponent(i)}catch(t){s.error=!0}}return s},r={getPreview:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=t.gallery_preview||t.gallery_embed||t.gallery_link,n=s?"."+s:"";return o?i.a.getImageLink(o+n,this.imgParams(t)):i.a.file("/"+e+"/preview/"+t.post_id+".jpg"+n)},imgParams:function(t){var e={sync:t.sync?1:0};return t.tn_size&&(e.tn_size=t.tn_size),e}};e.a={computed:{getMime:function(){return i.a.mime(this.gallery.gallery_link)},isWebp:function(){return i.a.tn.enabled_webp&&this.gallery.gallery_properties&&this.gallery.gallery_properties.has_webp&&this.gallery.gallery_link&&this.gallery.gallery_link.indexOf(".webp")<0?1:0},linkimg:function(){return i.a.file(this.gallery.gallery_link?this.gallery.gallery_link:this.gallery.post_id?"/20/preview/"+this.gallery.post_id+".jpg":"")},imgAlt:function(){return this.gallery.meta&&this.gallery.meta.img_alt?this.gallery.meta.img_alt:this.gallery.gallery_title?this.gallery.gallery_title:this.post.title},imgTitle:function(){return this.gallery.meta&&this.gallery.meta.title?this.gallery.meta.title:this.gallery.gallery_title?this.gallery.gallery_title:this.post.title},imgParams:function(){return r.imgParams(this.gallery)},preview:function(){return r.getPreview(this.gallery,20)},previewWebp:function(){return r.getPreview(this.gallery,20,"webp")}},methods:{calcSource:function(t){return a(t)},pluralForm:function(t,e,s,i){return n.a.pluralForm(t,e,s,i)},isNumeric:function(t){return n.a.isNumeric(t)},date_ago:function(t,e){return n.a.dateAgo(t,e)},extend:function(){return o.extend.apply(o,arguments)},extendVue:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return o.extendVue.apply(o,[this].concat(e))},isElementInViewport:function(t){"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]);var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}}}},15:function(t,e,s){"use strict";var i=s(1),o=s.n(i);s(31),s(33),s(34),s(35);e.a={loadVideo:function(t,e,s,i,n,a,r,l){if(n){n.vast_preroll||(n.vast_preroll="https://fishki.net/files/fishki.net/vmap.php?flv="+encodeURIComponent(window.location.href)+"&r="+Math.random());var c=document.getElementById("gallery_"+l);(c=c&&c.id?c:window)&&c.clientWidth<n.width&&(n.height=Math.round(c.clientWidth/n.width*n.height),n.width=c.clientWidth);var m=o()(t,n);if(!r){"function"==typeof m.ima&&m.ima({id:t,adTagUrl:n.vast_preroll,adLabel:"Реклама",vastLoadTimeout:1e4});var u="click";(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(u="touchend"),m.one(u,(function(){m.ima.initializeAdDisplayContainer()})),m.on("adstart",(function(t){m.ima.getAdsManager().setVolume(.3)}))}var d=document.getElementById(t+"_html5_api");(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&d&&d.hasAttribute("controls")&&d.removeAttribute("controls")}}}},16:function(t,e,s){"use strict";e.a={fixSafariDate:function(t){return"string"==typeof t?t.replace(/\s/,"T"):t},dateAgo:function(t,e){e=e||!1,this.isNumeric(t)||(t=Date.parse(this.fixSafariDate(t)));var s,i,o,n=Math.floor((Date.now()-t)/1e3),a=!1;return n<60?(s=n>0?n:1)>=25&s<=35?(i="полминуты",a=!0):i=this.pluralForm(s,"секунду","секунды","секунд"):n<3600?(s=Math.floor(n/60))>=25&s<=35?(i="полчаса",a=!0):i=this.pluralForm(s,"минуту","минуты","минут"):n<86400?(s=Math.round(n/3600),i=this.pluralForm(s,"час","часа","часов")):n<604800?(s=Math.round(n/86400),i=this.pluralForm(s,"день","дня","дней")):n<2592e3?(s=Math.round(n/604800),i=this.pluralForm(s,"неделю","недели","недель")):n<31536e3?(s=Math.round(n/2592e3),i=this.pluralForm(s,"месяц","месяца","месяцев")):(s=Math.round(n/31536e3),i=this.pluralForm(s,"год","года","лет")),o=a?i:1==s?""+i:s+" "+i,e&&(o=o.charAt(0).toUpperCase()+o.slice(1)),o},pluralForm:function(t,e,s,i){var o=(t=Math.abs(t)%100)%10;return t>10&&t<20?i:o>1&&o<5?s:1==o?e:i},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},stripSmiles:function(t){return t.replace(/:[0-9a-z_\-]{1,15}:/g,"")}}},17:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));var i=s(19);function o(t){var e=document.getElementById(t);e&&void 0!==e.offsetTop&&("undefined"!=typeof Vue&&Vue.nextTick?Vue.nextTick:i.nextTick)((function(){var t,s,i,o,n,a=(t=$("#"+e.id).offset(),s=document.body,i=document.documentElement,window.pageYOffset||i.scrollTop||s.scrollTop,window.pageXOffset||i.scrollLeft||s.scrollLeft,i.clientTop||s.clientTop,i.clientLeft||s.clientLeft,o=t.top,n=t.left,{top:Math.round(o),left:Math.round(n)}),r=document.getElementById("top-toolbar"),l=document.getElementsByClassName("header")[0];l=l&&["fixed","static"].indexOf(l.style.position)>-1?l.clientHeight:0,window.scrollTo({top:a.top-32-(r?r.clientHeight:0)-l,left:0,behavior:"smooth"})}))}},19:function(t,e){t.exports=void 0},20:function(t,e,s){"use strict";var i=s(0),o=s(15);e.a={bind:function(t,e,s){function n(t,e,s){for(var i=0;i<t.length;i++){var o=t[i];if(o.children&&o.children.length)return n(Array.from(o.children),e,s);if("class"==s&&o.classList.contains(e)||o.nodeName===e)return o}}function a(){switch(t.dataset.type){case"facebook":n(Array.from(t.children),"fb-post","class")&&window.FB&&window.FB.init({xfbml:!0,version:i.a.version.facebook}),t.classList.remove("content__figure__wrap__lazy");break;case"instagram":n(Array.from(t.children),"instagram-media","class")&&window.instgrm&&window.instgrm.Embeds.process(),t.classList.remove("content__figure__wrap__lazy");break;case"twitter":n(Array.from(t.children),"twitter-tweet","class")&&window.twttr&&window.twttr.widgets.load(),t.classList.remove("content__figure__wrap__lazy");break;case"vk":var e=n(Array.from(t.children),"vk-post","class");e&&window.VK&&VK.Widgets.Post(e.attributes.id.value,e.dataset.ownerId,e.dataset.postId,e.dataset.hash),t.classList.remove("content__figure__wrap__lazy");break;case"tiktok":n(Array.from(t.children),"tiktok-embed","class");t.classList.remove("content__figure__wrap__lazy");break;case"tme":if(t.dataset.telegramPost){var s=document.createElement("script");s.async="async",s.defer="defer",s.src=t.dataset.src,s.dataset.telegramPost=t.dataset.telegramPost,s.type="text/javascript",s.onreadystatechange=s.onload=s.onerror=function(){t.classList.remove("content__figure__wrap__lazy")},t.appendChild(s)}break;case"iframe":var a=n(Array.from(t.children),"IFRAME","name");a&&(a.src=a.dataset.src),t.classList.remove("content__figure__wrap__lazy");break;case"video":var r=t.getElementsByTagName("source");if(r)for(var l=0;l<r.length;l++)r[l].src=r[l].dataset.src;var c=t.getElementsByTagName("video");if(c)for(l=0;l<c.length;l++)if(c[l].attributes.id){var m={autoplay:!1,controls:!0,preload:"auto"};c[l].attributes.width&&c[l].attributes.width.value&&(m.width=c[l].attributes.width.value),c[l].attributes.height&&c[l].attributes.height.value&&(m.height=c[l].attributes.height.value),c[l].attributes.poster&&c[l].attributes.poster.value&&(m.poster=c[l].attributes.poster.value),o.a.loadVideo(c[l].attributes.id.value,!0,!1,!1,m,!1,0,c[l].dataset.post_id)}t.classList.remove("content__figure__wrap__lazy");break;default:var u=n(Array.from(t.children),"IMG","name");u&&u.dataset&&u.dataset.src&&(u.addEventListener("error",(function(){return t.classList.remove("content__figure__wrap__lazy")})),u.addEventListener("load",(function(){return t.classList.remove("content__figure__wrap__lazy")})),u.src=u.dataset.src)}}function r(e,s){e.forEach((function(e){e.isIntersecting&&(a(),s.unobserve(t))}))}e.value&&(window.IntersectionObserver?new IntersectionObserver(r,{root:null,threshold:"0"}).observe(t):a())}}},21:function(t,e,s){"use strict";e.a={bind:function(t,e,s){t.clickOutsideEvent=function(i){t==i.target||t.contains(i.target)||s.context[e.expression](i)},document.body.addEventListener("click",t.clickOutsideEvent)},unbind:function(t){document.body.removeEventListener("click",t.clickOutsideEvent)}}},3:function(t,e,s){"use strict";var i=s(25),o=s.n(i),n=s(18),a=s.n(n),r=s(26),l=s.n(r),c=s(27),m=s.n(c),u=s(0),d=s(9),p=s(8);function h(t,e){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,r=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return a=t.done,t},e:function(t){r=!0,n=t},f:function(){try{a||null==s.return||s.return()}finally{if(r)throw n}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function v(){return(v=o()(a.a.mark((function t(e,s){var i,o=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=o.length>2&&void 0!==o[2]?o[2]:null,s||(s={}),t.abrupt("return",new Promise((function(t,o){if(e){var n;i&&i instanceof FormData?(n=i).append("params",JSON.stringify(s)):n=l.a.stringify({params:JSON.stringify(s)});var a={headers:{},withCredentials:!0},r=p.a.get(u.a.user.cookies.sid);return r&&(a.headers["X-Sid"]=r),m.a.post(u.a.urlEndpoint("api")+"/"+e,n,a).then((function(i){u.a.isDev&&console.log("API CALL",{cfg:a,method:e,params:s,response:i.data}),i.data&&void 0!==i.data.status&&!i.data.status?(b(i),o(i)):t(i)}),(function(t){return b(t),o(t)}))}o(new Error("Method is undefined"))})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t,e,s,i){try{"undefined"!=typeof window&&window.$&&window.$.jGrowl?g(t,e,s,i):d.a.loadScript(u.a.scripts.jgrowl,(function(){g(t,e,s,i)}))}catch(t){}}function g(t,e,s,i){if(t){var o="green";s||(s="default"),"error"==s&&(o="red");window.$.jGrowl.defaults.position="top-left",window.$.jGrowl.defaults.closer=!1,window.$.jGrowl(t,{glue:"before",header:e||"",life:i||1e4,sticky:!1,animateOpen:{height:"show",width:"show"},animateClose:{height:"hide",width:"show"},theme:s,closeTemplate:'<span class="close1"><img src="'+u.a.imagespath+"fishki/"+o+'_cross.gif" alt="close" /></span>'})}}function b(t){if(t.data&&(t.data.errors||t.data.message)){var e,s=h(t.data.errors||[{message:t.data.message,code:t.data.code}]);try{for(s.s();!(e=s.n()).done;){var i;_(e.value.message,"","error")}}catch(i){s.e(i)}finally{s.f()}}}e.a={call:function(t,e){return v.apply(this,arguments)},processErrors:b,showMessage:_}},30:function(t,e,s){"use strict";e.a={methods:{copyToClipboard:function(t){t.preventDefault();var e=t.target,s=this;document.getElementsByTagName("body")[0];if("undefined"!=typeof window&&void 0!==window.getSelection){window.getSelection();var i=e.innerText;e.innerText="Ссылка скопирована",e.parentElement.style.background="yellow";var o=document.createElement("input");return o.setAttribute("value",this.eUrl),document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),window.setTimeout((function(){e.innerText=i,e.parentElement.style.background="",s.shareShow=!1}),2e3),!1}}}}},32:function(t,e){},37:function(t,e,s){"use strict";s(7),s(3)},39:function(t,e,s){"use strict";var i=s(8),o=s(10),n=s(3),a=s(9),r=s(0),l=s(15),c=(s(36),{computed:{},methods:{decodeHtml:function(t){return decodeURIComponent(t.replace(/\+/g," "))},escapeHtml:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,(function(t){return e[t]}))},commentUser:function(t,e){return e&&t&&t.comments&&t.comments.users&&t.comments.users[e.user_id]?t.comments.users[e.user_id]:{}},replyUser:function(t,e){return e&&t&&t.comments&&t.comments.users&&t.comments.users[e.reply_user_id]?t.comments.users[e.reply_user_id]:{}},getComments:function(t,e,s,o){var a=this,r=parseInt(i.a.get("c_sort"),10);r=r||0,e.sort=r,e.post_id=a.post.post_id,e.gallery_id=a.post.gallery_id,e.comment_photo=void 0===e.comment_photo?!!t.flags.comment_photo:e.comment_photo,o=o||{},n.a.call("comment.lists",e).then((function(t){if(t&&t.data){if(a.$set(a.post.comments,"post",t.data.post),a.$set(a.post.comments,"gitems",t.data.gitems),a.$set(a.post.comments,"more",t.data.comments.more),a.$set(a.post.comments,"answer_count",t.data.comments.answer_count),a.$set(a.post.comments,"total_number_comments",t.data.comments.total_number_comments),a.extendVue(a.post.commentsGroupLikes,t.data.groupLikes),"get"==s)a.$set(a.post.comments,"users",t.data.comments.users),a.$set(a.post.comments,"answers",t.data.comments.answers),a.$set(a.post.comments,"list",t.data.comments.list);else{a.extendVue(a.post.comments.users,t.data.comments.users),a.extendVue(a.post.comments.answers,t.data.comments.answers);var e={};if("next"==s)for(var i in t.data.comments.list)e[i]=t.data.comments.list[i],e[i].weight+=o.weight+1e3;else if("prev"==s){var n=0;for(var i in t.data.comments.list)t.data.comments.list[i].weight>n&&(n=t.data.comments.list[i].weight);for(var i in t.data.comments.list)e[i]=t.data.comments.list[i],e[i].weight+=-n-1e3-o.weight}a.extendVue(a.post.comments.list,e)}a.$nextTick((function(){a.checkEmbeded()}))}})).catch((function(t){console.log(t)})).finally((function(){}))},getMore:function(t){return!(!this.post.comments.more||!this.post.comments.more[t])&&this.post.comments.more[t]},hasReplies:function(t){return!(!this.post.comments.answers||!this.post.comments.answers[t])},hasMore:function(t,e){e=e||!1;var s=this.getMore(t);return e?!!(s&&s[e]&&s[e]>0):!!s},getMoreTextAnswer:function(t){var e=this.getMore(t);if(e&&(e.delta>this.limitanswer||e.skip>0)){var s=Math.min(e.delta,this.limitanswer);return"Показать ещё "+s+" "+this.pluralForm(s,"ответ","ответа","ответов")+(e.delta>this.limitanswer?" из "+e.delta:"")}var i="все";return e.delta<e.all&&(i="ещё"),(e.delta>1?"Показать "+i+" ":"Показать ")+e.delta+" "+this.pluralForm(e.delta,"ответ","ответа","ответов")},getPrevTextAnswer:function(t){var e=this.getMore(t),s=Math.min(e.skip,this.limitanswer);return e.skip<=this.limitanswer?"Показать "+s+" "+this.pluralForm(s,"ответ","ответа","ответов"):"Показать ещё "+s+" "+this.pluralForm(s,"ответ","ответа","ответов")+" из "+e.skip},commentClass:function(t){var e=["comment"];return this.hasMore(t)&&e.push("has-more"),this.hasReplies(t)&&e.push("has-replies"),e.join(" ")},filterAnswers:function(t){var e=[];for(var s in t)e.push(t[s]);return e.sort((function(t,e){return parseInt(t.dttime)>parseInt(e.dttime)?1:-1}))},getMoreAnswers:function(t,e){var s=this;e=e||!1;var i=this.getMore(t),o=this.filterAnswers(this.post.comments.answers[t]),a=(i.last_answer_id?i.last_answer_id:e?o[o.length-1].id:o[0].id).toString(),r={post_id:this.post.post_id,gallery_id:this.post.gallery_id,comment_photo:!!this.post.flags.comment_photo,parent_comment_id:t,last_answer_id:a};e&&(r.backward=!0),n.a.call("comment.answers",r).then((function(t){t&&t.data&&(i.last_answer_id=0,e?i.skip-=s.limitanswer:i.delta-=s.limitanswer,s.extendVue(s.post.comments.users,t.data.users),s.extendVue(s.post.comments.answers,t.data.answers),s.extendVue(s.post.commentsGroupLikes,t.data.commentsGroupLikes))})).catch((function(t){console.log(t)})).finally((function(){}))},calcEmbed:function(t){if(t){var e=this.post.comments.content?this.post.comments.content:{};return"embed"==t.type?t.source.indexOf("instagram.com")>-1?e.hasInstagram=!0:t.source.indexOf("twitter.com")>-1?e.hasTwitter=!0:t.source.indexOf("facebook.com")>-1?e.hasFacebook=!0:t.source.indexOf("tiktok.com")>-1?e.hasTiktok=!0:t.source.indexOf("vk.com")>-1?e.hasVk=!0:t.source.indexOf("t.me")>-1&&(e.hasTme=!0):"gif"==t.type?e.hasGif=!0:"videojs"==t.type&&(e.hasVideo=!0),this.post.comments.content=e,e}},checkEmbeded:function(){var t=this.post.comments.content?this.post.comments.content:{};for(var e in this.post.comments.list){var s=this.post.comments.list[e];if(s&&s.body&&s.body.length)for(var i in s.body){var o=s.body[i];o&&(t=this.calcEmbed(o))}}for(var e in this.post.comments.answers)if(this.post.comments.answers[e])for(var n in this.post.comments.answers[e]){var c=this.post.comments.answers[e][n];if(c&&c.body&&c.body.length)for(var i in c.body){var m=c.body[i];m&&(t=this.calcEmbed(m))}}t.hasGif&&$("#coverlay_"+this.post.post_id+"_"+this.post.gallery_id+" .gif-animated-link").not(".gif-checked").each((function(){$(this).addClass("gif-checked"),$(this).on("click",(function(t){return t.preventDefault(),t.stopImmediatePropagation(),gifAnimated(this),!1})),$(this).on("touchstart",(function(){return gifAnimated(this,!0)}))})),t.hasInstagram&&(window.instgrm?window.instgrm.Embeds.process():a.a.loadScript("https://www.instagram.com/embed.js",(function(){}))),t.hasTwitter&&(window.twttr?window.twttr.widgets.load():a.a.loadScript("https://platform.twitter.com/widgets.js",(function(){}))),t.hasFacebook&&a.a.loadScript("https://connect.facebook.net/ru_RU/all.js",(function(){window.FB&&FB.init({xfbml:!0,version:r.a.version.facebook})})),t.hasTiktok&&a.a.loadScript("https://www.tiktok.com/embed.js",(function(){})),t.hasVk&&a.a.loadScript("https://vk.com/js/api/openapi.js?169",(function(){for(var t=document.getElementsByClassName("vk-post"),e=0;e<t.length;e++){var s=t[e];s.classList.contains("vk-post-checked")||(s.classList.add("vk-post-checked"),VK.Widgets.Post(s.attributes.id.value,s.dataset.ownerId,s.dataset.postId,s.dataset.hash))}})),t.hasTme,t.hasVideo&&a.a.loadScript("https://imasdk.googleapis.com/js/sdkloader/ima3.js",(function(){var t=document.getElementsByClassName("comment-overlay");if(t)for(var e=0;e<t.length;e++){var s=t[e].getElementsByTagName("video");if(s)for(var i=0;i<s.length;i++)if(s[i].attributes.id&&s[i].parentElement.classList.contains("video-js")&&!s[i].parentElement.classList.contains("mvideo-post-checked")){var o={autoplay:!1,controls:!0,preload:"auto"};s[i].attributes.width&&s[i].attributes.width.value&&(o.width=s[i].attributes.width.value),s[i].attributes.height&&s[i].attributes.height.value&&(o.height=s[i].attributes.height.value),s[i].attributes.poster&&s[i].attributes.poster.value&&(o.poster=s[i].attributes.poster.value),l.a.loadVideo(s[i].attributes.id.value,!0,!1,!1,o,!1,0,s[i].dataset.post_id),s[i].parentElement.classList.add("mvideo-post-checked")}}}))}}}),m={computed:{},methods:{carma2string:function(t){var e=t&&t.carma?t.carma:0;return(e=e&&void 0!==e.total?e.total:e)>=1e3?e>1e6?Math.floor(e/1e5)/10+"M":Math.floor(e/1e3)+"k":e},avatar:function(t,e){if(e=e||18,t&&(t.user_id||t.id)){var s=t.user_id?t.user_id:t.id,i=t.revision?"?"+t.revision:"";return r.a.getStaticTnHost()+"/"+e+"/upload/avatar/"+s+".jpg"+i}return""},classUser:function(t){var e=t&&t.carma?t.carma:0,s=["star__small"];return(e=e&&void 0!==e.total?e.total:e)<1e3&&s.push("star__small--silver"),e<1e4?s.push("star__small--1"):e>=1e4&&e<1e5?s.push("star__small--2"):s.push("star__small--3"),s.join(" ")},userName:function(t){return(t.name?t.name:t.user_id?"user_"+t.user_id:"").replace(/^\s+|\s+$/g,"")}}},u=s(12),d=s.n(u),p={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{text:function(){return decodeURIComponent(this.gallery.text.replace(/\+/g," "))}},methods:{}},h=s(2),f=Object(h.a)(p,(function(){var t=this.$createElement;return(this._self._c||t)("div",{domProps:{innerHTML:this._s(this.text)}})}),[],!1,null,null,null).exports,v={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{},methods:{}},_=Object(h.a)(v,(function(){var t=this.$createElement;return(this._self._c||t)("a",{attrs:{href:this.gallery.url}},[this._v(this._s(this.gallery.decodeurl))])}),[],!1,null,null,null).exports,g={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{galleryText:function(){return decodeURIComponent(this.gallery.text.replace(/\+/g," "))}},methods:{}},b=Object(h.a)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"self-post"},[s("a",{attrs:{href:t.gallery.link}},[s("img",{staticClass:"post-icon",attrs:{alt:t.gallery.title,src:t.gallery.preview}})]),t._v(" "),s("div",{staticClass:"post-content"},[s("a",{staticClass:"post-name",attrs:{href:t.gallery.link,title:t.gallery.title}},[t._v(t._s(t.gallery.title))]),t._v(" "),t.gallery.text?s("p",{domProps:{innerHTML:t._s(t.galleryText)}}):t._e()])])}),[],!1,null,null,null).exports,y={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{},methods:{}},w=Object(h.a)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"self-post"},[s("a",{attrs:{href:t.gallery.link}},[s("img",{staticClass:"post-icon",attrs:{alt:t.gallery.title,src:t.gallery.preview}})]),t._v(" "),s("div",{staticClass:"post-content"},[s("a",{staticClass:"post-name",attrs:{href:t.gallery.link,title:t.gallery.title}},[t._v(t._s(t.gallery.title))]),t._v(" "),t.gallery.text?s("p",{domProps:{innerHTML:t._s(t.gallery.text)}}):t._e()])])}),[],!1,null,null,null).exports,k={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},type:{type:String,required:!0},num:{type:Number,required:!0}},mixins:[o.a,c],computed:{embed:function(){return this.decodeHtml(this.gallery.embed)},parsed:function(){return"tme"==this.type?this.embed.match(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+[s\u017F]rc="((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+data\x2Dtelegram\x2Dpo[s\u017F]t="((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?)"/i):[]},datasrc:function(){return"tme"==this.type?this.parsed[1]:""},telegrampost:function(){return"tme"==this.type?this.parsed[2]:""}},methods:{},mounted:function(){if("tme"==this.type){var t=document.createElement("script");t.async="async",t.defer="defer",t.src=this.datasrc,t.dataset.telegramPost=this.telegrampost,t.type="text/javascript",this.$refs.script.appendChild(t)}}},C=Object(h.a)(k,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},["tme"!=this.type?e("div",{domProps:{innerHTML:this._s(this.embed)}}):e("div",{ref:"script",attrs:{"data-telegram-post":this.telegrampost,"data-src":this.datasrc}})])}),[],!1,null,null,null).exports,x={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{gallerySrc:function(){return r.a.file(this.gallery.src)},gallerySmallSrc:function(){return r.a.file(this.gallery["src-small"])}},methods:{}},S=Object(h.a)(x,(function(){var t=this.$createElement,e=this._self._c||t;return e("a",{attrs:{target:"_blank","data-lightbox":"img_"+this.comment.id+"_light_"+this.num,href:this.gallerySrc,"data-alt":this.gallery.alt}},[e("img",{staticClass:"img-responsive mb-1",attrs:{src:this.gallerySmallSrc,alt:this.gallery.alt}})])}),[],!1,null,null,null).exports,M={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{gallerSrc:function(){return r.a.file(this.gallery.src)},gallerSrcGif:function(){return r.a.file(this.gallery.srcgif)},gallerVideo:function(){return r.a.file(this.gallery.video)},gallerPoster:function(){return r.a.file(this.gallery.poster)}},methods:{}},D=Object(h.a)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"gif-cover"},[s("a",{staticClass:"gif-animated-link",attrs:{rel:"nofollow","data-href":t.gallery.link}},[s("div",{staticClass:"gif-static"},[s("img",{staticClass:"post-pic-inline",attrs:{src:t.gallerSrc,alt:t.gallery.alt,title:t.gallery.alt,itemprop:"contentUrl",decoding:"async",width:t.gallery.width,height:t.gallery.heightpreview}}),t._v(" "),s("span",{staticClass:"gif-over"},[t._v("Посмотреть")])]),t._v(" "),s("div",{staticClass:"gif-animated hide"},[t.gallery.video?t._e():s("img",{staticClass:"noload post-pic-inline",attrs:{"data-src":t.gallerSrcGif,alt:t.gallery.alt,title:t.gallery.alt,decoding:"async",width:t.gallery.width,height:t.gallery.height}}),t._v(" "),t.gallery.video?s("video",{staticClass:"hide",attrs:{oncanplaythrough:"this.className='canplay'",src:t.gallerVideo,loop:"loop",poster:t.gallerPoster,preload:"metadata",width:t.gallery.width,height:t.gallery.height}}):t._e()])])])}),[],!1,null,null,null).exports,O={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{getSrc:function(){var t=this.gallery.link.replace("http://","https://");return t+(t.indexOf("?")>-1?"&":"?")+"wmode=transparent"+(t.indexOf("youtu")>-1?"&fs=1":"")},additionalAttrs:function(){return this.gallery&&this.gallery.link.indexOf("youtu")>-1?{webkitallowfullscreen:!0,mozallowfullscreen:!0,allowfullscreen:!0}:this.gallery&&this.gallery.link.indexOf("facebook")>-1?{allowfullscreen:!0}:{}},getStyle:function(){if(this.gallery&&this.gallery.link.indexOf("youtu")<0){var t=this.gallery.width,e=this.gallery.height;if(t&&e){var s=t<736?t:736,i=s/t;e=(e=Math.ceil(i*e))<736?e:736,t=s}return"max-width: 100%;width:"+t+"px;height:"+e+"px;"}return"max-width: 100%"}},methods:{},mounted:function(){}},j=Object(h.a)(O,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-js vjs-4-3"},[e("iframe",this._b({staticClass:"vjs-tech",style:this.getStyle,attrs:{wmode:"transparent","data-original-width":this.gallery.width,"data-original-height":this.gallery.height,src:this.getSrc}},"iframe",this.additionalAttrs,!1))])}),[],!1,null,null,null).exports,F={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{},methods:{gallerySrc:function(t){return r.a.file(t)}},mounted:function(){}},E=Object(h.a)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment__gallery"},t._l(t.gallery.gallery,(function(e,i){return s("div",{class:"comment__gallery-row comment__gallery-row--"+e.length},t._l(e,(function(e){return s("figure",{staticClass:"comment__gallery-item"},[s("a",{attrs:{target:"_blank","data-lightbox":"img_"+t.comment.id+"_light_"+t.num,href:t.gallerySrc(e.src),"data-alt":t.gallery.alt}},[s("img",{staticClass:"img-responsive",attrs:{src:t.gallerySrc(e["src-small"]),alt:e.alt}})])])})),0)})),0)}),[],!1,null,null,null).exports,P={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{galleryLink:function(){return r.a.file(this.gallery.link)}},methods:{}},L=Object(h.a)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"audio-player",attrs:{"data-track":t.galleryLink}},[s("div",{staticClass:"audio-player__controls"},[s("button",{staticClass:"audio-player__button audio-player__play play",attrs:{type:"button"}},[s("svg",{staticClass:"play invertable"},[s("use",{attrs:{"xlink:href":"#audio-play"}})]),t._v(" "),s("svg",{staticClass:"pause invertable"},[s("use",{attrs:{"xlink:href":"#audio-pause"}})])]),t._v(" "),t._m(0)]),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"audio-player__controls"},[s("div",{staticClass:"audio-player__volume-container"},[s("button",{staticClass:"audio-player__button audio-player__volume-button not-muted",attrs:{type:"button"}},[s("svg",{staticClass:"not-muted invertable"},[s("use",{attrs:{"xlink:href":"#audio-volume"}})]),t._v(" "),s("svg",{staticClass:"muted invertable"},[s("use",{attrs:{"xlink:href":"#audio-volume-muted"}})])]),t._v(" "),t._m(2)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-player__time"},[e("div",{staticClass:"current"}),this._v(" "),e("div",{staticClass:"divider"}),this._v(" "),e("div",{staticClass:"length"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-player__timeline"},[e("div",{staticClass:"audio-player__progress"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-player__volume-slider"},[e("div",{staticClass:"audio-player__volume-percentage"})])}],!1,null,null,null).exports,A={components:{},props:{comment:{type:Object,required:!0},gallery:{type:Object,required:!0},num:{type:Number,required:!0}},mixins:[],computed:{isVideoWebm:function(){return!!(this.gallery.link&&this.gallery.link.indexOf(".webm")>-1)},galleryVideoMp4:function(){return r.a.file(this.gallery.link.replace(".flv",".mp4"))},galleryVideoWebm:function(){return r.a.file(this.gallery.link)}},methods:{}},T={components:{Plaintext:f,Link:_,Post:b,Postmix:w,Embeded:C,Photo:S,Gif:D,Video:j,Gallery:E,Mp3:L,Videojs:Object(h.a)(A,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"video-js video-js-over"},[s("video",{attrs:{id:"videomp4_c"+t.comment.id+"_"+t.num,width:t.gallery.width,height:t.gallery.height,poster:t.gallery.preview,"data-post_id":t.comment.post_id}},[s("source",{attrs:{src:t.galleryVideoMp4,type:"video/mp4"}}),t._v(" "),t.isVideoWebm?s("source",{attrs:{src:t.galleryVideoWebm,type:"video/webm"}}):t._e()])])}),[],!1,null,null,null).exports},props:{comment:{type:Object,required:!0}},mixins:[],computed:{},methods:{targetComponent:function(t){var e={is:!1,type:""};if("embed"==t.type)e.is="Embeded",t.source.indexOf("instagram.com")>-1?e.type="instagram":t.source.indexOf("twitter.com")>-1?e.type="twitter":t.source.indexOf("facebook.com")>-1?e.type="facebook":t.source.indexOf("tiktok.com")>-1?e.type="tiktok":t.source.indexOf("vk.com")>-1?e.type="vk":t.source.indexOf("t.me")>-1&&(e.type="tme");else{var s,i=(s={},d()(s,"text","Plaintext"),d()(s,"link","Link"),d()(s,"post","Post"),d()(s,"postmix","Postmix"),d()(s,"embed","Embeded"),d()(s,"image","Photo"),d()(s,"gif","Gif"),d()(s,"video","Video"),d()(s,"gallery","Gallery"),d()(s,"mp3","Mp3"),d()(s,"videojs","Videojs"),s);e.is=i[t.type]}return e}},mounted:function(){}},U=Object(h.a)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"commenttext",staticClass:"comment__text",attrs:{id:"commenttext_"+t.comment.id}},t._l(t.comment.body,(function(e,i){return s(t.targetComponent(e).is,{key:i,tag:"div",attrs:{num:i,type:t.targetComponent(e).type,comment:t.comment,gallery:e}})})),1)}),[],!1,null,null,null).exports,I=s(14),B=s(7),z=(s(19),s(5)),R={defaultOpacity:function(){return.8},getDemData:function(){return{width:840,height:441,in_width:492,in_height:250,left:174,top:45}},getWindWidth:function(){return document.documentElement.clientWidth||window.innerWidth||document.body.clientWidth},getWindHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},fontSize:function(t){return 48*this.scalableFactor(t)},bottomfontSize:function(t){return 40*this.scalableFactor(t)},getRealWidth:function(t){t=t||0;var e=this.getWindWidth();return e>1024?e-t:e},getRealHeight:function(t){return t=t||0,this.getWindHeight()-t},isSmallScreen:function(){var t=this.getWindWidth(),e=!1;return t<1024&&(e=t),e},scalableFactor:function(t){return t>640?1:t/640},setPlaceholder:function(t){var e=t.target?t.target:t;e&&void 0!==e.placeholder&&""==e.text&&(e.set({text:e.placeholder}),e.opacity=this.defaultOpacity,e.hiddenTextarea&&(e.hiddenTextarea.value=e.placeholder))},clearPlaceholder:function(t){var e=t.target?t.target:t;e&&void 0!==e.placeholder&&e.placeholder==e.text&&(e.set({text:""}),e.opacity=1,e.hiddenTextarea&&(e.hiddenTextarea.value=""))},isPlaceholder:function(t){var e=t.target?t.target:t;return!(!e||void 0===e.placeholder||e.placeholder!=e.text)},drawTail:function(t,e){var s=t.aCoords,i=Math.floor(s.tl.x+5*t.width/8-15),o=Math.floor(s.tl.y+t.height/8-15),n=Math.floor(s.tl.x+4*t.width/8-22.5),a=Math.floor(s.tl.y-t.height/8-15),r="M"+i+" "+o+" Q "+Math.floor(s.tl.x+5*t.width/8-15)+" "+a+", "+n+" "+a;return new z.fabric.Path(r,{borderColor:e,stroke:e,fill:"",strokeWidth:5,originX:"center",originY:"center",textAlign:"center",shadow:this.shadowContrast(e),moveX:n,moveY:a,cornerColor:"#55ca03",cornerSize:12,padding:10,borderDashArray:[3,3],transparentCorners:!1,cornerStrokeColor:"red",cornerStyle:"circle",deletable:!0})},shadowContrast:function(t){var e=parseInt(t.substr(1,2),16),s=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16);return(Math.round(299*e)+Math.round(587*s)+Math.round(114*i))/1e3>=128?"rgba(0,0,0,1) 2px 2px 10px":"rgba(255,255,255,1) 2px 2px 10px"},setColor:function(t,e){for(var s in t){var i=t[s];if(i)if(i.setShadow(this.shadowContrast(e)),"i-text"==i.get("type")||"text"==i.get("type"))i.setColor(e);else if("path"==i.get("type"))i.set("stroke",e);else if("group"==i.get("type")){var o=i.getObjects();this.setColor(o,e)}}},getDataUrl:function(t){for(var e=[],s=t.getObjects(),i=0;i<s.length;i++)"i-text"==s[i].get("type")&&s[i].visible&&(s[i].text!=s[i].placeholder&&""!=s[i].text.trim()||(s[i].savevisible=s[i].visible,s[i].visible=!1,s[i].polyline&&(s[i].polyline.savevisible=s[i].polyline.visible,s[i].polyline.visible=!1),e.push(s[i])));for(var o=t.toDataURL({format:"jpeg",quality:1}),n=0;n<e.length;n++)e[n].visible=e[n].savevisible,e[n].polyline&&(e[n].polyline.visible=e[n].polyline.savevisible);return o}},V=s(16);var G={initSocial:function(t){"undefined"!=typeof window&&t&&(window.jsvkfeedPostMessage=function(){},a.a.loadScript("https://vk.com/js/api/openapi.js",(function(){VK&&t.vk&&t.vk.app_id&&(VK._apiId||VK.init({apiId:t.vk.app_id,onlyWidgets:!0}),window.jsvkfeedPostMessage=function(t){VK.Auth&&VK.Api&&VK.Auth.getLoginStatus((function(e){e.session?VK.Api.call("wall.post",{message:t.message,attachments:t.link},(function(){})):VK.Auth.login((function(e){e.session&&VK.Api.call("wall.post",{message:t.message,attachments:t.link},(function(){}))}),VK.access.FRIENDS)}))})})))},checkSocialRepost:function(t,e,s){if(!e||!t)return!1;s=s||!1;var i={message:V.a.stripSmiles(t),link:("//"==e.substr(0,2)?"https:":"")+e};s&&(i.link+="/comment-"+s+"/?from=social"),window.jsvkfeedPostMessage(i)}},N=s(53),q=s.n(N);s(29);function W(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function H(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?W(Object(s),!0).forEach((function(e){d()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var X=function(t){var e=/(\/|^)(Thumbs\.db|desktop\.ini|\..+)$/.test(t),s=/\.(php5?|html?|jsx?)$/i.test(t);return e||s},K=function(t,e){return new Promise((function(s,i){new q.a(t,H(H({},e),{},{success:s,error:i}))}))},Y=s(11),J=s.n(Y),Q={components:{"file-upload":function(){return s.e(0).then(s.t.bind(null,88,7))}},props:{label:{type:String,default:"Выберите файл..."},labelLoading:{type:String,default:""},hint:{type:String,default:""},hintDrop:{type:String,default:""},type:{type:String,default:"image"},multiple:{type:Boolean,default:!1},skip_watermark:{type:Number,default:!1},filesUploaded:{type:Array,default:[]}},data:function(){return{files:[],isMounted:!1,data:{type:this.type},loading:!1,name:"file",postAction:r.a.urlEndpoint("file")+"/",fileCount:0,maxFileCount:100,addIndex:!0}},computed:{inputId:function(){return"upload"+Date.now()+parseInt(1e6*Math.random())},headers:function(){return{"X-Sid":J.a.get(r.a.user.cookies.sid)}},options:function(){return Object.assign({},{minSize:1024,thread:3,uploadAuto:!0,directory:!1,drop:!0,dropDirectory:!0},r.a.upload[this.type])},currentFile:function(){return this.$refs.uploader&&this.$refs.uploader.files?this.$refs.uploader.files[this.$refs.uploader.files.length-1]:{}}},mounted:function(){this.isMounted=!0},methods:{uploadFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={active:!0};e&&(s.error="",s.progress="0.00"),s.data=this.data,s.data.fileName=t.name,s.data.skip_watermark=this.skip_watermark,this.$refs.uploader.update(t,s)},cancelUploadFile:function(t){this.$refs.uploader.update(t,{active:!1})},inputFilter:function(t,e,s){var i=this;if(this.loading=!0,t){if("size"===t.error||t.size>r.a.upload[this.type].size){var o=t.name?t.name:"Файл",a=r.a.upload[this.type].size/1048576+"Мб";return t.error="«"+o+"» очень большой, максимальный размер файла "+a,console.log("Upload error: ",t.error),n.a.showMessage(t.error),this.$refs.uploader.update(t,{error:t.error}),this.hint=t.error,this.loading=!1,s()}if(!e){if(X(t.name))return s();t.file&&"image/"===t.type.substr(0,6)&&this.options.autoCompress>0&&this.options.autoCompress<t.size&&("image/gif"===t.type?this.$refs.uploader.update(t,{error:"",file:t,size:t.size,type:t.type,name:t.name}):(t.error="compressing",K(t.file,r.a.upload.compress).then((function(e){i.$refs.uploader.update(t,{error:"",file:e,size:e.size,type:e.type,name:e.name})})).catch((function(e){console.log("Upload error: ",e);var s="Неизвестная ошибка";n.a.showMessage(s),i.$refs.uploader.update(t,{error:s}),i.hint=s,i.loading=!1}))))}}if(t&&(!e||t.file!==e.file)){t.blob="";var l=window.URL||window.webkitURL;l&&l.createObjectURL&&(t.blob=l.createObjectURL(t.file)),t.thumb="",t.blob&&"image/"===t.type.substr(0,6)&&(t.thumb=t.blob)}if(t&&!e&&this.maxFileCount){if(this.fileCount>=this.maxFileCount)return this.$emit("maxFileCountError",t),s();this.fileCount++}},inputFile:function(t,e){if(this.loading=!0,t&&e&&(t.active&&!e.active&&t.size>=0&&this.minSize>0&&t.size<this.minSize&&this.$refs.uploader.update(t,{error:"size"}),t.progress,e.progress,t.error&&!e.error&&(n.a.showMessage("Ошибка загрузки"),this.$emit("hideall")),t.success&&!e.success)){var s=JSON.parse(t.response);s&&s.success?(this.filesUploaded.push(s),this.$emit("changeFiles"),this.$emit("hideall")):s&&s.error&&(n.a.showMessage(s.error),this.hint=s.error,this.loading=!1)}if(!t&&e&&(this.fileCount>0&&this.fileCount--,e.success&&e.response.id),t&&(Boolean(t)!==Boolean(e)||e.error!==t.error)&&this.options.uploadAuto&&!this.$refs.uploader.active){var i={active:!0};i.data=this.data,i.data.fileName=t.name,i.data.skip_watermark=this.skip_watermark,this.$refs.uploader.update(t,i)}var o=0;if(t)for(var a in this.files){this.files[a].id===t.id&&(o=parseInt(a))}this.$emit("inputFile",t,e,o,this.fileCount)},clearFiles:function(){this.loading=!1,this.fileCount=0,this.$refs.uploader.clear()}}},Z={data:function(){return{left:!1,focus:!1,tovk:this.getToVk,showImage:!1,showVideo:!1,showSmiles:!1,showButton:!1,showUpload:!1,showUploadMem:!1,showUploadAudio:!1,showStickers:!1,showTwitter:!1,showInstagram:!1,showDem:!1,upload:[],uploadDemMem:[],notify_users:[],canvasMem:!1,canvasDem:!1,topline:!1,bottomline:!1,texts:0,textsm:0,toplineM:!1,bottomlineM:!1}},components:{UploadButton:Object(h.a)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"file-uploader"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.$refs.uploader&&t.$refs.uploader.dropActive,expression:"$refs.uploader && $refs.uploader.dropActive"}],staticClass:"drop-area"},[s("h3",[t._v("Перетащите файлы для загрузки "+t._s(t.options.extensions))])]),t._v(" "),t.isMounted?s("file-upload",{ref:"uploader",attrs:{"input-id":t.inputId,"post-action":t.postAction,extensions:t.options.extensions,accept:t.options.accept,multiple:t.multiple,directory:t.options.directory,size:t.options.size||0,thread:t.options.thread<1?1:t.options.thread>5?5:t.options.thread,headers:t.headers,data:t.data,drop:t.options.drop,"drop-directory":t.options.dropDirectory,"add-index":t.addIndex,name:"qqfile"},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[s("button",{staticClass:"btn btn--green btn--outline btn--fw",attrs:{loading:t.loading,disabled:t.loading}},[t._v("\n      "+t._s(t.label)+"\n      "),t.labelLoading?s("span",{attrs:{slot:"loader"},slot:"loader"},[t._v(t._s(t.labelLoading)+"...")]):t._e()])]):t._e(),t._v(" "),t.hint&&!t.loading?s("div",{staticClass:"file-uploader__hint"},[t._v("\n    "+t._s(t.hint)+"\n  ")]):t.currentFile?s("div",[s("div",[t.currentFile.active?s("a",{on:{click:function(e){return e.preventDefault(),t.cancelUploadFile(t.currentFile)}}},[t._v("Отмена загрузки")]):t.currentFile.error&&"compressing"!==t.currentFile.error&&t.$refs.uploader.features.html5?s("a",{on:{click:function(e){return e.preventDefault(),t.uploadFile(t.currentFile,!0)}}},[t._v("\n        Загрузить снова\n      ")]):t._e()])]):t._e()],1)}),[],!1,null,null,null).exports},props:{post:{type:Object,required:!0},reply_id:{type:Number,default:0},reply_to_user:{type:Number,default:0},placeholder:{type:String,default:"Добавьте свой комментарий"},multiple:{type:Boolean,default:!1}},mixins:[o.a,m,c],computed:{imgloader:function(){return r.a.file(r.a.site.imgloader)},authClass:function(){return this.user&&this.user.id?"":" disabledel"},demImageId:function(){return"dem_gallery_img_"+this.reply_id},memImageId:function(){return"mem_gallery_img_"+this.reply_id},demCanvasId:function(){return"dem_canvas_img_"+this.reply_id},memCanvasId:function(){return"mem_canvas_img_"+this.reply_id},vertical:function(){if(this.hasDemMem){var t=this.uploadDemMem[this.uploadDemMem.length-1];return R.getWindWidth()/R.getWindHeight()>t.gallery_w/t.gallery_h}return!1},style:function(){if(this.hasDemMem){var t=this.showDem?51:93,e=this.uploadDemMem[this.uploadDemMem.length-1];if(this.vertical)return"margin: 32px 64px; height: "+R.getRealHeight(64+t)+"px; width: auto;";var s=Math.max(32,Math.floor((R.getRealHeight(t)-R.getRealWidth(128)/e.gallery_w*e.gallery_h)/2));return"margin: "+s+"px 64px; height: "+Math.floor(R.getRealHeight()-2*s)+"px; width: auto;"}return"height: auto; width: auto;"},styleImgMem:function(){if(this.hasDemMem){this.uploadDemMem[this.uploadDemMem.length-1];return this.vertical?"height: "+R.getRealHeight(157)+"px; width: auto;":"width: 100%;"}return"height: auto; width: auto;"},styleImgDem:function(){if(this.hasDemMem){this.uploadDemMem[this.uploadDemMem.length-1];return this.vertical?"height: "+R.getRealHeight(115)+"px; width: auto;":"width: 100%;"}return"height: auto; width: auto;"},styleDiv:function(){var t=this.showDem?51:93;return this.hasDemMem&&this.vertical?"height: "+R.getRealHeight(64+t-2)+"px;":""},currentDemMem:function(){return this.hasDemMem?r.a.file(this.uploadDemMem[this.uploadDemMem.length-1].gallery_link):""},hasDemMem:function(){return this.uploadDemMem.length>0},popoverClass:function(){return this.left?"popover popover--left":"popover popover--center"},popoverClassRight:function(){return this.left?"popover popover--left":"popover popover--right"},user:function(){return B.a.get()},getToVk:function(){return!!(this.user&&this.user.profile&&this.user.profile.comment_to_vk>0)},showUploadClass:function(){return this.showUpload?"popover-action popover-action--active":"popover-action"},showUploadClassMem:function(){return this.showUploadMem?"popover-action popover-action--active":"popover-action"},showUploadClassAudio:function(){return this.showUploadAudio?"popover-action popover-action--active":"popover-action"}},methods:{maxFileSize:function(t){if(r.a.upload[t]){var e=r.a.upload[t].extensions.toUpperCase(),s=e.lastIndexOf(",");return"файл должен быть в формате "+(e=(e=e.slice(0,s)+" или "+e.slice(s+1)).replace(/,/g,", "))+", размером до "+(r.a.upload[t]?Math.floor(r.a.upload[t].size/1048576):10)+"Мб"}return"файл должен быть размером до 10Мб"},addMem:function(){var t={type:"base64",filename:"mem"+this.user.id+"_"+Date.now()+".jpg",skip_watermark:0},e=this;t.base64=R.getDataUrl(this.canvasMem),n.a.call("upload.imagecomment",t).then((function(t){e.uploadDemMem=[],t&&t.data&&e.upload.push(t.data)})).catch((function(t){}))},addDem:function(){var t={type:"base64",filename:"dem"+this.user.id+"_"+Date.now()+".jpg",skip_watermark:0},e=this;t.base64=R.getDataUrl(this.canvasDem),n.a.call("upload.imagecomment",t).then((function(t){e.uploadDemMem=[],t&&t.data&&e.upload.push(t.data)})).catch((function(t){}))},changeColor:function(){var t=this.canvasMem.getObjects();R.setColor(t,this.$refs.mem_color.value),this.canvasMem.requestRenderAll()},toplineToggle:function(){this.hasDemMem&&(this.checkButton(),this.topline.visible=this.$refs.mem_top.checked,this.canvasMem.requestRenderAll())},bottomlineToggle:function(){this.hasDemMem&&(this.checkButton(),this.bottomline.visible=this.$refs.mem_bottom.checked,this.canvasMem.requestRenderAll())},toplineToggleM:function(){this.hasDemMem&&(this.checkButtonM(),this.toplineM.visible=this.$refs.dem_top.checked,this.toplineM.visible||this.bottomlineM.visible||(this.bottomlineM.visible=!0),this.canvasDem.requestRenderAll())},bottomlineToggleM:function(){this.hasDemMem&&(this.checkButtonM(),this.bottomlineM.visible=this.$refs.dem_bottom.checked,this.toplineM.visible||this.bottomlineM.visible||(this.toplineM.visible=!0),this.canvasDem.requestRenderAll())},addClick:function(){var t=new z.fabric.IText("Введите\r\nтекст",{opacity:R.defaultOpacity,placeholder:"Введите\r\nтекст",fontFamily:"Impact",fontSize:R.fontSize(this.canvasMem.width),left:this.canvasMem.width/2,top:this.canvasMem.height/2,originX:"center",originY:"center",textAlign:"center",width:this.canvasMem.width-2*R.fontSize(this.canvasMem.width),centeredScaling:!0,lockScalingFlip:!0,fill:this.$refs.mem_color.value,caching:!1,objectCaching:!1,dirty:!0,shadow:R.shadowContrast(this.$refs.mem_color.value),editing_exited:!0,borderColor:"red",cornerColor:"#55ca03",cornerSize:12,padding:10,borderDashArray:[3,3],transparentCorners:!1,cornerStrokeColor:"red",cornerStyle:"circle",deletable:!0,fixedWidth:this.canvasMem.width-2*R.fontSize(this.canvasMem.width),setposition:!1,allowbr:5,minSize:15,maxSize:R.fontSize(this.canvasMem.width)}),e=R.drawTail(t,this.$refs.mem_color.value);t.polyline=e,this.canvasMem.add(t),this.canvasMem.add(e)},delClick:function(){var t=this.canvasMem.getActiveObject();t&&t.deletable&&(t.polyline&&this.canvasMem.remove(t.polyline),this.canvasMem.remove(t)),this.checkButton(),this.$refs.mem_del.disabled=!0},checkButton:function(){var t=this;this.texts=0,this.$refs.mem_top.checked&&!R.isPlaceholder(this.topline)&&this.texts++,this.$refs.mem_bottom.checked&&!R.isPlaceholder(this.bottomline)&&this.texts++,this.canvasMem.getObjects("i-text").forEach((function(e,s,i){R.isPlaceholder(e)||t.texts++}))},checkButtonM:function(){this.textsm=0,R.isPlaceholder(this.toplineM)||this.textsm++,R.isPlaceholder(this.bottomlineM)||this.textsm++},onImageLoad:function(){var t=this;if(this.hasDemMem&&!this.showDem){var e=this.uploadDemMem[this.uploadDemMem.length-1];if(this.canvasMem&&this.canvasMem.gallery_link==e.gallery_link)this.canvasMem.requestRenderAll();else{z.fabric.Object.prototype.cornerSize=12,z.fabric.Object.prototype.borderColor="red",z.fabric.Object.prototype.cornerColor="#55ca03",z.fabric.Object.prototype.padding=10,z.fabric.Object.prototype.borderDashArray=[3,3],z.fabric.Object.prototype.cornerStrokeColor="red",z.fabric.Object.prototype.cornerStyle="circle",z.fabric.Object.prototype.transparentCorners=!1;var s=this.$refs.mem_image.clientWidth,i=this.$refs.mem_image.clientHeight;this.$refs.mem_canvas.style.display="block",this.canvasMem=new z.fabric.Canvas(this.memCanvasId,{width:s,height:i}),this.canvasMem.gallery_link=e.gallery_link,this.topline=new z.fabric.IText("Укажите верхнюю строку",{opacity:R.defaultOpacity,placeholder:"Укажите верхнюю строку",fontFamily:"Impact",fontSize:R.fontSize(s),left:Math.round(s/2),top:20*R.scalableFactor(s),topCalcBase:20*R.scalableFactor(s),topCalcPerLine:0,originX:"center",textAlign:"center",hasRotatingPoint:!1,width:s-2*R.fontSize(s),lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,minSize:25*R.scalableFactor(s),maxSize:R.fontSize(s),fixedWidth:s-2*R.fontSize(s),setposition:!0,allowbr:0,fill:"#ffffff",caching:!1,objectCaching:!1,dirty:!0,hoverCursor:"text",shadow:"rgba(0,0,0,1) 2px 2px 10px",selectable:!1}),this.topline.set("selectable",!0),this.bottomline=new z.fabric.IText("Укажите нижнюю строку",{opacity:R.defaultOpacity,placeholder:"Укажите нижнюю строку",fontFamily:"Impact",fontSize:R.bottomfontSize(s),left:Math.round(s/2),top:i-20-R.bottomfontSize(s),topCalcBase:i-20,topCalcPerLine:-R.bottomfontSize(s),originX:"center",textAlign:"center",hasRotatingPoint:!1,width:s-2*R.bottomfontSize(s),lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,minSize:15*R.scalableFactor(s),maxSize:R.bottomfontSize(s),fixedWidth:s-2*R.bottomfontSize(s),setposition:!0,allowbr:1,fill:"#ffffff",caching:!1,objectCaching:!1,dirty:!0,hoverCursor:"text",shadow:"rgba(0,0,0,1) 2px 2px 10px",selectable:!1}),this.bottomline.set("selectable",!0);var o=s/e.gallery_w,n=new z.fabric.Image(this.$refs.mem_image,{left:0,top:0,width:e.gallery_w,height:e.gallery_h,scaleX:o,scaleY:o,hasRotatingPoint:!1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,selectable:!1});this.canvasMem.add(n),this.canvasMem.add(this.topline),this.canvasMem.moveTo(this.topline,100),this.canvasMem.add(this.bottomline),this.canvasMem.moveTo(this.bottomline,100),this.$refs.mem_image.style.display="none",this.canvasMem.on("text:editing:entered",(function(e){t.showDem||(R.clearPlaceholder(e),t.$refs.mem_del.disabled=!0)})),this.canvasMem.on("text:editing:exited",(function(e){if(!t.showDem){R.setPlaceholder(e);var s=e.target,i=s.text.trim();if((i=(i=i.replace(/[\r]/gi,"")).split("\n")).length>s.allowbr)for(var o=s.allowbr+1;o<i.length;o++)i[s.allowbr]+=i[o],i[o]="";s.setposition&&!R.isSmallScreen()&&(s.top=s.topCalcBase+(i.length?i.length:1)*s.topCalcPerLine),i=i.join("\r\n"),s.set({text:i}),t.checkButton()}})),this.canvasMem.on("object:selected",(function(e){if(!t.showDem){console.log("object:selected"),t.$refs.mem_del.disabled=!0;var s=e.target;s&&s.deletable?t.$refs.mem_del.disabled=!1:t.$refs.mem_del.disabled=!0}})),this.canvasMem.on("before:selection:cleared",(function(e){t.showDem||(t.$refs.mem_del.disabled=!0)})),this.canvasMem.on("mouse:up",(function(e){if(!t.showDem){var s=e.target;t.canvasMem.getObjects("i-text").forEach((function(t,e,i){t.isEditing&&s!=t&&(console.log("exitEditing"),t.exitEditing())}))}})),this.canvasMem.on("text:changed",(function(e){if(!t.showDem){var s=R.isSmallScreen(),i=e.target;if(i){var o=i.text;if(void 0!==i.allowbr){if((o=(o=o.replace(/[\r]/gi,"")).split("\n")).length>i.allowbr){for(var n=i.allowbr+1;n<o.length;n++)o[i.allowbr]+=o[n],o[n]=!1;o=o.filter((function(t){return!1!==t}))}i.setposition&&(s||(i.top=i.topCalcBase+(o.length?o.length:1)*i.topCalcPerLine)),o=o.join("\r\n"),i.maxlength&&o.length>i.maxlength&&(o=o.substr(0,i.maxlength)),i.set({text:o}),i.hiddenTextarea.value=o}if(i.fixedWidth&&(i.width>i.fixedWidth+i.fontSize/2||i.width<i.fixedWidth-i.fontSize/2)){var a=Math.round(i.fontSize*i.fixedWidth/(i.width+1));a<i.minSize?a=i.minSize:a>i.maxSize&&(a=i.maxSize);var r=i.fontSize;for(s||(i.fontSize=a),i.set({text:o}),i.hiddenTextarea.value=o;r==a&&i.width>i.fixedWidth+i.fontSize/2;){o=(o=o.replace(/[\r]/gi,"")).split("\n");for(var l=0,c=0;c<o.length;c++)o[c].length>o[l].length&&(l=c);o[l]=o[l].substr(0,o[l].length-1),o=o.join("\r\n"),i.set({text:o}),i.hiddenTextarea.value=o}i.setposition&&(i.width=i.fixedWidth)}}}})),this.canvasMem.requestRenderAll()}}},onDemImageLoad:function(){var t=this;if(this.hasDemMem&&this.showDem){var e=this.uploadDemMem[this.uploadDemMem.length-1];if(this.canvasDem&&this.canvasDem.gallery_link==e.gallery_link)this.canvasDem.requestRenderAll();else{z.fabric.Object.prototype.cornerSize=12,z.fabric.Object.prototype.borderColor="red",z.fabric.Object.prototype.cornerColor="#55ca03",z.fabric.Object.prototype.padding=10,z.fabric.Object.prototype.borderDashArray=[3,3],z.fabric.Object.prototype.cornerStrokeColor="red",z.fabric.Object.prototype.cornerStyle="circle",z.fabric.Object.prototype.transparentCorners=!1;var s=R.getDemData(),i=this.$refs.dem_image.clientWidth,o=this.$refs.dem_image.clientHeight,n=(i/s.width+o/s.height)/2,a=Math.ceil(2*n),r=Math.ceil(10*n),l=o-3*r-2*R.bottomfontSize(i)-2*r-2*a-4*a,c=l/e.gallery_h*e.gallery_w;i=c+6*a+4*r;var m=Math.floor(11*R.scalableFactor(i)),u=Math.floor(82*R.scalableFactor(i)),d=Math.floor(12*R.scalableFactor(i)),p=2*r+4*a+c,h=2*r+6*a+l;this.$refs.dem_canvas.style.display="block",this.canvasDem=new z.fabric.Canvas(this.demCanvasId,{width:i,height:o,backgroundColor:"#000000",fill:"#000000"}),this.canvasDem.gallery_link=e.gallery_link;var f=new z.fabric.Rect({left:2*r,top:2*r,fill:"#ffffff",width:c+6*a,height:l+6*a,hasControls:!1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,lockRotation:!0,hasRotatingPoint:!1,selectable:!1});this.canvasDem.add(f);var v=new z.fabric.Rect({left:2*r+a,top:2*r+a,fill:"#000000",width:c+4*a,height:l+4*a,hasControls:!1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,lockRotation:!0,hasRotatingPoint:!1,selectable:!1});this.canvasDem.add(v),this.toplineM=new z.fabric.IText("Укажите верхнюю строку",{opacity:R.defaultOpacity,placeholder:"Укажите верхнюю строку",fontFamily:"Impact",fontSize:R.fontSize(i),left:Math.round(i/2),top:o-2*r-2*R.bottomfontSize(i),topCalcBase:o-2*r-2*R.bottomfontSize(i),topCalcPerLine:0,originX:"center",textAlign:"center",hasRotatingPoint:!1,width:i-2*R.fontSize(i),lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,minSize:25*R.scalableFactor(i),maxSize:R.fontSize(i),fixedWidth:i-2*R.fontSize(i),setposition:!0,allowbr:0,fill:"#ffffff",caching:!1,objectCaching:!1,dirty:!0,hoverCursor:"text",shadow:"rgba(0,0,0,1) 2px 2px 10px",selectable:!1}),this.toplineM.set("selectable",!0),this.bottomlineM=new z.fabric.IText("Укажите нижнюю строку",{opacity:R.defaultOpacity,placeholder:"Укажите нижнюю строку",fontFamily:"Impact",fontSize:R.fontSize(i),left:Math.round(i/2),top:o-r-R.fontSize(i),topCalcBase:o-r-R.fontSize(i),topCalcPerLine:0,originX:"center",textAlign:"center",hasRotatingPoint:!1,width:i-2*R.fontSize(i),lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,minSize:25*R.scalableFactor(i),maxSize:R.fontSize(i),fixedWidth:i-2*R.fontSize(i),setposition:!0,allowbr:0,fill:"#ffffff",caching:!1,objectCaching:!1,dirty:!0,hoverCursor:"text",shadow:"rgba(0,0,0,1) 2px 2px 10px",selectable:!1}),this.bottomlineM.set("selectable",!0),this.canvasDem.add(this.toplineM),this.canvasDem.add(this.bottomlineM);var _=new z.fabric.Image(this.$refs.dem_image,{left:2*r+3*a,top:2*r+3*a,width:e.gallery_w,height:e.gallery_h,scaleX:c/e.gallery_w,scaleY:l/e.gallery_h,hasRotatingPoint:!1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,selectable:!1});this.canvasDem.add(_);var g=new z.fabric.Text("  Fishki.net  ",{fontFamily:"Arial",fontWeight:"Bold",fontSize:m,left:p,top:h,originX:"right",originY:"center",textAlign:"center",hasRotatingPoint:!1,width:u,height:d,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,lockRotation:!0,centeredScaling:!0,lockScalingFlip:!0,hasControls:!1,fill:"#ffffff",backgroundColor:"rgba(0,0,0,1)",caching:!1,objectCaching:!1,selectable:!1,dirty:!0});this.canvasDem.add(g),this.$refs.dem_image.style.display="none",this.canvasDem.on("text:editing:entered",(function(e){t.showDem&&R.clearPlaceholder(e)})),this.canvasDem.on("text:editing:exited",(function(e){if(t.showDem){R.setPlaceholder(e);var s=e.target,i=s.text.trim();if((i=(i=i.replace(/[\r]/gi,"")).split("\n")).length>s.allowbr)for(var o=s.allowbr+1;o<i.length;o++)i[s.allowbr]+=i[o],i[o]="";s.setposition&&!R.isSmallScreen()&&(s.top=s.topCalcBase+(i.length?i.length:1)*s.topCalcPerLine),i=i.join("\r\n"),s.set({text:i}),t.checkButtonM()}})),this.canvasDem.on("mouse:up",(function(e){if(t.showDem){var s=e.target;t.canvasDem.getObjects("i-text").forEach((function(t,e,i){t.isEditing&&s!=t&&(console.log("exitEditing"),t.exitEditing())}))}})),this.canvasDem.on("text:changed",(function(e){if(t.showDem){var s=R.isSmallScreen(),i=e.target;if(i){var o=i.text;if(void 0!==i.allowbr){if((o=(o=o.replace(/[\r]/gi,"")).split("\n")).length>i.allowbr){for(var n=i.allowbr+1;n<o.length;n++)o[i.allowbr]+=o[n],o[n]=!1;o=o.filter((function(t){return!1!==t}))}i.setposition&&(s||(i.top=i.topCalcBase+(o.length?o.length:1)*i.topCalcPerLine)),o=o.join("\r\n"),i.maxlength&&o.length>i.maxlength&&(o=o.substr(0,i.maxlength)),i.set({text:o}),i.hiddenTextarea.value=o}if(i.fixedWidth&&(i.width>i.fixedWidth+i.fontSize/2||i.width<i.fixedWidth-i.fontSize/2)){var a=Math.round(i.fontSize*i.fixedWidth/(i.width+1));a<i.minSize?a=i.minSize:a>i.maxSize&&(a=i.maxSize);var r=i.fontSize;for(s||(i.fontSize=a),i.set({text:o}),i.hiddenTextarea.value=o;r==a&&i.width>i.fixedWidth+i.fontSize/2;){o=(o=o.replace(/[\r]/gi,"")).split("\n");for(var l=0,c=0;c<o.length;c++)o[c].length>o[l].length&&(l=c);o[l]=o[l].substr(0,o[l].length-1),o=o.join("\r\n"),i.set({text:o}),i.hiddenTextarea.value=o}i.setposition&&(i.width=i.fixedWidth)}}}})),this.canvasDem.requestRenderAll()}}},setShowDem:function(t){var e=this;this.showDem=t,this.$nextTick((function(){t?e.onDemImageLoad():e.onImageLoad()}))},closeDemMem:function(){this.canvasDem=!1,this.canvasMem=!1,this.uploadDemMem=[]},classActive:function(t){return this.showDem^t?"activePad":""},classDem:function(t){return this.showDem^t?"":"hidden"},debounceSet:function(t){this.left=!1,this.hideAllUpload(t),"undefined"!=typeof window&&R.getWindWidth()<768&&(this.left=!0);var e=this;setTimeout((function(){e.$set(e,t,!0)}),100)},changeVK:function(){this.tovk=!this.tovk},submit:function(){var t=this.$refs.textarea,e=this.$refs.post_to_vk,s={post_id:this.post.post_id,gallery_id:this.post.gallery_id,comment:t.value,tovk:1==e.checked?1:0,attach:this.upload,ua_params:r.a.getUAData(),reply_id:this.reply_id,reply_to_user:this.reply_to_user,notify_users:this.notify_users},i=this;n.a.call("comment.save",s).then((function(s){e.checked&&G.checkSocialRepost(t.value,i.post.post_link,s.data.insert_id),t.value="",i.upload=[],i.$set(i.post.comments,"total_number_comments",s.data.total_number_comments),s.data.users&&s.data.users[i.user.id]&&i.$set(i.post.comments.users,i.user.id,s.data.users[i.user.id]),i.extendVue(i.post.comments.answers,s.data.answers),i.extendVue(i.post.commentsGroupLikes,s.data.commentsGroupLikes),i.reply_id||i.extendVue(i.post.comments.list,s.data.list),i.$nextTick((function(){i.checkEmbeded(),i.$emit("hideForm")}))}))},imageUrl:function(t){var e;switch(t.type){case"embed":return t.preview;default:e=t.gallery_preview?t.gallery_preview:t.gallery_small_preview?t.gallery_small_preview:t.gallery_link}return r.a.getImageLink(e)},deleteUpload:function(t){this.upload.splice(t,1)},rotateUpload:function(t){var e={},s=this;e.link=this.upload[t].gallery_link,n.a.call("image.rotatecomment",e).then((function(e){e&&e.data&&s.$set(s.upload,t,e.data)}))},changeUrl:function(t){this.$refs.loader.style.display="block";var e={skip_watermark:0},s=this;s.hideall(),e.url=t.target.value?t.target.value:t.clipboardData?t.clipboardData.getData("text"):"",""!=e.url&&n.a.call("upload.imagecomment",e).then((function(t){s.$refs.loader.style.display="none",t&&t.data&&s.upload.push(t.data)})).catch((function(t){s.$refs.loader.style.display="none"}))},hideInstagram:function(){this.showInstagram=!1},toggleInstagram:function(){this.debounceSet("showInstagram")},hideTwitter:function(){this.showTwitter=!1},toggleTwitter:function(){this.debounceSet("showTwitter")},hideImage:function(){this.showImage=!1},toggleImage:function(){this.debounceSet("showImage")},hideVideo:function(){this.showVideo=!1},toggleVideo:function(){this.debounceSet("showVideo")},hideSmiles:function(){this.showSmiles=!1,document.body.parentElement.classList.remove("stopping_scroll")},toggleSmiles:function(){this.showSmiles?this.hideSmiles():(this.debounceSet("showSmiles"),document.body.parentElement.classList.add("stopping_scroll"))},hideAllUpload:function(t){var e=this;["showUpload","showUploadMem","showUploadAudio","showInstagram","showTwitter"].forEach((function(s,i,o){t!=s&&e.$set(e,s,!1)}))},hideButton:function(){this.hideAllUpload(),this.showStickers=!1,this.showButton=!1},toggleButtons:function(){this.showStickers=!1,this.debounceSet("showButton")},toggleStickers:function(){this.debounceSet("showStickers")},toggleUpload:function(){this.showDem=!0,this.debounceSet("showUpload")},hideUpload:function(){this.showUpload=!1},toggleUploadMem:function(){this.showDem=!1,this.debounceSet("showUploadMem")},hideUploadMem:function(){this.showUploadMem=!1},toggleUploadAudio:function(){this.debounceSet("showUploadAudio")},hideUploadAudio:function(){this.showUploadAudio=!1},insertSmile:function(t){var e=this,s=this.$refs.textarea,i=s.selectionStart,o=s.selectionEnd,n=i,a=s.value;this.focus?s.value=a.substring(0,i)+t+a.substring(o,a.length):s.value=a+t,setTimeout((function(){n+=t.length,e.hideSmiles(),e.hideButton(),s.selectionStart=s.selectionEnd=n}),10)},uploadFile:function(t,e,s,i){if(this.file=t||{},this.processingError="",t&&t.success&&!t.error&&t.response.status)if(console.log("UPLOADER uploadFile",this.imageResponse),s&&1!==i)this.$emit("excessAttach",this.isVideo?t.response.video:t.response.image,{fileIndex:s,countFiles:i-1});else{var o=this.isVideo?t.response.video.preview:t.response.image;this.imageResponse=o,this.$emit("inputFile",this.isVideo?t.response.video:t.response.image)}else t&&t.error&&(this.processingError=t.error)},hideall:function(){this.hideImage(),this.hideVideo(),this.hideTwitter(),this.hideInstagram(),this.hideUploadAudio(),this.hideButton()},changeFiles:function(){this.uploadDemMem.length}},mounted:function(){}},tt=s(54),et=s.n(tt),st=s(55),it=Object(h.a)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"comment-form"+t.authClass},[s("img",{ref:"loader",staticClass:"comment-form__loader",staticStyle:{display:"none"},attrs:{src:t.imgloader,decoding:"async"}}),t._v(" "),s("div",{staticClass:"comment-form__avatar",style:"background-image: url("+t.avatar(t.user)+")"}),t._v(" "),s("textarea",{ref:"textarea",staticClass:"comment-form__editor comment-form__editor--empty",attrs:{placeholder:t.placeholder},on:{focus:function(e){t.focus=!0},blur:function(e){t.focus=!1},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?(e.preventDefault(),t.submit()):null}}}),t._v(" "),s("div",{staticClass:"comment-form__controls"},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideImage,expression:"hideImage"}],staticClass:"popover-wrap"},[s("button",{staticClass:"comment-form__action",on:{click:t.toggleImage}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-image"}})])]),t._v(" "),t.showImage?s("div",{class:t.popoverClass},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[s("div",{staticClass:"form-row"},[s("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_url",placeholder:"Вставьте ссылку на изображение"},on:{change:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)},paste:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)}}})]),t._v(" "),s("div",{staticClass:"form-row text-center"},[t._v("или")]),t._v(" "),s("div",{staticClass:"form-row"},[s("UploadButton",{ref:"uploadButton",attrs:{label:"загрузите с вашего компьютера",type:"image",multiple:t.multiple,skip_watermark:1,filesUploaded:t.upload},on:{inputFile:t.uploadFile,hideall:t.hideall}})],1),t._v(" "),s("div",{staticClass:"form-row cl-grey-light mb0"},[t._v(t._s(t.maxFileSize("image")))])])])]):t._e()]),t._v(" "),s("div",{staticClass:"popover-wrap"},[s("button",{staticClass:"comment-form__action",on:{click:t.toggleVideo}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-video"}})])]),t._v(" "),t.showVideo?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideVideo,expression:"hideVideo"}],class:t.popoverClass},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[s("div",{staticClass:"form-row"},[s("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_url",placeholder:"Вставьте ссылку на видео (Youtube, VK, Vimeo)…"},on:{change:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)},paste:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)}}})]),t._v(" "),s("div",{staticClass:"form-row text-center"},[t._v("или")]),t._v(" "),s("div",{staticClass:"form-row"},[s("UploadButton",{ref:"uploadButton",attrs:{label:"загрузите с вашего компьютера",type:"video",multiple:t.multiple,skip_watermark:1,filesUploaded:t.upload},on:{inputFile:t.uploadFile,hideall:t.hideall}})],1),t._v(" "),s("div",{staticClass:"form-row cl-grey-light mb0"},[t._v(t._s(t.maxFileSize("video")))])])])]):t._e()]),t._v(" "),s("div",{staticClass:"popover-wrap"},[s("button",{staticClass:"comment-form__action",on:{click:t.toggleSmiles}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-smiles"}})])]),t._v(" "),t.showSmiles?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideSmiles,expression:"hideSmiles"}],class:t.popoverClassRight},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("div",{staticClass:"popover-smiles smiles"},t._l(t.post.smiles,(function(e,i){return s("div",{key:i,class:"smile "+e.filename,on:{click:function(s){return t.insertSmile(e.code)}}})})),0)]):t._e()]),t._v(" "),s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideButton,expression:"hideButton"}],staticClass:"popover-wrap hidden-xs"},[s("button",{staticClass:"comment-form__action",on:{click:t.toggleButtons}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-more"}})])]),t._v(" "),t.showButton&&t.showStickers?s("div",{staticClass:"popover popover--right"},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("div",{staticClass:"popover-smiles stickers"},t._l(t.post.stickers,(function(e,i){return s("div",{key:i,class:"sticker "+e.filename,on:{click:function(s){return t.insertSmile(e.code)}}})})),0)]):t._e(),t._v(" "),t.showButton&&!t.showStickers?s("div",{staticClass:"popover popover--right"},[s("button",{staticClass:"popover-action",on:{click:t.toggleStickers}},[t._m(0),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Стикеры")])]),t._v(" "),s("div",{staticClass:"popover-action",class:t.showUploadClass,on:{click:t.toggleUpload}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-dem"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Конструктор демотиваторов")]),t._v(" "),t.showUpload?s("div",{staticClass:"popover-side popover-side--left"},[s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[t._m(1),t._v(" "),s("div",{staticClass:"form-row text-center"},[t._v("или")]),t._v(" "),s("div",{staticClass:"form-row"},[s("UploadButton",{ref:"uploadButton",attrs:{label:"загрузите с вашего компьютера",type:"image",multiple:!1,skip_watermark:1,filesUploaded:t.uploadDemMem},on:{inputFile:t.uploadFile,hideall:t.hideall,changeFiles:t.changeFiles}})],1),t._v(" "),s("div",{staticClass:"form-row cl-grey-light"},[t._v(t._s(t.maxFileSize("image")))])])])]):t._e()]),t._v(" "),s("button",{staticClass:"popover-action",class:t.showUploadClassMem,on:{click:t.toggleUploadMem}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-mem"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Конструктор мемотиваторов")]),t._v(" "),t.showUploadMem?s("div",{staticClass:"popover-side popover-side--left"},[s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[t._m(2),t._v(" "),s("div",{staticClass:"form-row text-center"},[t._v("или")]),t._v(" "),s("div",{staticClass:"form-row"},[s("UploadButton",{ref:"uploadButton",attrs:{label:"загрузите с вашего компьютера",type:"image",multiple:!1,skip_watermark:1,filesUploaded:t.uploadDemMem},on:{inputFile:t.uploadFile,hideall:t.hideall,changeFiles:t.changeFiles}})],1),t._v(" "),s("div",{staticClass:"form-row cl-grey-light"},[t._v(t._s(t.maxFileSize("image")))])])])]):t._e()]),t._v(" "),s("button",{staticClass:"popover-action",on:{click:t.toggleTwitter}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-twitter"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Ссылка на Twitter")]),t._v(" "),t.showTwitter?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideTwitter,expression:"hideTwitter"}],staticClass:"popover-side popover-side--left"},[s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[s("div",{staticClass:"form-row"},[s("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_tw",placeholder:"Вставьте ссылку на Twitter"},on:{change:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)},paste:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)}}})])])])]):t._e()]),t._v(" "),s("button",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideInstagram,expression:"hideInstagram"}],staticClass:"popover-action",on:{click:t.toggleInstagram}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-instagram"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Ссылка на Instagram")]),t._v(" "),t.showInstagram?s("div",{staticClass:"popover-side popover-side--left"},[s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[s("div",{staticClass:"form-row"},[s("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_tw",placeholder:"Вставьте ссылку на Instagram"},on:{change:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)},paste:function(e){return e.stopPropagation(),e.preventDefault(),t.changeUrl.apply(null,arguments)}}})])])])]):t._e()]),t._v(" "),s("button",{staticClass:"popover-action",class:t.showUploadClassAudio,on:{click:t.toggleUploadAudio}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-audio"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Звуковой файл")]),t._v(" "),t.showUploadAudio?s("div",{staticClass:"popover-side popover-side--left"},[s("div",{staticClass:"popover-upload"},[s("form",{staticClass:"form-generic nm",attrs:{action:""}},[s("div",{staticClass:"form-row"},[s("UploadButton",{ref:"uploadButton",attrs:{label:"загрузите с вашего компьютера",type:"mp3",multiple:t.multiple,skip_watermark:1,filesUploaded:t.upload},on:{inputFile:t.uploadFile,hideall:t.hideall}})],1),t._v(" "),s("div",{staticClass:"form-row cl-grey-light"},[t._v(t._s(t.maxFileSize("mp3")))])])])]):t._e()])]):t._e()]),t._v(" "),s("button",{ref:"publicate",staticClass:"comment-form__submit btn btn--green btn--outline ml-a",on:{click:function(e){return t.submit()}}},[t._v("опубликовать")])]),t._v(" "),t._m(3),t._v(" "),t.upload.length>0?s("div",{staticClass:"comment-form__editor"},t._l(t.upload,(function(e,i){return e?s("div",{staticClass:"comment-item"},[s("div",{class:"comment-item__content"+("video"==e.type?" video-js":"")},[s("img",{staticClass:"img-responsive",attrs:{src:t.imageUrl(e),alt:""}}),t._v(" "),"video"==e.type?s("button",{staticClass:"vjs-big-play-button",attrs:{type:"button"}},[s("span",{staticClass:"vjs-icon-placeholder"})]):t._e()]),t._v(" "),s("div",{staticClass:"comment-item__controls"},[s("button",{staticClass:"comment-item__action",on:{click:function(e){return t.deleteUpload(i)}}},[s("svg",[s("use",{attrs:{"xlink:href":"#icon-o-cancel"}})])]),t._v(" "),"image"==e.type?s("button",{staticClass:"comment-item__action",on:{click:function(e){return t.rotateUpload(i)}}},[s("svg",[s("use",{attrs:{"xlink:href":"#icon-o-turn"}})])]):t._e()])]):t._e()})),0):t._e(),t._v(" "),s("div",{staticClass:"comment-form__controls hidden-xs"},[s("button",{staticClass:"comment-form__submit btn btn--green btn--outline",on:{click:function(e){return t.submit()}}},[t._v("опубликовать")]),t._v(" "),s("label",{staticClass:"toggler"},[s("input",{ref:"post_to_vk",attrs:{type:"checkbox",name:"2vk"},domProps:{checked:t.getToVk},on:{click:function(e){return t.changeVK()}}}),t._v("отправить комментарий во Вконтакте")])]),t._v(" "),t.hasDemMem?s("div",{staticClass:"memo_popup_block"},[s("div",{staticClass:"lightboxOverlay",attrs:{tabindex:"-1"}}),t._v(" "),s("div",{staticClass:"lightbox",attrs:{tabindex:"-1"}},[s("div",{staticClass:"lb-outerContainer",style:t.style},[s("div",{ref:"lb_container",staticClass:"lb-container"},[s("div",{class:"popover-icon dem_menu_icon "+t.classActive(!1),on:{click:function(e){return t.setShowDem(!0)}}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-dem"}})])]),t._v(" "),s("div",{class:"popover-icon dem_menu_icon mem_menu_icon "+t.classActive(!0),on:{click:function(e){return t.setShowDem(!1)}}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-mem"}})])]),t._v(" "),s("div",{staticClass:"popover-icon dem_menu_icon close_dem_icon",on:{click:t.closeDemMem}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-close"}})])]),t._v(" "),s("div",{ref:"publisher__memotivator",class:"publisher__block__subgroup "+t.classDem(!0)},[s("div",{staticClass:"publisher__memotivator",style:t.styleDiv},[s("canvas",{ref:"mem_canvas",staticStyle:{display:"none"},attrs:{id:t.memCanvasId}}),t._v(" "),s("img",{ref:"mem_image",staticClass:"gallery_img",style:t.styleImgMem,attrs:{id:t.memImageId,crossOrigin:"anonymous",src:t.currentDemMem},on:{load:t.onImageLoad}})]),t._v(" "),s("div",{staticClass:"modal-btn-group modal-btn-group--grey ptb-10"},[s("button",{ref:"mem_add",staticClass:"btn btn--grey btn--outline",on:{click:function(e){return t.addClick()}}},[t._v("добавить ещё одну надпись")]),t._v(" "),s("button",{ref:"mem_del",staticClass:"btn btn--grey btn--dashed",attrs:{disabled:""},on:{click:function(e){return t.delClick()}}},[t._v("удалить выбранную надпись")])]),t._v(" "),s("div",{staticClass:"modal-color-group modal-btn-group--grey pb-10"},[s("label",{staticClass:"color_selector"},[s("input",{ref:"mem_color",attrs:{type:"color",value:"#ffffff"},on:{change:t.changeColor}}),t._v("Изменить цвет всех надписей")]),t._v(" "),s("label",{staticClass:"toggler btn"},[s("input",{ref:"mem_top",attrs:{type:"checkbox",checked:""},on:{click:function(e){return t.toplineToggle()}}}),t._v("Показывать верхнюю надпись")]),t._v(" "),s("label",{staticClass:"toggler"},[s("input",{ref:"mem_bottom",attrs:{type:"checkbox",checked:""},on:{click:function(e){return t.bottomlineToggle()}}}),t._v("Показывать нижнюю надпись")]),t._v(" "),t.texts>0?s("button",{ref:"add_mem",staticClass:"ml-1 comment-form__submit btn btn--green btn--outline",on:{click:function(e){return t.addMem()}}},[t._v("Добавить")]):t._e()])]),t._v(" "),s("div",{ref:"publisher__demotivator",class:"publisher__block__subgroup "+t.classDem(!1)},[s("div",{staticClass:"publisher__demotivator",style:t.styleDiv},[s("canvas",{ref:"dem_canvas",staticStyle:{display:"none"},attrs:{id:t.demCanvasId}}),t._v(" "),s("img",{ref:"dem_image",staticClass:"gallery_img",style:t.styleImgDem,attrs:{id:t.demImageId,crossOrigin:"anonymous",src:t.currentDemMem},on:{load:t.onDemImageLoad}})]),t._v(" "),s("div",{staticClass:"ptb-10 modal-color-group modal-btn-group--grey content-btn-3"},[t.textsm>1?s("button",{ref:"add_dem",staticClass:"ml-1 comment-form__submit btn btn--green btn--outline w100",on:{click:function(e){return t.addDem()}}},[t._v("Добавить")]):t._e()])])])])])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"popover-icon"},[e("div",{staticClass:"icon-stickers"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-row"},[e("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_url",placeholder:"Вставьте ссылку на изображение"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-row"},[e("input",{staticClass:"input--fw",attrs:{type:"text",name:"pic_url",placeholder:"Вставьте ссылку на изображение"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"c_google_agreement"},[this._v("This site is protected by reCAPTCHA and the Google "),e("a",{attrs:{href:"https://policies.google.com/privacy"}},[this._v("Privacy Policy")]),this._v(" and "),e("a",{attrs:{href:"https://policies.google.com/terms"}},[this._v("Terms of Service")]),this._v(" apply.")])}],!1,null,null,null),ot=it.exports;et()(it,{ClickOutside:st.a});var nt=s(30),at={data:function(){return{shareShow:!1,shareShow2:!1,emotesShow:!1,emotesDisShow:!1,reactionsShow:!1,answerFormShow:!1}},components:{CommentForm:ot},props:{post:{type:Object,required:!0},comment:{type:Object,required:!0},comment_user:{type:Object,required:!0},rateOnly:{type:Boolean,default:!1},commentBlock:{type:Boolean,default:!0},likeBlock:{type:Boolean,default:!0},shareBlock:{type:Boolean,default:!0},reactClass:{type:[String,Array,Object]},popClass:{type:[String,Array,Object]}},mixins:[nt.a],computed:{communityModerator:function(){return this.comment.status&&this.post.community&&this.post.community.moderated&&this.post.community&&this.post.community.id==this.post.community.moderated.community_id},cid:function(){return parseInt(this.comment.id)?parseInt(this.comment.id):0},ruid:function(){return this.comment_user&&parseInt(this.comment_user.user_id)?parseInt(this.comment_user.user_id):0},authClass:function(){return this.user&&(this.user.is_superuser||this.user.id&&this.user.id!=this.ruid)?"":" disabledel"},authClass2:function(){return this.user&&this.user.id?"":" disabledel"},isCross:function(){return this.comment.top_type&&this.comment.top_type.Cross&&this.comment.top_type.Cross.enabled},textCross:function(){return this.comment.top_type&&this.comment.top_type.Cross&&this.comment.top_type.Cross.state?"Несквозной":"Сквозной"},isLiked:function(){return this.comment.top_type&&this.comment.top_type.Liked&&this.comment.top_type.Liked.enabled},textLiked:function(){return this.comment.top_type&&this.comment.top_type.Liked&&this.comment.top_type.Liked.state?"Снять выделение":"Выделить"},isFixed:function(){return this.comment.top_type&&this.comment.top_type.Fixed&&this.comment.top_type.Fixed.enabled},textFixed:function(){return this.comment.top_type&&this.comment.top_type.Fixed&&this.comment.top_type.Fixed.state?"Открепить":"Закрепить"},extendReactions:function(){return this.isCross||this.isLiked||this.isFixed||this.communityModerator},user:function(){return B.a.get()},emoteCurrent:function(){return this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].mylike&&["like","omg","lol","love"].indexOf(this.post.commentsGroupLikes[this.comment.id].mylike.type)>-1?this.post.commentsGroupLikes[this.comment.id].mylike.type:"like-o"},emoteDisCurrent:function(){return this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].mylike&&["sad","nasty","dislike","angry"].indexOf(this.post.commentsGroupLikes[this.comment.id].mylike.type)>-1?this.post.commentsGroupLikes[this.comment.id].mylike.type:"dislike-o"},reactionsCount:function(){return[{icon:"like",text:"нравится",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.like.count:0},{icon:"omg",text:"любопытно",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.omg.count:0},{icon:"lol",text:"насмешило",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.lol.count:0},{icon:"sad",text:"печально",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.sad.count:0},{icon:"nasty",text:"Противно",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.nasty.count:0},{icon:"dislike",text:"не нравится",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.dislike.count:0},{icon:"angry",text:"бесит",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.angry.count:0},{icon:"love",text:"влюбило",count:this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike?this.post.commentsGroupLikes[this.comment.id].postlike.love.count:0}]},reactionsRate:function(){return{count:this.reactionsValue,text:"рейтинг поста"}},title:function(){return this.post.post_title?this.post.post_title:this.post.title},eTitle:function(){return encodeURI(r.a.myTrim(this.title,140))},encTitle:function(){return encodeURI(this.title)},eUrl:function(){return encodeURI(r.a.hostUrl+"/post/"+this.post.post_id+"/comment-"+this.comment.id)},reactionsValue:function(){return this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike.total?this.post.commentsGroupLikes[this.comment.id].postlike.total.value:0},reactionsTotal:function(){return this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&this.post.commentsGroupLikes[this.comment.id].postlike.total?this.post.commentsGroupLikes[this.comment.id].postlike.total.count:0},reactionsIcons:function(){var t=this.reactionsCount.slice().filter((function(t){return t.count>0})).sort((function(t,e){return e.count-t.count}));return t[3]&&t[3].count>0?t.slice(0,3).sort((function(t,e){return t.count-e.count})):t.sort((function(t,e){return t.count-e.count}))},reactionsCountSort:function(){return this.reactionsCount.slice().sort((function(t,e){return e.count-t.count}))},debounceShare:function(t){t=t||500;var e=this;return Object(I.debounce)((function(){e.shareShow=!1}),t)},debounceShare2:function(t){t=t||500;var e=this;return Object(I.debounce)((function(){e.shareShow2=!1}),t)},debounceMenu:function(){var t=this;return Object(I.debounce)((function(){t.reactionsShow=!1}),500)},debouncePanel:function(){var t=this;return Object(I.debounce)((function(){t.emotesShow=!1}),3e3)},debounceDisPanel:function(){var t=this;return Object(I.debounce)((function(){t.emotesDisShow=!1}),3e3)}},methods:{spamFormShow:function(t){t.preventDefault(),this.$root.$emit("spam-form-toggle",{status:!0,post_id:this.post.post_id,gallery_id:this.comment.gallery_id,comment_id:this.comment.id,user_id:this.comment_user.id})},banFormShow:function(t){t.preventDefault(),this.$root.$emit("ban-form-toggle",{status:!0,community_id:this.post.community.id,user_id:this.comment_user.id,cause_id:this.comment.id,type:"comment"})},popoverClass:function(t){var e=["popover"];if("string"==typeof t)e.push(t);else if(t&&"Object"==typeof t)for(var s in t)t[s]&&e.push(t[s]);return e.join(" ")},toggleShare:function(t){"svg"!=t.target.localName&&"use"!=t.target.localName||(this.shareShow=!this.shareShow)},showShare:function(t){this.debounceShare.clear(),this.shareShow=!0},hideShare:function(t){t=t||500,this.debounceShare(t)},toggleShare2:function(t){"svg"!=t.target.localName&&"use"!=t.target.localName||(this.shareShow2=!this.shareShow2)},showShare2:function(t){this.debounceShare.clear(),this.shareShow2=!0},hideShare2:function(t){t=t||500,this.debounceShare2(t)},showMenu:function(){this.reactionsShow=!0,this.debounceMenu.clear()},hideMenu:function(){this.debounceMenu()},hideLike:function(){this.debouncePanel()},hideDisLike:function(){this.debounceDisPanel()},handleLike:function(){"like-o"==this.emoteCurrent?this.handleEmote("like",!0):(this.emotesShow=!0,this.debouncePanel.clear())},showEmote:function(){this.debouncePanel.clear()},handleDisLike:function(){"dislike-o"==this.emoteDisCurrent?this.handleEmote("dislike",!0):(this.emotesDisShow=!0,this.debounceDisPanel.clear())},showDisEmote:function(){this.debounceDisPanel.clear()},handleEmote:function(t,e){var s=this;e=e||!0;var i=this.post.commentsGroupLikes[this.comment.id].mylike.type;this.post.commentsGroupLikes&&this.post.commentsGroupLikes[this.comment.id]&&(this.post.commentsGroupLikes[this.comment.id].mylike.type=t),["sad","nasty","dislike","angry"].indexOf(t)>-1?(s.emotesDisShow?(s.debounceDisPanel.clear(),e=!1):s.debounceDisPanel(),s.emotesShow=!1,s.emotesDisShow=e):(s.emotesShow?(s.debouncePanel.clear(),e=!1):s.debouncePanel(),s.emotesShow=e,s.emotesDisShow=!1),n.a.call("post.like",{like:t,post_id:this.post.post_id,gallery_id:this.post.gallery_id,comment_id:this.comment.id}).then((function(t){t&&t.data&&t.data.groupLikes&&void 0!==t.data.groupLikes[s.comment.id]&&(s.post.rates=t.data.rates,s.post.likes=t.data.likes,s.post.unlikes=t.data.unlikes,s.$set(s.post.commentsGroupLikes,s.comment.id,t.data.groupLikes[s.comment.id]))})).catch((function(t){t&&t.data&&0==t.data.status&&(this.post.commentsGroupLikes[this.comment.id].mylike.type=i,s.emotesShow=!1,s.emotesDisShow=!1)}))},showForm:function(){this.answerFormShow=!this.answerFormShow},hideForm:function(){this.answerFormShow=!1},toggleAction:function(t){var e=this;return n.a.call("comment.toggle",{post_id:this.post.post_id,gallery_id:this.post.gallery_id,comment_id:this.comment.id,action:t}).then((function(t){t&&t.data&&e.$root.$emit("reload-comments")})).catch((function(t){})),!1}},mounted:function(){}},rt=Object(h.a)(at,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment__reactions mt-1"},[t.likeBlock&&t.post.flags.allow_rate?s("div",{class:"emotes-wrap mr-c"+t.authClass,on:{mouseleave:t.hideLike}},[s("button",{on:{click:function(e){return t.handleLike()}}},[s("svg",{class:{invertable:"like-o"==t.emoteCurrent}},[s("use",{attrs:{href:"#emote-"+t.emoteCurrent}})])]),t._v(" "),s("transition",{attrs:{duration:1e3,name:"animation-fade"}},[t.emotesShow?s("div",{staticClass:"emotes-container",on:{mouseover:t.showEmote}},[s("button",{class:{current:"like"==t.emoteCurrent},on:{click:function(e){return t.handleEmote("like")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-like-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-like"}})])]),t._v(" "),s("button",{class:{current:"lol"==t.emoteCurrent},on:{click:function(e){return t.handleEmote("lol")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-lol-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-lol"}})])]),t._v(" "),s("button",{class:{current:"omg"==t.emoteCurrent},on:{click:function(e){return t.handleEmote("omg")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-omg-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-omg"}})])]),t._v(" "),s("button",{class:{current:"love"==t.emoteCurrent},on:{click:function(e){return t.handleEmote("love")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-love-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-love"}})])])]):t._e()])],1):t._e(),t._v(" "),t.likeBlock&&t.post.flags.allow_rate?s("div",{class:"emotes-wrap mr-1"+t.authClass,on:{mouseleave:t.hideDisLike}},[t.emotesShow?t._e():s("button",{on:{click:function(e){return t.handleDisLike()}}},[s("svg",{class:{invertable:"dislike-o"==t.emoteDisCurrent}},[s("use",{attrs:{href:"#emote-"+t.emoteDisCurrent}})])]),t._v(" "),s("transition",{attrs:{duration:1e3,name:"animation-fade"}},[t.emotesDisShow?s("div",{staticClass:"emotes-container",on:{mouseover:t.showDisEmote}},[s("button",{class:{current:"dislike"==t.emoteDisCurrent},on:{click:function(e){return t.handleEmote("dislike")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-dislike-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-dislike"}})])]),t._v(" "),s("button",{class:{current:"sad"==t.emoteDisCurrent},on:{click:function(e){return t.handleEmote("sad")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-sad-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-sad"}})])]),t._v(" "),s("button",{class:{current:"angry"==t.emoteDisCurrent},on:{click:function(e){return t.handleEmote("angry")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-angry-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-angry"}})])]),t._v(" "),s("button",{class:{current:"nasty"==t.emoteDisCurrent},on:{click:function(e){return t.handleEmote("nasty")}}},[s("svg",{staticClass:"emote-outline invertable"},[s("use",{attrs:{href:"#emote-nasty-o"}})]),t._v(" "),s("svg",{staticClass:"emote-normal"},[s("use",{attrs:{href:"#emote-nasty"}})])])]):t._e()])],1):t._e(),t._v(" "),s("button",{class:"btn-comment-answer mr-1"+t.authClass2,on:{click:t.showForm}},[t._v("ответить")]),t._v(" "),t.shareBlock?s("div",{staticClass:"popover-wrap mr-1",on:{mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.hideShare.apply(null,arguments)},mouseover:function(e){return e.preventDefault(),e.stopPropagation(),t.showShare.apply(null,arguments)},click:t.toggleShare}},[s("button",{staticClass:"popover-more"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-more"}})])]),t._v(" "),t.shareShow?s("div",{class:t.popoverClass(this.popClass),on:{mouseover:function(e){return e.preventDefault(),e.stopPropagation(),t.showShare.apply(null,arguments)},mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.hideShare.apply(null,arguments)}}},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"https://vk.com/share.php?url="+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vk"},[s("use",{attrs:{"xlink:href":"#social-vk"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться Вконтакте")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"https://connect.ok.ru/offer?url="+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-ok"},[s("use",{attrs:{"xlink:href":"#social-ok"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться в Одноклассниках")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"https://twitter.com/share?text="+t.eTitle+"&url="+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-tw"},[s("use",{attrs:{"xlink:href":"#social-tw"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться в Twitter")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"https://t.me/share/url?url="+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-tg"},[s("use",{attrs:{"xlink:href":"#social-tg"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться в Telegram")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"whatsapp://send?text="+t.encTitle+" | "+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-wa"},[s("use",{attrs:{"xlink:href":"#social-wa"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться в WhatsApp")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"viber://forward?text="+t.encTitle+" | "+t.eUrl},on:{click:t.hideShare}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#social-vb"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Поделиться в Viber")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:t.copyToClipboard}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#icon-link"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Скопировать ссылку")])]),t._v(" "),s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:t.spamFormShow}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#icon-unhappy"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Пожаловаться")])])]):t._e()]):t._e(),t._v(" "),t.extendReactions?s("div",{staticClass:"popover-wrap mr-a",on:{mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.hideShare2.apply(null,arguments)},mouseover:function(e){return e.preventDefault(),e.stopPropagation(),t.showShare2.apply(null,arguments)},click:t.toggleShare2}},[s("button",{staticClass:"popover-more"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-o-info"}})])]),t._v(" "),t.shareShow2?s("div",{class:t.popoverClass(this.popClass),on:{mouseover:function(e){return e.preventDefault(),e.stopPropagation(),t.showShare2.apply(null,arguments)},mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.hideShare2.apply(null,arguments)}}},[s("div",{staticClass:"popover-arrow"}),t._v(" "),t.communityModerator?s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:t.banFormShow}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#head-community"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Забанить в сообществе")])]):t._e(),t._v(" "),t.isFixed?s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleAction("Fixed")}}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#head-mystream"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v(t._s(t.textFixed))])]):t._e(),t._v(" "),t.isCross?s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleAction("Cross")}}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#icon-o-reply"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v(t._s(t.textCross))])]):t._e(),t._v(" "),t.isLiked?s("a",{staticClass:"popover-action",attrs:{target:"_blank",href:"javascript:void(0);"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleAction("Liked")}}},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"cl-vb"},[s("use",{attrs:{"xlink:href":"#icon-o-likecomment"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v(t._s(t.textLiked))])]):t._e()]):t._e()]):t._e(),t._v(" "),t.post.flags.allow_rate?s("div",{staticClass:"popover-wrap",on:{mouseleave:t.hideMenu,mouseover:t.showMenu}},[t.reactionsTotal>0?[s("button",{staticClass:"reactions-wrap"},[s("div",{staticClass:"reactions-count"},[t._v(t._s(t.reactionsTotal))]),t._v(" "),t._l(t.reactionsIcons,(function(e,i){return e.count>0?s("svg",{key:i},[s("use",{attrs:{href:"#emote-"+e.icon}})]):t._e()}))],2)]:t._e(),t._v(" "),t._e(),t._v(" "),s("transition",{attrs:{duration:1e3,name:"animation-fade"}},[t.reactionsShow?s("div",{class:t.popoverClass(this.reactClass)},[s("div",{staticClass:"popover-arrow"}),t._v(" "),t._l(t.reactionsCountSort,(function(e,i){return e.count>0?s("div",{key:i,staticClass:"popover-info"},[s("div",{staticClass:"popover-icon"},[s("svg",[s("use",{attrs:{href:"#emote-"+e.icon}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v(t._s(e.count+" "+e.text))])]):t._e()})),t._v(" "),t.reactionsValue?s("div",{staticClass:"popover-info"},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{href:"#icon-o-info"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v(t._s(t.reactionsValue+" "+t.reactionsRate.text))])]):t._e()],2):t._e()])],2):t._e(),t._v(" "),t.answerFormShow?s("div",[s("CommentForm",{attrs:{post:t.post,reply_id:t.cid,reply_to_user:t.ruid},on:{hideForm:t.hideForm}})],1):t._e()])}),[],!1,null,null,null).exports,lt=s(17),ct={components:{Gallerycomment:U,ReactionsComments:rt},props:{post:{type:Object,required:!0},comment:{type:Object,required:!0},comment_user:{type:Object,required:!0},reply_user:{type:Object,required:!0},limitanswer:{type:Number,default:5},hidden_text:{type:String,required:!1}},mixins:[o.a,m],computed:{refValue:function(){return"comment_ref_"+this.comment.id},enableEdit:function(){return this.comment.status&&!!this.comment.enable_edit&&this.comment.user_id&&this.comment.user_id==(B.a.isGuest()?-1:B.a.get().id)&&!this.post.comments.answers[this.comment.id]},communityModerator:function(){return this.comment.status&&this.post.community&&this.post.community.moderated&&this.post.community&&this.post.community.id==this.post.community.moderated.community_id},hasReply:function(){return this.reply_user&&this.reply_user.id?1:0},isOnline:function(){return this.comment_user&&(0!=this.comment_user.is_show_online&&0!=this.comment_user.is_online||this.comment_user.stats&&0!=this.comment_user.stats.is_show_online&&0!=this.stats.comment_user.is_online)?1:0},commentTo:function(){var t=this.date_ago(this.comment.dt)+" назад",e=!!(!this.post.gallery_id&&this.comment.gallery_id>0&&this.post.gitems&&this.post.gitems[this.comment.gallery_id])&&this.post.gitems[this.comment.gallery_id];return e&&(t+=" · комментарий к <a target='_blank' href='"+e.gallery_link+"'>"+(1==e.gallery_type?"фото":2==e.gallery_type?"видео":3==e.gallery_type?"тексту":4==e.gallery_type?"gif":"")+"</a>"),t}},methods:{spamFormShow:function(t){t.preventDefault(),this.$root.$emit("spam-form-toggle",{status:!0,post_id:this.post.post_id,gallery_id:this.comment.gallery_id,comment_id:this.comment.id,user_id:this.comment_user.id,user:"community_moderator"})},deleteComment:function(){this.$refs.popup.style.display="block",this.$refs.popup_del.style.display="none"},unDeleteComment:function(){this.$refs.popup.style.display="none",this.$refs.popup_del.style.display="block"},deleteCommentAction:function(){var t={comment_id:this.comment.id},e=this;n.a.call("comment.delete",t).then((function(t){if(t&&t.data){var s=document.getElementById(e.refValue);if(s&&s.parentElement){var i=s.parentElement.getElementsByClassName("hidden_text");i&&i.length?(i[0].innerHTML="Комментарий удален",i[0].style.display="block",s.remove()):s.innerHTML="Комментарий удален"}else s.innerHTML="Комментарий удален";e.$refs.popup.style.display="none",e.$refs.popup_del.style.display="none"}})).catch((function(t){t&&t.data&&t.data.msg&&(e.$refs.popup.style.display="none",e.$refs.popup_del.style.display="none",n.a.showMessage(t.data.msg))}))},goToComment:function(){var t=document.getElementById("comment_ref_"+this.comment.real_parent_id);t&&t.id&&(t.classList.add("selected"),this.isElementInViewport(t)||Object(lt.a)("comment_ref_"+this.comment.real_parent_id),setTimeout((function(){t.classList.remove("selected")}),15e3))}},mounted:function(){}},mt=Object(h.a)(ct,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment-one",attrs:{id:t.refValue}},[s("div",{staticClass:"comment__info"},[s("a",{staticClass:"avatar comment__avatar",style:"background-image: url("+t.avatar(t.comment_user)+")",attrs:{href:"/profile/"+t.comment_user.user_id+"/"}},[t._e(),t._v(" "),t.isOnline?s("span",{staticClass:"user-online-mark-sm"},[s("div")]):t._e()])]),t._v(" "),s("div",{staticClass:"comment__body"},[s("div",{staticClass:"comment__meta"},[t.enableEdit?s("button",{ref:"popup_del",staticClass:"chat-user__delete chat-user__delete_x",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteComment()}}},[t._v("x")]):t._e(),t._v(" "),t.communityModerator?s("button",{staticClass:"chat-user__delete chat-user__delete_x",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.spamFormShow.apply(null,arguments)}}},[t._v("x")]):t._e(),t._v(" "),s("a",{staticClass:"comment__meta__name",attrs:{href:"/profile/"+t.comment_user.user_id+"/"}},[t._v(t._s(t.userName(t.comment_user)))]),t._v(" "),s("div",{class:t.classUser(t.comment_user)},[s("i"),t._v(t._s(t.carma2string(t.comment_user)))]),t._v(" "),s("br"),t._v(" "),t.hasReply?s("div",{staticClass:"comment__meta__info comment__to",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToComment()}}},[t._v("»"),s("a",{staticClass:"comment__meta__name",attrs:{href:"/profile/"+t.reply_user.user_id+"/"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(t.userName(t.reply_user)))]),t._v("· "),s("span",{domProps:{innerHTML:t._s(t.commentTo)}})]):t._e(),t._v(" "),t.hasReply?t._e():s("div",{staticClass:"comment__meta__info comment__to",domProps:{innerHTML:t._s(t.commentTo)},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToComment()}}})]),t._v(" "),s("Gallerycomment",{attrs:{comment:t.comment}}),t._v(" "),t.hidden_text?s("div",{staticClass:"hidden_text"},[t._v(t._s(t.hidden_text))]):t._e(),t._v(" "),t.comment.status>0?s("ReactionsComments",{attrs:{post:t.post,comment:t.comment,comment_user:t.comment_user}}):t._e(),t._v(" "),t.enableEdit?s("div",{ref:"popup",staticClass:"comment-delete comment-best__head btn--outline",staticStyle:{display:"none"}},[s("p",[t._v("Вы действительно хотите удалить комментарий?")]),t._v(" "),s("a",{staticClass:"comment-best__head btn btn--grey btn--outline",attrs:{href:"javascript:void(0);"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteCommentAction()}}},[t._v("Удалить?")]),t._v(" "),s("a",{staticClass:"comment-best__head btn btn--green btn--outline",attrs:{href:"javascript:void(0);"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.unDeleteComment()}}},[t._v("Отмена")])]):t._e()],1)])}),[],!1,null,null,null).exports,ut=(s(37),{data:function(){return{show:!1}},components:{CommentInner:mt},props:{post:{type:Object,required:!0},comment:{type:Object,required:!0},comment_user:{type:Object,required:!0},reply_user:{type:Object,required:!0},reason_comment_hidden:{type:Object,required:!0},limitanswer:{type:Number,default:5}},mixins:[o.a,m],computed:{likedClass:function(){return this.comment.liked_comment?" liked_comment":""},refValue:function(){return"comment_ref_"+this.comment.id},hidden:function(){var t=B.a.get(),e=B.a.isAdmin()||B.a.isGlobalCommentModerator()||!B.a.isGuest()&&t&&t.id==this.comment.user_id,s="",i=!1,o=!0,n=!1;return this.comment.status<1?(n=!0,o=!1,i=e,s=this.reason_comment_hidden.status_0.text+(this.comment.reason_text?". Причина: "+this.comment.reason_text.toLowerCase():"")):(i=!0,!this.comment.selected&&(B.a.isGuest()||t&&t.id!=this.comment.user_id)&&(t&&t.subscriptions&&t.subscriptions[4]&&t.subscriptions[4][this.comment.user_id]?(n=!0,i=!1,s=this.reason_comment_hidden.blaсklist.text+" ("+this.reason_comment_hidden.blaсklist.val+")."):(this.comment.rate<=this.reason_comment_hidden.commentrating.val&&(n=!0,i=!1,s=this.reason_comment_hidden.commentrating.text),t&&t.carma<this.reason_comment_hidden.usercarma.val&&(n=!0,i=!1,s=this.reason_comment_hidden.usercarma.text)))),{status:n,text:s,button:o,show:i}},worstClass:function(){return"comment comment-worst"+(this.hidden.show?" comment-worst-hidden":"")}},methods:{toggle:function(){this.show=!this.show}},mounted:function(){}}),dt=Object(h.a)(ut,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.hidden.status?s("div",{class:t.worstClass+t.likedClass},[t.show||t.hidden.show?s("div",[s("CommentInner",{attrs:{post:t.post,comment:t.comment,comment_user:t.comment_user,reply_user:t.reply_user,limitanswer:t.limitanswer,hidden_text:t.hidden.text}}),t._v(" "),s("div",{staticClass:"comment-replies"},[t.show&&t.hidden.button?s("button",{staticClass:"btn btn--grey btn--hide btn--fw btn--outline mt-1",on:{click:function(e){return t.toggle()}}},[t._v("скрыть")]):t._e()])],1):s("div",[s("div",{staticClass:"hidden_text",attrs:{id:t.refValue}},[t._v("\n          "+t._s(t.hidden.text)+"\n        ")]),t._v(" "),s("div",{staticClass:"comment-replies"},[!t.show&&t.hidden.button?s("button",{staticClass:"btn btn--grey btn--fw btn--outline mt-1",on:{click:function(e){return t.toggle()}}},[t._v("показать")]):t._e()])])]):s("div",{class:t.likedClass,attrs:{id:"over_comment_"+t.comment.id}},[s("div",{staticClass:"hidden_text",staticStyle:{display:"none"}},[t._v("Вы пожаловались на этот комментарий")]),t._v(" "),s("CommentInner",{attrs:{post:t.post,comment:t.comment,comment_user:t.comment_user,reply_user:t.reply_user,limitanswer:t.limitanswer}})],1)}),[],!1,null,null,null).exports,pt={data:function(){return{popoverShow:!1,sortMode:0}},created:function(){var t=parseInt(i.a.get("c_sort"),10);t=t||0,this.sortMode=t},components:{},props:{post:{type:Object,required:!0}},mixins:[o.a,c],computed:{debouncePop:function(){return Object(I.debounce)((function(){this.popoverShow=!1}),500)}},methods:{classSort:function(t){return t==this.sortMode?"content__filter-link content__filter--active":"content__filter-link"},showPopover:function(){this.popoverShow=!0,this.debouncePop.clear()},hidePopover:function(){this.debouncePop()},switchSort:function(t){t=(t=parseInt(t,10))||0,i.a.set("c_sort",""+t),this.sortMode=t,this.getComments(this.post,{},"get")}}},ht=Object(h.a)(pt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment-filter-overlay"},[s("div",{staticClass:"content__filter u-flex hidden-sm hidden-md hidden-lg"},[s("button",{class:t.classSort(0),on:{click:function(e){return t.switchSort(0)}}},[t._v("новые")]),t._v(" "),s("button",{class:t.classSort(1),on:{click:function(e){return t.switchSort(1)}}},[t._v("лучшие")]),t._v(" "),s("button",{class:t.classSort(2),on:{click:function(e){return t.switchSort(2)}}},[t._v("старые")]),t._v(" "),s("div",{staticClass:"popover-wrap ml-a",on:{mouseleave:t.hidePopover}},[s("button",{staticClass:"content__filter-more",on:{click:t.showPopover}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-more"}})])]),t._v(" "),s("transition",{attrs:{duration:1e3,name:"animation-fade"}},[t.popoverShow?s("div",{staticClass:"popover popover--right"},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("button",{staticClass:"popover-action"},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-like-o"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("вообще")])]),t._v(" "),s("button",{staticClass:"popover-action"},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-dislike-o"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("пофиг")])])]):t._e()])],1)]),t._v(" "),s("div",{staticClass:"content__filter u-flex hidden-xs",on:{mouseleave:t.hidePopover}},[s("button",{class:t.classSort(0),on:{click:function(e){return t.switchSort(0)}}},[t._v("сначала новые")]),t._v(" "),s("button",{class:t.classSort(1),on:{click:function(e){return t.switchSort(1)}}},[t._v("сначала лучшие")]),t._v(" "),s("button",{class:t.classSort(2),on:{click:function(e){return t.switchSort(2)}}},[t._v("сначала старые")]),t._v(" "),s("div",{staticClass:"popover-wrap ml-a"},[s("button",{staticClass:"content__filter-more",on:{click:t.showPopover}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-more"}})])]),t._v(" "),s("transition",{attrs:{duration:1e3,name:"animation-fade"}},[t.popoverShow?s("div",{staticClass:"popover popover--right",on:{mouseover:t.showPopover}},[s("div",{staticClass:"popover-arrow"}),t._v(" "),s("button",{staticClass:"popover-action"},[s("div",{staticClass:"popover-icon"},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-unhappy"}})])]),t._v(" "),s("div",{staticClass:"popover-text nowrap"},[t._v("Мне не нравятся комментарии")])])]):t._e()])],1)])])}),[],!1,null,null,null).exports,ft={components:{Comment:dt,CommentsFilter:ht},props:{post:{type:Object,required:!0},hideBest:{type:Number,default:0},limitanswer:{type:Number,default:5}},created:function(){},mixins:[o.a,c],computed:{filterComments:function(){var t=[],e={};for(var s in this.post.comments.list){var i=this.post.comments.list[s];!i||i.top_type&&!this.post.gallery_id&&(i.top_type.Cross&&i.top_type.Cross.state||i.top_type.Fixed&&i.top_type.Fixed.state||i.top_type.Best&&i.top_type.Best.state&&!this.hideBest)||t.push(i)}for(var o in t=t.sort((function(t,e){return parseInt(t.weight)>parseInt(e.weight)?1:-1})))e[t[o].id]=t[o];return t}},methods:{likedClass:function(t){return t.liked_comment?" ov_liked_comment ":""}},mounted:function(){}},vt=Object(h.a)(ft,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"commentthread",staticClass:"comment-thread"},t._l(t.filterComments,(function(e,i){return s("div",{key:i,class:t.commentClass(e.id)+t.likedClass(e)},[s("Comment",{attrs:{post:t.post,comment:e,comment_user:t.commentUser(t.post,e),reply_user:t.replyUser(t.post,e),limitanswer:t.limitanswer,reason_comment_hidden:t.post.reason_comment_hidden}}),t._v(" "),t.hasReplies(e.id)?s("div",{staticClass:"comment-replies"},[t.hasMore(e.id,"delta")?s("div",{staticClass:"comment comment-replies__more mt-0"},[s("div",[s("button",{staticClass:"btn btn--grey btn--fw btn--outline",on:{click:function(s){return t.getMoreAnswers(e.id)}}},[t._v(t._s(t.getMoreTextAnswer(e.id)))])])]):t._e(),t._v(" "),t._l(t.filterAnswers(t.post.comments.answers[e.id]),(function(e,i){return s("div",{key:i,class:t.likedClass(e)+"comment"},[s("Comment",{attrs:{post:t.post,comment:e,comment_user:t.commentUser(t.post,e),reply_user:t.replyUser(t.post,e),limitanswer:t.limitanswer,reason_comment_hidden:t.post.reason_comment_hidden}})],1)})),t._v(" "),t.hasMore(e.id,"skip")?s("div",{staticClass:"comment comment-replies__more mt-1"},[s("button",{staticClass:"btn btn--grey btn--fw btn--outline",on:{click:function(s){return t.getMoreAnswers(e.id,!0)}}},[t._v(t._s(t.getPrevTextAnswer(e.id)))])]):t._e()],2):t._e()],1)})),0)}),[],!1,null,null,null).exports,_t={props:{obj:{type:Object,required:!0}},mixins:[],computed:{},methods:{cancelComBanForm:function(t){this.$refs.cause_textarea.value="",this.$refs.cause_select.value="",this.$root.$emit("ban-form-toggle",{status:!1})},sendComBanForm:function(t){t.preventDefault();var e=this;n.a.call("community.ban",{community_id:this.obj.community_id,user_id:this.obj.user_id,cause_id:this.obj.cause_id,type:this.obj.type,text:this.$refs.cause_textarea.value,days:this.$refs.cause_select.value}).then((function(t){(t=t&&t.data?t.data:{})&&t.msg&&n.a.showMessage(t.msg),e.$root.$emit("ban-form-toggle",{status:!1})})).catch((function(t){}))}}},gt=Object(h.a)(_t,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"form_com_ban",staticClass:"commmutity_ban_form"},[s("div",{staticClass:"commmutity_ban_close",on:{click:t.cancelComBanForm}},[s("svg",{staticClass:"invertable"},[s("use",{attrs:{"xlink:href":"#icon-close"}})])]),t._v(" "),s("textarea",{ref:"cause_textarea",staticClass:"cause_textarea",attrs:{placeholder:"Укажите причину бана"}}),t._v(" "),s("select",{ref:"cause_select",staticClass:"disable_styler cause_select"},[s("option",{attrs:{value:"",selected:"selected"}},[t._v("Выберите срок бана")]),t._v(" "),s("option",{attrs:{value:"1"}},[t._v("1 день")]),t._v(" "),s("option",{attrs:{value:"7"}},[t._v("1 неделя")]),t._v(" "),s("option",{attrs:{value:"31"}},[t._v("1 месяц")]),t._v(" "),s("option",{attrs:{value:"3650"}},[t._v("постоянный бан")])]),t._v(" "),s("div",{staticClass:"clearfix ban-form-buttons"},[s("input",{staticClass:"btn-gray btn-gray--bdtl com_button_ban",attrs:{type:"button",value:"Забанить"},on:{click:t.sendComBanForm}}),t._v(" "),s("input",{staticClass:"btn-green btn-green--bdtl com_button_ban",attrs:{type:"button",value:"Отмена"},on:{click:t.cancelComBanForm}})])])}),[],!1,null,null,null).exports,bt={data:function(){return{actions:[],reason_id:0,reason_text:""}},props:{reasons:{type:Object,required:!0},obj:{type:Object,required:!0}},mixins:[],computed:{hasPlusOdin:function(){return B.a.isGuest()&&!this.reasons.hasAvailableActions},noModerator:function(){return!this.obj.user||"community_moderator"!=this.obj.user}},methods:{sendSpamForm:function(t){t.preventDefault();var e=this;n.a.call("comment.hide",{post_id:this.obj.post_id,gallery_id:this.obj.gallery_id,comment_id:this.obj.comment_id,reason_id:this.reason_id,reason_text:this.reason_text?this.reason_text:"",actions:this.actions?this.actions:[],user:this.obj.user?this.obj.user:""}).then((function(t){if((t=t&&t.data?t.data:{})&&t.msg&&n.a.showMessage(t.msg),t&&t.comment_id){var s=document.getElementById("over_comment_"+t.comment_id);s&&s.classList.add("comment-worst")}e.$root.$emit("spam-form-toggle",{status:!1})})).catch((function(t){}))},hideSpamFormShow:function(){this.$root.$emit("spam-form-toggle",{status:!1})},checkLengthString:function(t){var e=(t=t||window.event).target||t.srcElement;switch(t.keyCode?t.keyCode:t.which?t.which:t.charCode){case 13:case 8:case 9:case 46:case 37:case 38:case 39:case 40:return!0}e.value.length>e.getAttribute("maxlength")&&t.preventDefault()}},mounted:function(){for(var t=this.$refs["form-complain"],e=document.getElementById("submit_button_spam"),s=t.getElementsByTagName("textarea"),i=t.getElementsByClassName("radio"),o=0;o<i.length;o++)i[o].addEventListener("click",(function(t){e.removeAttribute("disabled"),"reason--other"==t.target.id?(s[0].removeAttribute("disabled"),s[0].focus()):(s[0].setAttribute("disabled","disabled"),s[0].blur())}))}},yt={data:function(){return{showBanForm:!1,showSpamForm:!1,objBanForm:!1,objSpamForm:!1,hideBest:0,hasGif:!1,hasInstagram:!1,hasTwitter:!1,hasFacebook:!1,hasVk:!1,hasTiktok:!1,hasTme:!1,hasVideo:!1,listTop:{Cross:"Cross",Fixed:"Fixed",Best:"Best"},firstNext:!0}},components:{Comment:dt,CommentsFilter:ht,CommentForm:ot,CommentsThread:vt,Banform:gt,Spamform:Object(h.a)(bt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"spam-form-holder"},[t._m(0),t._v(" "),s("div",{staticClass:"spam-form"},[t._m(1),t._v(" "),s("form",{ref:"form-complain",staticClass:"form-complain",attrs:{action:"/complaint/hide/"}},[s("div",{staticClass:"publisher__source"},[s("div",{staticClass:"spam-form-reason"},[t._l(t.reasons.list,(function(e,i){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.reason_id,expression:"reason_id"}],staticClass:"radio",attrs:{type:"radio",name:"reason",id:"reason--"+i},domProps:{value:i,checked:t._q(t.reason_id,i)},on:{change:function(e){t.reason_id=i}}}),t._v(" "),s("label",{attrs:{for:"reason--"+i}},[t._v(t._s(e))])]})),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.reason_id,expression:"reason_id"}],staticClass:"radio",attrs:{id:"reason--other",type:"radio",name:"reason"},domProps:{value:t.reasons.REASON_OTHER,checked:t._q(t.reason_id,t.reasons.REASON_OTHER)},on:{change:function(e){t.reason_id=t.reasons.REASON_OTHER}}}),t._v(" "),s("label",{attrs:{for:"reason--other"}},[t._v("Другое")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason_text,expression:"reason_text"}],staticClass:"reason-text",attrs:{name:"reason-text",disabled:"disabled",maxlength:"255"},domProps:{value:t.reason_text},on:{onkeypress:t.checkLengthString,input:function(e){e.target.composing||(t.reason_text=e.target.value)}}}),t._v(" "),t.noModerator?s("div",{staticClass:"spam_ban"},[t._l(t.reasons.availableActions,(function(e,i){return[s("div",{class:"ban-action "+(i==t.reasons.ACTION_WARNING?"action_warning":""),attrs:{"data-carma":e.carma}},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.actions,expression:"actions"}],attrs:{type:"checkbox",name:"ban_action[]"},domProps:{value:i,checked:Array.isArray(t.actions)?t._i(t.actions,i)>-1:t.actions},on:{change:function(e){var s=t.actions,o=e.target,n=!!o.checked;if(Array.isArray(s)){var a=i,r=t._i(s,a);o.checked?r<0&&(t.actions=s.concat([a])):r>-1&&(t.actions=s.slice(0,r).concat(s.slice(r+1)))}else t.actions=n}}}),t._v(t._s(e.text))])])]})),t._v(" "),t.hasPlusOdin?[t._v("\n                            Если Ваша жалоба окажется решающей в принятии решения о бане пользователя, то Вам в карму поступит +1 балл\n                        ")]:t._e()],2):t._e()],2),t._v(" "),s("div",{staticClass:"clearfix spam-form-buttons"},[s("input",{staticClass:"btn-green btn-green--bdtl",attrs:{type:"button",id:"submit_button_spam",value:"Отправить жалобу",disabled:"disabled"},on:{click:t.sendSpamForm}}),t._v(" "),s("a",{staticClass:"modal_hide",attrs:{href:"javascript:void(0)"},on:{click:t.hideSpamFormShow}},[s("strong",[t._v("Вернуться")])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"preloader"},[e("img",{attrs:{src:"/images/fishki/482.gif",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"spam-form-text"},[e("strong",[this._v("На что жалуетесь?")])])}],!1,null,null,null).exports},props:{post:{type:Object,required:!0},limit:{type:Number,default:20},limitanswer:{type:Number,default:5}},created:function(){var t=this,e=parseInt(i.a.get("best-top-comment-hide"),10);e=e||0,this.hideBest=e,this.$root.$on("spam-form-toggle",(function(e){t.objSpamForm=e,t.showSpamForm=e.status})),this.$root.$on("ban-form-toggle",(function(e){t.objBanForm=e,t.showBanForm=e.status})),this.$root.$on("reload-comments",(function(e){t.getComments(t.post,{},"get")}))},mixins:[o.a,c],computed:{minmaxComments:function(){var t,e,s=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(var o in this.post.comments.list)this.post.comments.list[o].weight<=s&&(s=(t=this.post.comments.list[o]).weight),this.post.comments.list[o].weight>i&&(i=(e=this.post.comments.list[o]).weight);return{max:e,min:t}},bestComment:function(){var t={};for(var e in this.post.comments.list)this.post.comments.list[e]&&this.post.comments.list[e].top_type&&(this.post.comments.list[e].top_type.Cross&&this.post.comments.list[e].top_type.Cross.state?t.Cross=this.post.comments.list[e]:this.post.comments.list[e].top_type.Fixed&&this.post.comments.list[e].top_type.Fixed.state?t.Fixed=this.post.comments.list[e]:this.post.comments.list[e].top_type.Best&&this.post.comments.list[e].top_type.Best.state&&!this.hideBest&&(t.Best=this.post.comments.list[e]));return t},isPhoto:function(){return!!this.post.gallery_id}},methods:{likedClass:function(t){return t.liked_comment?" ov_liked_comment ":""},noBestOnly:function(t){return!t||!t.top_type||t.top_type.Cross&&t.top_type.Cross.state||t.top_type.Fixed&&t.top_type.Fixed.state},bestTitle:function(t){if(!t)return"";var e=[];return t.top_type.Cross&&t.top_type.Cross.state&&e.push("сквозной"),t.top_type.Fixed&&t.top_type.Fixed.state&&e.push("закрепленный"),t.top_type.Best&&t.top_type.Best.state&&e.push("лучший"),1==e.length?e[0]+" комментарий":e.length>1?(e=e.join(", ")).substring(0,e.lastIndexOf(","))+" и"+e.substring(e.lastIndexOf(",")+1)+" комментарий":""},getMoreTextComment:function(){var t=this.getMore("comments");return"Показать ещё "+t.realdelta+" "+this.pluralForm(t.realdelta,"комментарий","комментария","комментариев")+(t.realall&&t.realall>t.realdelta?" из "+t.realall:"")},getPrevTextComment:function(){var t=this.getMore("comments");return t.skip<=this.limit?"Показать "+t.skip+" "+this.pluralForm(t.skip,"предыдущий комментарий","предыдущих комментария","предыдущих комментариев"):"Показать ещё "+this.limit+" "+this.pluralForm(this.limit,"предыдущий комментарий","предыдущих комментария","предыдущих комментариев")+" из "+t.skip},getMoreComments:function(t){var e={mode:"more"};this.isPhoto&&(e.comment_photo=1);var s=this.getMore("comments"),o=t?this.minmaxComments.max:this.minmaxComments.min;if("next"==t){var n=parseInt(i.a.get("c_sort"),10);n=n||0,e.last_comment_id=this.isPhoto&&this.firstNext?0:1==n?s.offset:o.id}else"prev"==t&&(e.skip=s.skip);this.firstNext=!1,this.getComments(this.post,e,t,o)},toggleMode:function(){var t=parseInt(i.a.get("c_sort"),10);t=t||0;var e={post_id:this.post.post_id,sort:t},s=this;this.hideBest?i.a.set("best-top-comment-hide","0",3650):i.a.set("best-top-comment-hide","1",3650),n.a.call("comment.lists",e).then((function(t){t&&t.data&&(s.post.gitems=t.data.gitems,s.post.comments=t.data.comments,s.post.commentsGroupLikes=t.data.groupLikes,s.hideBest=s.hideBest?0:1)})).catch((function(t){}))}},mounted:function(){a.a.loadScript("https://www.google.com/recaptcha/api.js?onload=postOnloadCallback&render="+r.a.recaptchav3,(function(){"undefined"!=typeof grecaptcha&&grecaptcha.ready((function(){}))})),a.a.loadScript(r.a.scripts.lightbox,(function(){lightbox.option({fitImagesInViewport:!1,disableScrolling:!0,wrapAround:!0,albumLabel:"Фото %1 of %2"})})),this.checkEmbeded();var t=this;t.post.embedComment>0&&(window.scrollTo(0,0),this.$nextTick((function(){var e=10,s=setInterval((function(){if(--e<1||0==$(".content__figure__wrap__lazy").length){var i=document.getElementById("comment_ref_"+t.post.embedComment);i.classList.add("selected"),Object(lt.a)("comment_ref_"+t.post.embedComment),setTimeout((function(){i.classList.remove("selected")}),15e3),clearInterval(s)}else 8==e&&Object(lt.a)("comment_ref_"+t.post.embedComment)}),200)})))}},wt=Object(h.a)(yt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"commentlist",staticClass:"comment-overlay",attrs:{id:"coverlay_"+t.post.post_id+"_"+t.post.gallery_id}},[s("h5",{staticClass:"content__sub-heading"},[t._v(t._s(t.post.comments.total_number_comments+" "+t.pluralForm(t.post.comments.total_number_comments,"комментарий","комментария","комментариев")))]),t._v(" "),s("CommentsFilter",{attrs:{post:t.post}}),t._v(" "),s("CommentForm",{attrs:{post:t.post}}),t._v(" "),t._l(t.listTop,(function(e){return s("div",{staticClass:"comment-best"},[t.bestComment&&t.bestComment[e]&&t.bestComment[e]&&(t.noBestOnly(t.bestComment[e])||!t.hideBest)?s("div",[s("div",{staticClass:"comment-best__head"},[t._v(t._s(t.bestTitle(t.bestComment[e])))]),t._v(" "),s("div",{class:t.commentClass(t.bestComment[e].id)+t.likedClass(t.bestComment[e])},[s("Comment",{attrs:{post:t.post,comment:t.bestComment[e],comment_user:t.commentUser(t.post,t.bestComment[e]),reply_user:t.replyUser(t.post,t.bestComment[e]),limitanswer:t.limitanswer,reason_comment_hidden:t.post.reason_comment_hidden}}),t._v(" "),t.hasMore(t.bestComment[e].id,"delta")||t.hasMore(t.bestComment[e].id,"skip")||t.hasReplies(t.bestComment[e].id)?s("div",{staticClass:"comment-replies"},[t.hasMore(t.bestComment[e].id,"delta")?s("div",{staticClass:"comment comment-replies__more mt-1"},[s("button",{staticClass:"btn btn--grey btn--fw btn--outline",on:{click:function(s){return t.getMoreAnswers(t.bestComment[e].id)}}},[t._v(t._s(t.getMoreTextAnswer(t.bestComment[e].id)))])]):t._e(),t._v(" "),t._l(t.filterAnswers(t.post.comments.answers[t.bestComment[e].id]),(function(e,i){return s("div",{key:i,class:"comment"+t.likedClass(e)},[s("Comment",{attrs:{post:t.post,comment:e,comment_user:t.commentUser(t.post,e),reply_user:t.replyUser(t.post,e),limitanswer:t.limitanswer,reason_comment_hidden:t.post.reason_comment_hidden}})],1)})),t._v(" "),t.hasMore(t.bestComment[e].id,"skip")?s("div",{staticClass:"comment comment-replies__more mt-1"},[s("button",{staticClass:"btn btn--grey btn--fw btn--outline",on:{click:function(s){return t.getMoreAnswers(t.bestComment[e].id,!0)}}},[t._v(t._s(t.getPrevTextAnswer(t.bestComment[e].id)))])]):t._e()],2):t._e()],1)]):t._e(),t._v(" "),(t.bestComment&&t.bestComment[e]&&!t.noBestOnly(t.bestComment[e])||"Best"==e)&&!t.hideBest?s("button",{staticClass:"comment-best__head btn text--bold btn--fw mt-1 mb-2",on:{click:function(e){return t.toggleMode()}}},[t._v("Скрыть лучший комментарий")]):t._e(),t._v(" "),(t.bestComment&&t.bestComment[e]&&!t.noBestOnly(t.bestComment[e])||"Best"==e)&&t.hideBest?s("button",{staticClass:"comment-best__head btn text--bold btn--fw mt-1 mb-2",on:{click:function(e){return t.toggleMode()}}},[t._v("Показать лучший комментарий")]):t._e()])})),t._v(" "),t.getMore("comments").skip>0?s("a",{staticClass:"btn btn--grey btn--fw btn--outline mt-1",attrs:{href:"javascript:;"},on:{click:function(e){return t.getMoreComments("prev")}}},[t._v(t._s(t.getPrevTextComment()))]):t._e(),t._v(" "),s("CommentsThread",{attrs:{post:t.post,hideBest:t.hideBest,limitanswer:t.limitanswer}}),t._v(" "),t.getMore("comments").realdelta>0?s("a",{staticClass:"btn btn--grey btn--fw btn--outline mt-1",attrs:{href:"javascript:;"},on:{click:function(e){return t.getMoreComments("next")}}},[t._v(t._s(t.getMoreTextComment()))]):t._e(),t._v(" "),t.showSpamForm?s("div",[s("Spamform",{attrs:{reasons:t.post.reasons,obj:t.objSpamForm}})],1):t._e(),t._v(" "),t.showBanForm?s("div",[s("Banform",{attrs:{obj:t.objBanForm}})],1):t._e()],2)}),[],!1,null,null,null);e.a=wt.exports},4:function(t,e){t.exports={categories:[{id:34,title:"Солянка",alias:"mix"},{id:43,title:"Ссылочная солянка",alias:"linkmix"},{id:44,title:"Праздники",alias:"celebration"},{id:45,title:"Рецепты",alias:"recipe"},{id:46,title:"Трейлеры",alias:"trailers"},{id:47,title:"Каско",alias:"kasko"},{id:1,title:"Авто",alias:"auto"},{id:9,title:"Демотиваторы",alias:"demotivation"},{id:12,title:"Фото",alias:"photo"},{id:15,title:"Открытки",alias:"cards"},{id:18,title:"Смс",alias:"sms"},{id:20,title:"Анекдоты",alias:"anekdot"},{id:21,title:"Статусы",alias:"status"},{id:22,title:"Видео",alias:"video"},{id:23,title:"Гифки",alias:"gif"},{id:24,title:"Мем",alias:"mem"},{id:11,title:"Антифишки",alias:"anti"}],upload_limit:{upload_image:{min_width:450,min_height:90,size_limit:1048576},upload_video:{size_limit:5368709120},upload_mp3:{size_limit:10485760},upload_animated_gif:{min_width:100,min_height:90,size_limit:20971520}},tn:{enabled_webp:1,default_video_turborss:"https://cdn.fishki.net/images/tn/default-fishki.jpg",replaced_domains:{"":["fishki.net","avatars.img.fishki.net","ru.fishki.net","cdn.fishki.net","s.fishki.net","sos.fishki.net"],"/pics":["pics.fishki.net"]}},recaptchav3:"6LebZpEeAAAAAH2TeG3XvOO-I-LKdWORyRrflVD8",votes:{options:{globalTestOpen:{no:"Нет",yes:"Да"},autoStartTest:{no:"Нет",yes:"Да",defaultadmin:"yes"},showOnMain:{no:"Нет",yes:"Да"},authNeed:{no:"Нет",yes:"Да"},onHead:{no:"Нет",yes:"Да"},hintInImage:{no:"Нет",yes:"Да"},noResult:{no:"Нет",yes:"Да"},explainQuestionList:{no:"Нет",yes:"Да"},showStageResult:{no:"Нет",yes:"Да"},emptyCheckbox:{no:"Нет",yes:"Да"},counterCheckbox:{no:"Нет",yes:"Да"},skipCheckbox:{no:"Нет",yes:"Да"},resultOnImage:{no:"Нет",yes:"Да"},noSharingResult_image:{no:"Нет",yes:"Да"},showFirst:{no:"Нет",yes:"Да"},showQImage:{no:"Нет",yes:"Да"},isIchieve:{no:"Нет",yes:"Да",defaultinput:""},branding98:{no:"Нет",yes:"Да",is_digit:1,placeholder:"Укажите ID брендирования, в виде id[_subid]"},mixedMode:{no:"Нет",yes:"Да"},templateType:{no:"Нет",yes:"Да",is_digit:1,placeholder:"Укажите номер верстки",defaultselect:2,select:["Новая","Старая","Vue"]}},g_types:["Тест с последовательным выводом всех вопросов","Тест где все вопросы в единой ленте","Опрос с последовательным выводом всех вопросов, не поддерживается в /add/","Опрос где все вопросы в единой ленте","Facebook-тест, в админке может только редактироваться"],subtypes:["Обычный тест или опрос, созданный редактором","Тест где ответ влияет на несколько результатов (Импорт с playbuzz)","Результат цифрами на картинке (Труп)","Результат цифрами в центре картинки","Тест с результатами в формате JSON"]}}},7:function(t,e,s){"use strict";var i={STATUS_DISABLED:0,STATUS_ACTIVE:1,USERGROUP_USER:0,USERGROUP_ADMIN:1,USER_GROUP_EDITOR:2,USER_GROUP_COMMENT_MODERATOR:3,USER_GROUP_COMMENT_MODERATOR_NOT_SOL:4,USER_GROUP_ADV_ADMIN:5,USER_GROUP_COMMUNITY:6,USER_GROUP_COMMENT_GLOBAL:7,USER_REWRITER:8,isGuest:function(){return!(window&&window.fishki&&window.fishki.app&&window.fishki.app.user&&window.fishki.app.user.id)},isAdmin:function(){var t=window&&window.fishki&&window.fishki.app&&window.fishki.app.user||{};return t&&1===t.usergroup},isGlobalCommentModerator:function(){var t=window&&window.fishki&&window.fishki.app&&window.fishki.app.user||{};return t&&7===t.usergroup},get:function(){return window&&window.fishki&&window.fishki.app&&window.fishki.app.user||{}},sid:function(t){if(void 0===t&&window&&window.fishki&&window.fishki.cookie)return window.fishki.cookie.get(config.user.cookies.sid)}};e.a=i},79:function(t,e,s){"use strict";s.r(e),function(t){s.d(e,"install",(function(){return a}));s(19);var i=s(20),o=s(21),n=s(39);function a(t){a.installed||(a.installed=!0,t.directive("lazyload",i.a),t.directive("clickOutside",o.a),t.component("Comments",n.a))}var r={install:a},l=null;"undefined"!=typeof window?l=window.Vue:void 0!==t&&(l=t.Vue),l&&l.use(r),e.default=n.a}.call(this,s(22))},8:function(t,e,s){"use strict";var i=s(11),o=s.n(i),n=s(0);function a(t,e){var s=new Date(t);return s.setDate(t.getDate()+e),s}function r(t){return n.a.ssrContext?n.a.ssrContext.cookies.get(t):o.a.get(t)}e.a={set:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(void 0!==e)if(e){var i={httpOnly:!1,domain:"."+n.a.domain()};n.a.ssrContext?(s&&(i.expires=a(new Date,s)),n.a.ssrContext.cookies.set(t,e,i)):(s&&(i.expires=s),o.a.set(t,e,i))}else n.a.ssrContext?n.a.ssrContext.cookies.set(t,null,{expires:new Date(0),domain:"."+n.a.domain()}):o.a.remove(t);return r(t)},get:r,remove:function(t,e){return n.a.ssrContext?n.a.ssrContext.cookies.remove(t,e):o.a.remove(t,e)}}},84:function(t,e){},85:function(t,e){},86:function(t,e){},9:function(t,e,s){"use strict";s(0);var i=[],o=[];function n(t,e){if(o[t].ready){for(var s in o[t].callback){var i=o[t].callback[s];"function"==typeof i&&i(e)}o[t].callback=[]}}e.a={loadScript:function(t,e,s){for(var a in void 0===s&&(s=Math.random(1e7)),i)if("string"==typeof i[a]&&-1!=i[a].indexOf(t)&&null!=o[a])return o[a].callback.push(e),void n(a,!0);s&&-1==t.indexOf("?")&&(t=t+"?"+s);var r=i.push(t)-1;o[r]={callback:[e],ready:!1};var l=document.createElement("script"),c=document.getElementsByTagName("script")[0];l.async=1,l.onload=l.onreadystatechange=function(t,e){(e||!l.readyState||/loaded|complete/.test(l.readyState))&&(l.onload=l.onreadystatechange=null,l=void 0,e||(o[r].ready=!0,n(r,!1)))},l.src=t,c.parentNode.insertBefore(l,c)}}}});