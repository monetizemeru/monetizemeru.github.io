(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{221:function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"e",function(){return s}),n.d(e,"f",function(){return a}),n.d(e,"g",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"h",function(){return l}),n(147);var r,o,i,s="Popup has no permission to appear",a="Произошла ошибка сервера. Попробуйте позднее",c="Введите E-mail",u="Введен некорректный E-mail",l=window;(e=r=r||{})[e.INVALID=0]="INVALID",e[e.EMPTY=1]="EMPTY",e[e.VALID=2]="VALID",(n=o=o||{})[n.AUTHORIZED_SUBSCRIBED=1]="AUTHORIZED_SUBSCRIBED",n[n.UNAUTHORIZED_SUBSCRIBED_NEED_CONFIRM=2]="UNAUTHORIZED_SUBSCRIBED_NEED_CONFIRM",n[n.NEW_USER_SUBSCRIBED_NEED_CONFIRM=3]="NEW_USER_SUBSCRIBED_NEED_CONFIRM",n[n.ALREADY_SUBSCRIBED=-2]="ALREADY_SUBSCRIBED",n[n.ALREADY_SUBSCRIBED_NEED_CONFIRM=-3]="ALREADY_SUBSCRIBED_NEED_CONFIRM",n[n.USER_BLOCKED=-4]="USER_BLOCKED",(e=i=i||{})[e.EMPTY=-1]="EMPTY",e[e.MAX_DAYS=Number.POSITIVE_INFINITY]="MAX_DAYS"},497:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return c}),n.d(e,"c",function(){return u}),n.d(e,"e",function(){return a}),n.d(e,"f",function(){return l}),n.d(e,"g",function(){return s}),n.d(e,"d",function(){return i}),n.d(e,"h",function(){return f}),n(44),n(130),n(147),n(49),n(152),n(160);var r=n(221),o=function(e){return new Promise(function(t){return setTimeout(t,e)})},i=function(t,e){return Math.round(Math.abs((Number(t)-Number(e))/864e5))-1},s=function(){return r.h.kommersant?Boolean("mobile"===r.h.kommersant.media):Boolean(r.h.innerWidth<=1198)},a=function(){return r.h.docInfo&&r.h.docInfo.publishing&&r.h.docInfo.publishing.id?Number(r.h.docInfo.publishing.id):null},c=function(){return r.h.kommersant&&r.h.kommersant.user?r.h.kommersant.user.data.Email:""},u=function(){return r.h.kommersant&&r.h.kommersant.user?r.h.kommersant.user.data.UserId:null},l=function(t,e){var n=e?" "+e:"";switch(t){case r.g.AUTHORIZED_SUBSCRIBED:return{header:"Подписка оформлена!",subheader:"Вы всегда можете отменить подписку в Личном Кабинете"};case r.g.UNAUTHORIZED_SUBSCRIBED_NEED_CONFIRM:case r.g.NEW_USER_SUBSCRIBED_NEED_CONFIRM:return{header:"Проверьте Вашу почту",subheader:"На указанный адрес".concat(n," выслана ссылка для подтверждения подписки")};case r.g.ALREADY_SUBSCRIBED:return{header:"Вы уже подписаны на эту рассылку",subheader:"На указанный адрес".concat(n," уже оформлена эта подписка.")};case r.g.ALREADY_SUBSCRIBED_NEED_CONFIRM:return{header:"Проверьте Вашу почту",subheader:"На указанный адрес".concat(n," повторно выслана ссылка для подтверждения подписки")};case r.g.USER_BLOCKED:return{header:"Адрес заблокирован",subheader:"Данный адрес".concat(n," был заблокирован")};default:return null}},f=function(t){return t?/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)?r.d.VALID:r.d.INVALID:r.d.EMPTY}},517:function(t,e,n){"use strict";function r(t,s,a,c){return new(a=a||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((c=c.apply(t,s||[])).next())})}function o(r,o){var i,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(i=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))c.label=e[1];else if(6===e[0]&&c.label<a[1])c.label=a[1],a=e;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}n.d(e,"a",function(){return s}),n(44),n(130),n(140),n(141),n(142),n(57),n(92),n(52),n(160);var i=n(497),s=(a.getInstance=function(){return a.instance=a.instance||new a},a.prototype.subscribe=function(e,n){return r(this,void 0,void 0,function(){return o(this,function(t){return[2,fetch(this.subscribeUrl,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({SubscriptionId:e,Email:n})}).then(function(t){return t.json()})]})})},a.prototype.requestUserSubscriptions=function(){return r(this,void 0,void 0,function(){var e;return o(this,function(t){return e=Object(i.c)(),[2,fetch("/lk/UserSiteSubscriptions",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({UserId:e})}).then(function(t){return t.json()})]})})},a);function a(){this.subscribeUrl="/lk/UserSiteSubscriptionSubscribe"}},518:function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return i}),n.d(e,"d",function(){return s}),n.d(e,"f",function(){return r}),n.d(e,"e",function(){return a}),n.d(e,"g",function(){return u}),n.d(e,"h",function(){return l});var r,o="Push notifications are not supported",i="No push service library provided for service provider",s="No service registration provided",a="Push notifications blocked",c=19,u="#push-subscription-trigger",l=window;(n=r=r||{})[n.DEFAULT=0]="DEFAULT",n[n.GRANTED=1]="GRANTED",n[n.DENIED=2]="DENIED"},537:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(551),o=(i.getService=function(){return i.service=i.service||Object(r.b)()},i);function i(){}},551:function(t,e,n){"use strict";function r(t,s,a,c){return new(a=a||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((c=c.apply(t,s||[])).next())})}function o(r,o){var i,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(i=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))c.label=e[1];else if(6===e[0]&&c.label<a[1])c.label=a[1],a=e;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}function i(t){this.pushStorage=t}function s(){return n.e(46).then(n.t.bind(null,758,7))}n.d(e,"a",function(){return I}),n.d(e,"b",function(){return E}),n(52),n(44),n(130),n(140),n(141),n(142),n(57),n(92),i.prototype.checkUserTokenInStorage=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){return[2,this.pushStorage.check(e)]})})},i.prototype.saveUserTokenInStorage=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.pushStorage.add(e)];case 1:return t.sent(),[2]}})})},i.prototype.removeUserTokenFromStorage=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.pushStorage.remove(e)];case 1:return t.sent(),[2]}})})},e=i;var a={apiKey:"AIzaSyAlaGxRMkFkBYEXW9Selc8_nrX_81KU1hw",authDomain:"kommersantsite.firebaseapp.com",databaseURL:"https://kommersantsite.firebaseio.com",projectId:"kommersantsite",storageBucket:"kommersantsite.appspot.com",messagingSenderId:"635839491665",appId:"1:635839491665:web:00f1d6a3d9d3e96b9c9270"},c=n(518),u=(n(513),n(208),l.prototype.show=function(){var t=this,e=document.querySelector(".push_message_container");e&&e.remove(),this.container.innerHTML=this.createPushMessage(),this.container.querySelector(".push_message__close").addEventListener("click",this.close),document.body.appendChild(this.container),setTimeout(function(){t.container.classList.add("push_message_container_visible")},0),setTimeout(function(){t.close()},1e4)},l.prototype.createPushMessage=function(){return'<div class="push_message">\n            <a href="'.concat(this.link,'" target="_blank">\n                <div class="push_message__logo"><img src="https://im.kommersant.ru/ContentFlex/images/ER_blue.png"/></div>\n                <div class="push_message__content">\n                    <div class="push_message__title">').concat(this.title,'</div>\n                    <div class="push_message__subtitle">').concat(this.subtitle,'</div>\n                </div>\n            </a>\n            <div class="push_message__close">&times;</div>\n        </div>')},l);function l(t,e,n){var r=this;this.close=function(){r.container.remove()},this.title=t,this.subtitle=e,this.link=n,this.stylesImport=s,this.stylesImport().then(function(t){t.use()}).catch(console.error),this.container=document.createElement("div"),this.container.className="push_message_container"}function f(t,s,a,c){return new(a=a||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((c=c.apply(t,s||[])).next())})}function p(r,o){var i,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(i=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))c.label=e[1];else if(6===e[0]&&c.label<a[1])c.label=a[1],a=e;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}var h,d=n(570),v=(n(605),function(t,e){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)}),m=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(y,h=e),y.prototype.init=function(){return f(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.initiated?[3,2]:(e=this,[4,y.registerServiceWorker()]);case 1:e.registration=t.sent(),this.messaging.useServiceWorker(this.registration),this.initiated=!0,t.label=2;case 2:return[2,this]}})})},y.prototype.checkSubscription=function(){return f(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return[4,this.checkClientServiceSubscription()];case 1:if(!t.sent())return[2,!1];t.label=2;case 2:return t.trys.push([2,6,,7]),[4,this.messaging.getToken()];case 3:return e=t.sent(),(n=e)?[4,this.checkUserTokenInStorage(e)]:[3,5];case 4:n=t.sent(),t.label=5;case 5:return[2,!!n];case 6:return t.sent(),[2,!0];case 7:return[2]}})})},y.prototype.subscribe=function(){return f(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,this.messaging.requestPermission()];case 1:return t.sent(),e=this.saveUserTokenInStorage,[4,this.messaging.getToken()];case 2:return[4,e.apply(this,[t.sent()])];case 3:return t.sent(),[3,5];case 4:throw"messaging/permission-blocked"===(n=t.sent()).code?new Error(c.e):new Error(n);case 5:return[2]}})})},y.prototype.unsubscribe=function(){return f(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,this.messaging.getToken()];case 1:return e=t.sent(),[4,this.messaging.deleteToken(e)];case 2:return t.sent(),[4,this.removeUserTokenFromStorage(e)];case 3:return t.sent(),[2]}})})},y.registerServiceWorker=function(){return f(this,void 0,void 0,function(){return p(this,function(t){return[2,navigator.serviceWorker.register("/firebase-messaging-sw.js")]})})},y.prototype.checkClientServiceSubscription=function(){return f(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:if(this.registration)return[4,this.registration.pushManager.getSubscription()];throw new Error(c.d);case 1:return[2,!!t.sent()]}})})},y);function y(t){if((t=h.call(this,t)||this).registration=null,t.initiated=!1,navigator.serviceWorker)return d.a.initializeApp(a),t.messaging=d.a.messaging(),t.messaging.onMessage(function(t){new u(t.data.title,t.data.body,t.data.click_action).show()}),t;throw new Error(c.b)}function b(t,s,a,c){return new(a=a||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((c=c.apply(t,s||[])).next())})}function g(r,o){var i,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(i=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))c.label=e[1];else if(6===e[0]&&c.label<a[1])c.label=a[1],a=e;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}S.prototype.check=function(e){return b(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,fetch("/common/PushCheck?token=".concat(e),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"}})];case 1:return[2,404!==t.sent().status]}})})},S.prototype.add=function(e){return b(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,fetch("/common/pushadd?type=".concat(this.providerId,"&token=").concat(e),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"}})];case 1:return t.sent(),[2]}})})},S.prototype.remove=function(e){return b(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,fetch("/common/pushremove?token=".concat(e),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"}})];case 1:return t.sent(),[2]}})})};var w=S;function S(t){this.providerId=t}var E=function(){if(navigator.serviceWorker){if(!c.h.safari&&d.a.messaging.isSupported())return new m(new w(c.a));throw new Error(c.c)}throw new Error(c.b)},I=function(){switch(Notification.permission){case"default":return c.f.DEFAULT;case"granted":return c.f.GRANTED;case"denied":return c.f.DENIED;default:return c.f.DEFAULT}}},569:function(t,e,n){"use strict";function r(t,s,a,c){return new(a=a||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((c=c.apply(t,s||[])).next())})}function i(r,o){var i,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(i=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))c.label=e[1];else if(6===e[0]&&c.label<a[1])c.label=a[1],a=e;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}n.d(e,"a",function(){return c}),n(52);var o=n(221),e=n(517),s=n(497),a=e.a.getInstance(),c=(u.prototype.register=function(t,e,n){this.registrations.push({instance:t,priority:e,isAsync:n=void 0!==n&&n})},u.prototype.start=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.init()];case 1:return t.sent(),[4,this.fireAsyncPopups()];case 2:return t.sent(),[4,this.fireSyncPopups()];case 3:return t.sent(),[2]}})})},u.prototype.init=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return Object(s.c)()?[4,this.removePopupWithIrrelevantSubscriptions()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.sortRegistrationsByPriority(),this.setAsyncRegistrations(),this.setSyncRegistrations(),[2]}})})},u.prototype.fireAsyncPopups=function(){return r(this,void 0,void 0,function(){var e,n;return i(this,function(t){switch(t.label){case 0:e=0,n=this.asyncRegistrations.length,t.label=1;case 1:if(!(e<n))return[3,6];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.asyncRegistrations[e].instance.fire()];case 3:return t.sent(),[3,5];case 4:return t.sent().message,o.e,[3,5];case 5:return e++,[3,1];case 6:return[2]}})})},u.prototype.fireSyncPopups=function(){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:if(!(e=this.syncRegistrations.pop()))return[3,5];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,e.instance.fire()];case 2:return t.sent(),[3,5];case 3:return t.sent().message,o.e,[4,this.fireSyncPopups()];case 4:return t.sent(),[3,5];case 5:return[2]}})})},u.prototype.removePopupWithIrrelevantSubscriptions=function(){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.getSubscriptionsToSuggest()];case 1:return e=t.sent(),this.registrations=this.registrations.filter(function(t){return!(t=t.instance.subscriptionId)||-1!==e.indexOf(t)}),[2]}})})},u.prototype.setAsyncRegistrations=function(){this.asyncRegistrations=this.registrations.filter(function(t){return t.isAsync})},u.prototype.setSyncRegistrations=function(){this.syncRegistrations=this.registrations.filter(function(t){return!t.isAsync})},u.prototype.sortRegistrationsByPriority=function(){this.registrations=this.registrations.sort(function(t,e){return t.priority-e.priority})},u.prototype.getSubscriptionsToSuggest=function(){return r(this,void 0,void 0,function(){var n,r,o;return i(this,function(t){switch(t.label){case 0:return n=3,r=5,o=[],[4,a.requestUserSubscriptions()];case 1:return t.sent().Subscriptions.forEach(function(t){var e=Number(t.SubscriptionId);(t.Status===r||t.Status===n&&!1===t.IsEmailVerified&&e)&&o.push(e)}),[2,o]}})})},u);function u(){this.registrations=[],this.asyncRegistrations=[],this.syncRegistrations=[]}},572:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n(52);var l=n(221),f=n(537),p=n(551),h=n(518),r={allowedTimesPerDay:l.a.EMPTY,closeDaysDelay:7,acceptDaysDelay:l.a.MAX_DAYS,rejectDaysDelay:30,extra:function(){return a=function(){function r(t){switch(t.label){case 0:if(!/^https:\/\/(.+\.)?kommersant\.ru\/lk\/(lenta|bookmarks|viewhistory|subscriptionsettings)(\/.*$|\/\?.*$|\?.*$)?$/.test(location.href.toLowerCase())&&/^https:\/\/(.+\.)?kommersant\.ru\/(lk|ad|copyright|subscription)(\/.*$|\/\?.*$|\?.*$)?$/.test(location.href.toLowerCase()))throw new Error("Push ".concat(l.e));if(Object(p.a)()===h.f.DENIED)throw new Error("Push ".concat(l.e));return[4,f.a.getService()];case 1:return[4,(e=t.sent()).init()];case 2:return t.sent(),[4,e.checkSubscription()];case 3:if(t.sent())throw new Error("Push ".concat(l.e));return[2]}}var e,o,i,s,a=this,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},u={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function t(n){return function(t){var e=[n,t];if(o)throw new TypeError("Generator is already executing.");for(;c=u&&e[u=0]?0:c;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,i=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3]))c.label=e[1];else if(6===e[0]&&c.label<s[1])c.label=s[1],s=e;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(e)}}e=r.call(a,c)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},s=void 0,new(s=Promise)(function(n,e){function r(t){try{i(a.next(t))}catch(t){e(t)}}function o(t){try{i(a.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,o)}i((a=a.apply(void 0,[])).next())});var s,a}}},573:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n(52),n(160);var p=n(221),h=n(574),r={allowedTimesPerDay:9999,closeDaysDelay:p.a.EMPTY,acceptDaysDelay:p.a.EMPTY,rejectDaysDelay:p.a.EMPTY,extra:function(){return a=function(){function r(t){switch(t.label){case 0:if(/^https:\/\/(.+\.)?kommersant\.ru(\/$|\/\?.*$|\?.*$)?$/.test(location.href)||/^https:\/\/(.+\.)?kommersant\.ru\/lk\/(login|register|RemindPassword)(\/$|\/\?.*$|\?.*$)?$/.test(location.href)||/^https:\/\/(.+\.)?kommersant\.ru\/subscription\/tariffs(\/$|\/\?.*$|\?.*$)?$/.test(location.href))throw localStorage.removeItem("editorial-popup-data"),new Error(p.e);t.label=1;case 1:return t.trys.push([1,6,,7]),n=h.c?"?id=".concat(h.d):"",[4,fetch("/common/popup".concat(n),{method:"GET",headers:{"Content-Type":"application/json"}})];case 2:if(200==(e=t.sent()).status)return[3,3];throw localStorage.removeItem("editorial-popup-data"),new Error(p.e);case 3:return[4,e.json()];case 4:if(!(n=t.sent())||!n.length||0===n.length)throw localStorage.removeItem("editorial-popup-data"),new Error(p.e);if(!h.c){if(localStorage.getItem("editorial-popup-closed")==n[0].Id)throw localStorage.removeItem("editorial-popup-data"),localStorage.removeItem("editorial-popup-chanceExpire"),localStorage.removeItem("editorial-popup-chance"),new Error(p.e);if((i=parseInt(n[0].ShowingPercent))&&i<100&&localStorage.getItem("editorial-popup-chance")!=n[0].Id){if((o=localStorage.getItem("editorial-popup-chanceExpire"))&&parseInt(o)>Date.now())throw localStorage.removeItem("editorial-popup-data"),new Error(p.e);if(localStorage.removeItem("editorial-popup-chanceExpire"),o=Math.floor(100*Math.random())+1,i<=o)throw(i=new Date).setDate(i.getDate()+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),localStorage.setItem("editorial-popup-chanceExpire",i.getTime().toString()),localStorage.removeItem("editorial-popup-data"),new Error(p.e);localStorage.setItem("editorial-popup-chance",n[0].Id),localStorage.removeItem("editorial-popup-chanceExpire")}}localStorage.setItem("editorial-popup-data",JSON.stringify(n[0])),t.label=5;case 5:return[3,7];case 6:throw t.sent(),localStorage.removeItem("editorial-popup-data"),new Error(p.e);case 7:return[2]}}var e,n,o,i,s,a,c,u=this,l={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},f={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function t(n){return function(t){var e=[n,t];if(s)throw new TypeError("Generator is already executing.");for(;l=f&&e[f=0]?0:l;)try{if(s=1,a&&(c=2&e[0]?a.return:e[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,e[1])).done)return c;switch(a=0,(e=c?[2&e[0],c.value]:e)[0]){case 0:case 1:c=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,a=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(c=0<(c=l.trys).length&&c[c.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!c||e[1]>c[0]&&e[1]<c[3]))l.label=e[1];else if(6===e[0]&&l.label<c[1])l.label=c[1],c=e;else{if(!(c&&l.label<c[2])){c[2]&&l.ops.pop(),l.trys.pop();continue}l.label=c[2],l.ops.push(e)}}e=r.call(u,l)}catch(t){e=[6,t],a=0}finally{s=c=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},s=void 0,new(s=Promise)(function(n,e){function r(t){try{i(a.next(t))}catch(t){e(t)}}function o(t){try{i(a.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,o)}i((a=a.apply(void 0,[])).next())});var s,a}}},574:function(t,e,n){"use strict";function o(t){for(var e=0,n=document.cookie.split(";");e<n.length;e++){var r=(o=n[e].trim().split("="))[0],o=o[1];if(r===t)return o}return null}n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"d",function(){return i}),n.d(e,"c",function(){return s}),n(52),n(529),n(160);var r=function(t){var e=t.indexOf("?"),n=-1!==e?t.substring(e+1):"";return(n=new URLSearchParams(n)).has("from")?n.set("from","editorial_popup"):n.append("from","editorial_popup"),(-1===e?"".concat(t,"?"):"".concat(t.substring(0,e+1))).concat(n.toString())},i=o("editorial-popupid"),e=/(?!https:\/\/(www\.)?kommersant\.ru)(https:\/\/(?:[^\/]+\.)kommersant\.ru)/.test(location.href),s=!!i&&e,a=function(t){var e,n,r;return s?o("editorial-popup-group"):(t.ImageSrc||t.Title||t.Subtitle)&&(t.ImageSrcB||t.TitleB||t.SubtitleB)?(r=null,n=!1,(e=localStorage.getItem("editorial-popup-AB"))&&(r=JSON.parse(e),n=+new Date(r.expireDate)<+new Date),e&&!n||(e=0===Math.floor(2*Math.random())?"A":"B",n=new Date,r={group:e,expireDate:new Date(n.setDate(n.getDate()+14))},localStorage.setItem("editorial-popup-AB",JSON.stringify(r))),r.group):(t.ImageSrc||t.Title||t.Subtitle)&&!(t.ImageSrcB||t.TitleB||t.SubtitleB)?(localStorage.removeItem("editorial-popup-AB"),"A"):t.ImageSrc||t.Title||t.Subtitle||!(t.ImageSrcB||t.TitleB||t.SubtitleB)?"A":(localStorage.removeItem("editorial-popup-AB"),"B")}}}]);